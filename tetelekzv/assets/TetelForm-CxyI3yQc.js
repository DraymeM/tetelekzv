const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MarkdownHandler-BQm5LRdC.js","assets/index-BV4Ew1CB.js","assets/index-DYx34bjO.css","assets/FlashCard-DBBn6T8I.js","assets/InputField-atYoBxRM.js","assets/FormContainer-CNE-AWPO.js","assets/SubmitButton-mKuHJ0xh.js","assets/Tutorial-CyfZ9E1n.js","assets/index-BfYvBwUB.js"])))=>i.map(i=>d[i]);
import{j as e,r as z,R as N,S as ee,_ as w,aE as B,d as K,b7 as me,aJ as he,aU as be,y as X}from"./index-BV4Ew1CB.js";import{o as P,a as D,s as S,p as pe,n as ze}from"./types-CZYGTQuY.js";import M from"./InputField-atYoBxRM.js";import{P as se}from"./PageTransition-CV21mfqc.js";import{H as te}from"./index-dkWrTg2q.js";const U=pe(s=>s!==void 0?Number(s):void 0,ze()).optional(),xe=P({id:U,title:S().min(1,"A cím nem lehet üres!"),description:S()}),je=P({id:U,content:S().min(1,"A szekció tartalma nem lehet üres!"),subsections:D(xe).nullable().transform(s=>s||[])}),fe=P({id:U,question:S().min(1,"Üresen ne hagyd, zárd be ha nem akarsz."),answer:S().min(1,"Üresen ne hagyd, zárd be ha nem akarsz.")}),Y=P({name:S().min(1,"Tétel cím megadása kötelező!"),osszegzes:S().min(1,"Összegzés megadása kötelező!"),sections:D(je).min(1,"Legalább egy szekció legyen!"),flashcards:D(fe).nullable().transform(s=>s||[])}),I=N.lazy(()=>w(()=>import("./MarkdownHandler-BQm5LRdC.js").then(s=>s.M),__vite__mapDeps([0,1,2]))),ge=N.lazy(()=>w(()=>import("./FlashCard-DBBn6T8I.js"),__vite__mapDeps([3,1,2])));function ve({data:s}){return e.jsx(z.Suspense,{fallback:e.jsx(ee,{}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-center",children:s.name}),s.sections.map(t=>e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow transition-colors hover:border-border border border-transparent",children:[e.jsx("div",{className:"text-xl font-semibold mb-4",children:e.jsx(I,{content:t.content})}),t.subsections.map(r=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"font-medium mb-2",children:e.jsx(I,{content:r.title})}),e.jsx("div",{className:"prose prose-invert",children:e.jsx(I,{content:r.description})})]},r.id))]},t.id)),s.osszegzes&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow transition-colors hover:border-border border border-transparent",children:[e.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Összegzés"}),e.jsx("div",{className:"whitespace-pre-wrap prose prose-invert",children:e.jsx(I,{content:s.osszegzes})})]}),s.flashcards.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-2xl font-bold",children:"Flashcards"}),e.jsx("div",{className:"flex  ml-5 md:ml-15 mr-5 flex-wrap gap-2",children:s.flashcards.map(t=>e.jsx(ge,{question:t.question,answer:t.answer},t.id))})]})]})})}const J=({id:s,label:t,value:r,onChange:c,error:n})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:t}),e.jsx("textarea",{id:s,rows:4,className:`w-full p-2 rounded bg-secondary text-foreground focus:outline-none focus:ring-2 focus:ring-primary ${n?"border border-red-500":"border border-border"}`,value:r,onChange:c}),n&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n})]}),ke=({name:s,handleNameChange:t,osszegzes:r,handleOsszegzesChange:c,errorName:n,errorOsszegzes:j})=>e.jsxs("div",{children:[e.jsx(M,{id:"tetelcime",label:"Tétel címe",value:s,onChange:t,error:n}),e.jsx(J,{id:"osszegzes",label:"Összegzés",value:r,onChange:c,error:j})]}),Se=N.lazy(()=>w(()=>import("./InputField-atYoBxRM.js"),__vite__mapDeps([4,1,2]))),ye=({subsection:s,onUpdate:t,onRemove:r,errors:c={}})=>e.jsx(z.Suspense,{children:e.jsxs("div",{className:"space-y-2 relative group",children:[e.jsx("button",{type:"button",onClick:r,className:"absolute -top-3 -right-3 text-red-500 bg-background rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx(B,{className:"w-5 h-5"})}),e.jsx(Se,{id:"subsectioncim",label:"Cím",value:s.title,onChange:n=>t("title",n.target.value),error:c.title}),e.jsx(J,{id:"subsectionleiras",label:"Leírás",value:s.description,onChange:n=>t("description",n.target.value),error:c.description})]})}),Ne=({onUpdateContent:s,onAddSubsection:t,onRemoveSection:r,onUpdateSubsection:c,onRemoveSubsection:n,section:j,errors:b={}})=>e.jsx(z.Suspense,{children:e.jsxs("div",{className:"p-4 border rounded-lg border-border relative group",children:[e.jsx("button",{type:"button",onClick:r,className:"absolute -top-3 -right-3 text-red-500 bg-background rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx(B,{className:"w-5 h-5"})}),e.jsx(J,{id:"section",label:"Szekció tartalma",value:j.content,onChange:l=>s(l.target.value),error:b.content}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("h4",{id:"alszekciotitle",className:"text-md font-medium text-foreground",children:"Alszekciók"}),j.subsections.map((l,u)=>e.jsx(ye,{subsection:l,onRemove:()=>n(u),onUpdate:(i,o)=>c(u,i,o),errors:{title:b[`subsections.${u}.title`],description:b[`subsections.${u}.description`]}},u)),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{id:"ujalszekcio",type:"button",onClick:t,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 hover:cursor-pointer text-white hover:bg-emerald-700",children:e.jsx(K,{size:15})}),e.jsx("span",{children:"Új Alszekció"})]})]})]})}),we=({sections:s,openSections:t,setOpenSections:r,addSection:c,removeSection:n,updateSection:j,addSub:b,updateSub:l,removeSub:u,fieldErrors:i,showSectionErrors:o})=>e.jsxs("div",{className:"space-y-4",children:[s.map((a,d)=>{const f=t[a.id],p={};return Object.entries(i).forEach(([x,v])=>{x.startsWith(`sections.${d}.`)&&(p[x.replace(`sections.${d}.`,"")]=v)}),e.jsxs("div",{children:[e.jsxs("button",{id:"sectioncollapse",type:"button",className:"w-full flex justify-between p-4 bg-secondary rounded-md hover:cursor-pointer",onClick:()=>r({...t,[a.id]:!f}),children:[e.jsxs("span",{className:"font-medium",children:["Szekció #",d+1]}),e.jsx(te,{className:`transform transition-transform duration-300 ${f?"rotate-180":"rotate-0"}`,size:30})]}),e.jsx(se,{show:f,children:e.jsx("div",{className:"p-4 border border-border rounded-b-md",children:e.jsx(Ne,{index:d,section:a,onUpdateContent:x=>j(a.id,x),onAddSubsection:()=>b(a.id),onRemoveSection:()=>n(a.id),onUpdateSubsection:(x,v,O)=>l(a.id,x,v,O),onRemoveSubsection:x=>u(a.id,x),errors:o?p:{}})})})]},a.id)}),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{id:"ujszekcio",type:"button",onClick:c,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 text-white hover:bg-emerald-700 hover:cursor-pointer",children:e.jsx(K,{size:15})}),e.jsx("span",{children:"Új Szekció"})]})]}),Fe=({flashcard:s,onUpdate:t,onRemove:r,errors:c={}})=>e.jsxs("div",{id:"flashcardblock",className:"space-y-2 relative group",children:[e.jsx("button",{id:"flashcardblockx",type:"button",onClick:r,className:"absolute -top-3 -right-3 text-red-500 bg-secondary rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx(B,{className:"w-5 h-5"})}),e.jsx("hr",{className:"border-t-2 border-border w-full my-2"}),e.jsx(M,{id:"kerdescard",label:"Kérdés",value:s.question,onChange:n=>t("question",n.target.value),error:c.question}),e.jsx(M,{id:"valaszcard",label:"Válasz",value:s.answer,onChange:n=>t("answer",n.target.value),error:c.answer})]}),Ee=({flashcards:s,openFlashcards:t,setOpenFlashcards:r,addFlashcard:c,removeFlashcard:n,updateFlashcard:j,fieldErrors:b,showFlashcardErrors:l})=>e.jsxs("div",{className:"space-y-4 mt-6",children:[s.map((u,i)=>{const o=t[u.id],a={};return Object.entries(b).forEach(([d,f])=>{d.startsWith(`flashcards.${i}.`)&&(a[d.replace(`flashcards.${i}.`,"")]=f)}),e.jsxs("div",{children:[e.jsxs("button",{id:"flascardcollapse",type:"button",className:"w-full flex justify-between p-4 bg-secondary rounded-md hover:cursor-pointer",onClick:()=>r({...t,[u.id]:!o}),children:[e.jsxs("span",{className:"font-medium",children:["Flashcard #",i+1]}),e.jsx(te,{className:`transform transition-transform duration-300 ${o?"rotate-180":"rotate-0"}`,size:30})]}),e.jsx(se,{show:o,children:e.jsx("div",{className:"p-4 border border-secondary rounded-b-md",children:e.jsx(Fe,{flashcard:u,onUpdate:(d,f)=>j(u.id,d,f),onRemove:()=>n(u.id),errors:l?a:{}})})})]},u.id)}),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{id:"ujflashcard",type:"button",onClick:c,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 text-white hover:bg-emerald-700 hover:cursor-pointer",children:e.jsx(K,{size:15})}),e.jsx("span",{children:"Új flashcard"})]})]});let H=Date.now();function V(s){return s&&s.id!=null?s:{id:++H,content:s?.content??"",subsections:s?.subsections?.map(t=>({id:++H,title:t.title,description:t.description}))??[]}}function _e(s){const[t,r]=z.useState(s?.map(V)??[V()]);return{sections:t,addSection:()=>{const i=V();return r(o=>[...o,i]),i},removeSection:i=>r(o=>o.filter(a=>a.id!==i)),updateSection:(i,o)=>r(a=>a.map(d=>d.id===i?{...d,content:o}:d)),addSub:i=>r(o=>o.map(a=>a.id===i?{...a,subsections:[...a.subsections,{id:++H,title:"",description:""}]}:a)),updateSub:(i,o,a,d)=>r(f=>f.map(p=>p.id===i?{...p,subsections:p.subsections.map((x,v)=>v===o?{...x,[a]:d}:x)}:p)),removeSub:(i,o)=>r(a=>a.map(d=>d.id===i?{...d,subsections:d.subsections.filter((f,p)=>p!==o)}:d))}}let Ce=Date.now();function Z(s){return s&&s.id!=null?s:{id:++Ce,question:s?.question??"",answer:s?.answer??""}}function Te(s){const[t,r]=z.useState(s?.map(Z)??[]);return{flashcards:t,addFlashcard:()=>{const b=Z();return r(l=>[...l,b]),b},updateFlashcard:(b,l,u)=>r(i=>i.map(o=>o.id===b?{...o,[l]:u}:o)),removeFlashcard:b=>r(l=>l.filter(u=>u.id!==b))}}const Ae=[{title:"Tétel cím",content:"Ebbe az input mezőbe írhatod a tételed címét",selector:"#tetelcime"},{title:"Összegzés",content:"Ebbe az input mezőbe írhatod a tételed összegzését, ami a tétel leg alján fog megjelenni.",selector:"#osszegzes"},{title:"Szekció dropdown",content:"Minden szekció összecsukható és bezárható, egy adott szekció elemeit tartalmazza.",selector:"#sectioncollapse"},{title:"Új alszekció hozzáadása",content:"A szekción belül itt tudsz új alszekciót hozzáadni, ha az adott bekezdéshez nem szükséges, nem kötelező. Katints rá!",selector:"#ujalszekcio",requiresInteraction:!0},{title:"Alszekciók",content:"Itt találod egy adott szekcióhoz tartozó összes alszekciót.",selector:"#alszekciotitle"},{title:"Alszekció Címe",content:"Ide íród be az alszekció címét (kötelező)",selector:"#subsectioncim"},{title:"Alszekciók",content:"Ide íród be az alszekció tartalmát (Nem kötelező de erősen ajánlott)",selector:"#subsectionleiras"},{title:"Új szekció",content:"Ha már készen vagy egy szekcióval (bekezdéssel) adhatsz hozzá a témához még többet ezzel a gombal.",selector:"#ujszekcio"},{title:"Új Flashcard",content:"Amennyiben szeretnél a témádhoz kártyákat is rendelni, azt itt tudod megtenni (nem kötelező) Kattints Rá a folytatáshoz.",selector:"#ujflashcard",requiresInteraction:!0},{title:"Flashcard dropdown",content:"Minden flashcard becsukható, itt találod az adott kártyához tartozó adatokat.",selector:"#flascardcollapse"},{title:"Kérdés",content:"A kártya elöllapja, ide írhatod a kérdést.",selector:"#kerdescard"},{title:"Válasz",content:"A kártya hátulja, ide írhatod a kérdéshez tartozó választ.",selector:"#valaszcard"},{title:"Előnézet",content:"Miközbe dolgozod ki a tételed van elehtőséged megtekinteni az előnézetet valós időben. Előnézetből vissza tudsz jönni ugyan ezzel a gombal.",selector:"#preview"},{title:"Mentés",content:"Mikor végeztél mindennel ezzel a gombal tudod elmenteni a munkád. Ne izgulj késöbbi szerkesztésre is van lehetőséged.",selector:"#submitbutton"}],Ie=N.lazy(()=>w(()=>import("./FormContainer-CNE-AWPO.js"),__vite__mapDeps([5,1,2]))),Pe=N.lazy(()=>w(()=>import("./SubmitButton-mKuHJ0xh.js"),__vite__mapDeps([6,1,2]))),Oe=N.lazy(()=>w(()=>import("./Tutorial-CyfZ9E1n.js"),__vite__mapDeps([7,1,2,8])));function De({initialData:s,onSubmit:t,isPending:r,error:c,success:n,label:j,submitLabel:b}){const{sections:l,addSection:u,removeSection:i,updateSection:o,addSub:a,updateSub:d,removeSub:f}=_e(s?.sections),{flashcards:p,addFlashcard:x,updateFlashcard:v,removeFlashcard:O}=Te(s?.flashcards),[re,W]=z.useState(!1),[F,ae]=z.useState(s?.name||""),[E,ne]=z.useState(s?.osszegzes||""),[T,Q]=z.useState({}),[A,R]=z.useState({}),[oe,$]=z.useState(()=>l.reduce((m,h,k)=>({...m,[h.id]:k===0}),{})),[ie,q]=z.useState(()=>p.reduce((m,h)=>({...m,[h.id]:!1}),{})),[L,le]=z.useState(!1);z.useEffect(()=>{const m=Y.safeParse({name:F,osszegzes:E,sections:l,flashcards:p});if(m.success)Q({});else{const h={};m.error.errors.forEach(k=>{h[k.path.join(".")]=k.message}),Q(h)}},[F,E,l,p]),z.useEffect(()=>{(c||n)&&window.scrollTo({top:0,behavior:"smooth"})},[c,n]);const de=m=>{m.preventDefault(),R({name:!0,osszegzes:!0,sections:!0,flashcards:!0});const h=Y.safeParse({name:F,osszegzes:E,sections:l,flashcards:p});if(!h.success){X.error("Javítsd ki a hibákat mielőtt mentenél!");const k=new Set,G=new Set;h.error.errors.forEach(_=>{const[g,y]=_.path;if(g==="sections"){const C=l[y]?.id;C!=null&&k.add(C)}if(g==="flashcards"){const C=p[y]?.id;C!=null&&G.add(C)}}),$(_=>{const g={..._};return k.forEach(y=>g[y]=!0),g}),q(_=>{const g={..._};return G.forEach(y=>g[y]=!0),g});return}t(h.data),X.success("Sikeres mentés!")},ce=()=>{const m=u();$(h=>({...h,[m.id]:!0}))},ue=()=>{const m=x();q(h=>({...h,[m.id]:!0}))};return e.jsx("div",{children:e.jsxs(z.Suspense,{fallback:e.jsx(ee,{}),children:[e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex justify-end mb-4",children:[e.jsx("button",{className:"fixed top-20 right-5 p-3 bg-blue-600 hover:cursor-pointer text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 z-50",onClick:()=>W(!0),title:"Segítség a használathoz",children:e.jsx(me,{size:20})}),e.jsx("button",{id:"preview",onClick:()=>le(m=>!m),className:"fixed md:bottom-7 bottom-14 right-5 p-3 bg-purple-600 text-white rounded-full hover:bg-purple-700 hover:scale-105 transition-all z-50",title:L?"Vissza szerkesztéshez":"Előnézet",children:L?e.jsx(he,{size:20}):e.jsx(be,{size:20})})]}),e.jsx(Ie,{error:c,success:n,label:j,children:e.jsx("form",{onSubmit:de,className:"space-y-6",children:L?e.jsx(ve,{data:{name:F,osszegzes:E,sections:l,flashcards:p}}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{name:F,handleNameChange:m=>{ae(m.target.value),R(h=>({...h,name:!0}))},osszegzes:E,handleOsszegzesChange:m=>{ne(m.target.value),R(h=>({...h,osszegzes:!0}))},errorName:A.name?T.name:void 0,errorOsszegzes:A.osszegzes?T.osszegzes:void 0}),e.jsx(we,{sections:l,openSections:oe,setOpenSections:$,addSection:ce,removeSection:i,updateSection:o,addSub:a,updateSub:d,removeSub:f,fieldErrors:T,showSectionErrors:A.sections}),e.jsx(Ee,{flashcards:p,openFlashcards:ie,setOpenFlashcards:q,addFlashcard:ue,removeFlashcard:O,updateFlashcard:v,fieldErrors:T,showFlashcardErrors:A.flashcards}),e.jsx(Pe,{isPending:r,label:b})]})})})]}),e.jsx(Oe,{open:re,onClose:()=>W(!1),steps:Ae})]})})}export{De as default};
