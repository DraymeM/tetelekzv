import{u as T,e as h,d as z,r as m,j as o,S as v}from"./index-hOu_68pd.js";import{u as j}from"./useQuery-DkrJjoao.js";import{u as q}from"./useMutation-CvtkvKpl.js";import{h as E,g as N}from"./repo-CO9k5sGB.js";import{T as k}from"./TetelForm-DxWIMiGi.js";import"./utils-km2FGkQ4.js";import"./SubmitButton-0gl-AtzO.js";import"./InputField-C8kAHn1T.js";const D=()=>{var l,c;const{id:p}=T({strict:!1}),n=Number(p),d=h(),b=z(),[f,r]=m.useState(null),[S,a]=m.useState(null),{data:e,isLoading:g}=j({queryKey:["tetelDetail",n],queryFn:()=>N(n),enabled:!isNaN(n)}),u=q({mutationFn:s=>E(n,s),onSuccess:()=>{b.invalidateQueries({queryKey:["tetelDetail",n]}),a("Sikeres frissítés!"),setTimeout(()=>{a(null),d({to:`/tetelek/${n}`})},2e3)},onError:s=>{var t,i;r(((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.error)||"Hiba a frissítés közben.")}}),x=s=>{r(null),u.mutate({...s,sections:s.sections.map(t=>({...t,subsections:t.subsections.map(i=>({...i,id:i.id&&i.id<0?void 0:i.id}))})),flashcards:s.flashcards.map(t=>({...t,id:t.id&&t.id<0?void 0:t.id}))})};if(g)return o.jsx("div",{className:"p-10 text-center text-gray-300",children:o.jsx(v,{})});const y={name:(e==null?void 0:e.tetel.name)||"",osszegzes:((l=e==null?void 0:e.osszegzes)==null?void 0:l.content)||"",sections:((c=e==null?void 0:e.sections)==null?void 0:c.map(s=>({...s,subsections:s.subsections||[]})))||[{content:"",subsections:[]}],flashcards:(e==null?void 0:e.questions)||[]};return o.jsx(k,{initialData:y,onSubmit:x,isPending:u.isPending,error:f,success:S,label:"Tétel szerkesztése",submitLabel:"Tétel mentése"})},M=D;export{M as component};
