const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TetelForm-BAIR9QHk.js","assets/index-C0Fg1H1H.js","assets/index-CF_iyIGy.css","assets/types-CZYGTQuY.js","assets/InputField-Bc71MLOM.js","assets/PageTransition-B2bRsmKk.js","assets/index-Cj0J1wAD.js"])))=>i.map(i=>d[i]);
import{u as v,f as h,e as j,r,j as i,S as T,R as z,_ as k}from"./index-C0Fg1H1H.js";import{u as P}from"./useQuery-DraQ-A76.js";import{u as _}from"./useMutation-DHIKlFSK.js";import{l as E,d as q}from"./repo-CpeVcUY7.js";import{P as N}from"./PageTransition-B2bRsmKk.js";import{O as D}from"./OfflinePlaceholder-COO-2YQF.js";import{u as O}from"./useOnlineStatus-BNjoD1h4.js";const Q=z.lazy(()=>k(()=>import("./TetelForm-BAIR9QHk.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),M=()=>{const{id:d}=v({strict:!1}),s=Number(d),f=h(),l=j(),[p,u]=r.useState(null),[b,c]=r.useState(null),[x,o]=r.useState(!1),y=O(),{data:n}=P({queryKey:["tetelDetail",s],queryFn:()=>q(s),enabled:!isNaN(s)&&s>0}),m=_({mutationFn:e=>E(s,e),onMutate:()=>{o(!0)},onSuccess:()=>{l.invalidateQueries({queryKey:["tetelDetail",s]}),l.invalidateQueries({queryKey:["tetelek"]}),c("Sikeres frissítés!"),setTimeout(()=>{c(null),f({to:`/tetelek/${s}`,replace:!0}),o(!1)},3e3)},onError:e=>{u(e.response?.data?.error||"Hiba a frissítés közben."),o(!1)}});if(!y)return i.jsx(D,{});const S={name:n?.tetel.name||"",osszegzes:n?.osszegzes?.content||"",sections:n?.sections.map(e=>({...e,subsections:e.subsections||[]}))||[{content:"",subsections:[]}],flashcards:n?.questions||[]},g=e=>{u(null),m.mutate({...e,sections:e.sections.map(t=>({...t,subsections:t.subsections.map(a=>({...a,id:a.id&&a.id<0?void 0:a.id}))})),flashcards:e.flashcards.map(t=>({...t,id:t.id&&t.id<0?void 0:t.id}))})};return i.jsx(N,{children:i.jsx(r.Suspense,{children:i.jsxs("div",{className:"relative",children:[x&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"rgba(25, 25, 30, 0.3)"},children:i.jsx(T,{})}),i.jsx(Q,{initialData:S,onSubmit:g,isPending:m.isPending,error:p,success:b,label:"Tétel szerkesztése",submitLabel:"Tétel mentése"})]})})})};export{M as T};
