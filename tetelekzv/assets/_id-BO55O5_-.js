const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MarkdownHandler-CtF4JmIs.js","assets/index-234tk97H.js","assets/index-BWeBI0VN.css"])))=>i.map(i=>d[i]);
import{j as e,z as A,o as $,r,v as B,w as q,x as L,A as Q,B as K,d as U,b as H,g as W,f as G,R as J,_ as X,y as E,S as Y,O as Z,a as R,i as _,p as ee,s as te,C as se,D as ne}from"./index-234tk97H.js";import{u as re}from"./useLocation-Bt8cLsDT.js";import{u as oe}from"./useQuery-hJfDrL_Q.js";import{u as ae}from"./useMutation-Bi3aRSw5.js";import{N as O}from"./Navbar-BAvcHIJV.js";import{g as ie,h as le}from"./repo-BQTa5ysD.js";import ce from"./DeleteModal-CThaGvAF.js";import{P as de}from"./PageTransition-C9xzzT-N.js";import ue from"./FlashCard-DtZq5Igt.js";import{O as me}from"./OfflinePlaceholder-CStZOowY.js";import{M as xe}from"./index-CQsely2t.js";import{l as I}from"./menu-C9TC1CE_.js";import"./index-BOWI0ui0.js";import"./use-resolve-button-type-C9zwEP0b.js";import"./bugs-BY9FZZoS.js";import"./label-CPzeFQK8.js";const pe=({questions:t,currentIdx:p,onNext:o,onExit:n})=>{const x=t.length>0,h=t.length>1;return e.jsx(A,{show:!0,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",as:"div",children:e.jsx("div",{className:"flex flex-col items-center gap-6 mt-10",children:x&&e.jsxs(e.Fragment,{children:[e.jsx(ue,{question:t[p]?.question??"",answer:t[p]?.answer??""}),e.jsxs("div",{className:"flex gap-4",children:[h&&e.jsxs("button",{onClick:o,className:`px-6 py-3 bg-orange-400 text-white rounded-lg hover:cursor-pointer\r
                             hover:bg-orange-600 transition-colors flex items-center`,children:[e.jsx($,{className:"mr-2 animate-spin"}),"Következő kérdés"]}),e.jsx("button",{onClick:n,className:`px-6 py-3 border border-border text-muted-foreground hover:text-foreground hover:cursor-pointer\r
                             rounded-lg hover:bg-secondary transition-colors`,children:"Vissza"})]})]})})})};function he(){const t=window.speechSynthesis,[p,o]=r.useState([]),[n,x]=r.useState(!1),[h,l]=r.useState(!1),b=r.useRef(null),j=()=>new Promise(m=>{let a=t.getVoices();if(a.length>0)o(a),m(a);else{const g=setInterval(()=>{a=t.getVoices(),a.length>0&&(clearInterval(g),o(a),m(a))},100)}});r.useEffect(()=>(j(),"onvoiceschanged"in t&&(t.onvoiceschanged=j),()=>{"onvoiceschanged"in t&&(t.onvoiceschanged=null)}),[]);const u=(m,a,g=1,F=1,f=1)=>{if(!m)return;z();const c=new SpeechSynthesisUtterance(m);if(a){const y=p.find(N=>N.name===a);y&&(c.voice=y)}c.rate=g,c.pitch=F,c.volume=f,c.onstart=()=>{x(!0),l(!1)},c.onend=()=>{x(!1),l(!1)},c.onerror=()=>{x(!1),l(!1)},b.current=c,t.speak(c)},w=()=>{t.speaking&&!t.paused&&(t.pause(),l(!0))},v=()=>{t.paused&&(t.resume(),l(!1))},z=()=>{t.cancel(),x(!1),l(!1)};return{voices:p,speak:u,pause:w,resume:v,stop:z,isSpeaking:n,isPaused:h}}const fe=({text:t,className:p})=>{const{voices:o,speak:n,pause:x,resume:h,stop:l,isSpeaking:b,isPaused:j}=he(),[u,w]=r.useState(),[v,z]=r.useState(1),[m,a]=r.useState(1),[g,F]=r.useState(1),[f,c]=r.useState(!1),[y,N]=r.useState(""),k=r.useRef(null);r.useEffect(()=>{o.length>0&&!u&&w(o[0].name)},[o,u]),r.useEffect(()=>{f&&k.current&&k.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[f]),r.useEffect(()=>()=>{window.speechSynthesis.cancel()},[]);const S=()=>{!t||o.length===0||(b?j?h():x():n(t,u,v,m,g))},P=()=>{l()},V=d=>{w(d),c(!1),b&&(l(),n(t,d,v,m,g))},M=(d,s)=>{d==="rate"&&z(s),d==="pitch"&&a(s),d==="volume"&&F(s),b&&(l(),n(t,u,d==="rate"?s:v,d==="pitch"?s:m,d==="volume"?s:g))},T={accentColor:"var(--primary)",width:"100%"},D=o.filter(d=>d.name.toLowerCase().includes(y.toLowerCase()));return e.jsx(I,{as:"div",className:`relative inline-block text-left ${p??""}`,children:({open:d})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex space-x-0",children:[e.jsx("button",{onClick:S,disabled:o.length===0,className:"inline-flex items-center py-2.5 px-3 bg-blue-600 border-blue-500 rounded-l-md text-sm font-medium text-white hover:bg-blue-700 cursor-pointer focus:outline-none transition-colors","aria-label":"Felolvasás",title:"Felolvasás",children:b?j?e.jsx(B,{size:16}):e.jsx(q,{size:16}):e.jsx(xe,{size:18})}),e.jsx(I.Button,{className:"inline-flex items-center px-2 py-2.5 bg-blue-600 border-l-2 border-blue-800 rounded-r-md text-sm font-medium text-white hover:bg-blue-700 cursor-pointer focus:outline-none transition-colors","aria-label":"Felolvasási beállítások",title:"Felolvasási beállítások",children:e.jsx(L,{size:16,className:`transition-transform duration-300 ${d?"rotate-180":"rotate-0"}`})})]}),e.jsxs(I.Items,{className:"absolute right-0 mt-2 w-64 bg-secondary border border-border rounded-md shadow-lg focus:outline-none z-50 p-4 space-y-4 max-h-[400px] overflow-auto",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-foreground",children:"Voice"}),e.jsxs("button",{type:"button",onClick:()=>c(s=>!s),className:"relative w-full rounded-md border border-border bg-muted px-3 py-2 text-sm text-foreground cursor-pointer flex justify-between items-center focus:outline-none focus:ring-2 focus:ring-primary","aria-haspopup":"listbox","aria-expanded":f,children:[e.jsx("span",{className:"block max-w-[calc(100%-1.5rem)] truncate",children:u?o.find(s=>s.name===u)?.name:"Default"}),e.jsx(L,{size:15,className:`ml-2 transition-transform duration-300 ${f?"rotate-180":"rotate-0"}`})]}),e.jsx(A,{show:f,enter:"transition ease-out duration-150",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-100",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:e.jsxs("div",{className:"absolute z-50 mt-1 w-full max-h-64 overflow-auto rounded-md border border-border bg-popover shadow-lg text-sm focus:outline-none",children:[e.jsxs("div",{className:"flex items-center border border-border rounded-md overflow-hidden bg-background",children:[e.jsx("button",{type:"button",className:"px-3 py-2 bg-background hover:bg-background/80 border-r border-border text-foreground","aria-label":"Search",children:e.jsx(Q,{size:14})}),e.jsx("input",{type:"text",value:y,onChange:s=>N(s.target.value),placeholder:"Search...",className:"flex-grow px-3 py-2 text-sm text-foreground bg-background focus:outline-none"})]}),e.jsxs("ul",{role:"listbox",children:[e.jsx("li",{role:"option","aria-selected":!u,onClick:()=>V(void 0),className:`px-3 py-2 cursor-pointer select-none ${u?"hover:bg-muted":"bg-muted text-foreground"}`,children:"Default"}),D.map(s=>{const i=u===s.name;return e.jsxs("li",{role:"option",ref:i?k:null,"aria-selected":i,onClick:()=>V(s.name),className:`px-3 py-2 cursor-pointer select-none ${i?"bg-muted text-foreground":"hover:bg-muted"}`,children:[s.name," (",s.lang,")"," ",s.localService?"[Offline]":"[Online]"]},s.name)})]})]})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1 text-foreground",children:["Rate: ",v.toFixed(1)]}),e.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.1",value:v,onChange:s=>M("rate",parseFloat(s.target.value)),style:T})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1 text-foreground",children:["Pitch: ",m.toFixed(1)]}),e.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:m,onChange:s=>M("pitch",parseFloat(s.target.value)),style:T})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1 text-foreground",children:["Volume: ",g.toFixed(1)]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:g,onChange:s=>M("volume",parseFloat(s.target.value)),style:T})]}),e.jsx("div",{className:"flex justify-between mt-2",children:e.jsxs("button",{onClick:P,disabled:!b,className:`inline-flex items-center px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 cursor-pointer transition ${b?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(K,{}),e.jsx("span",{className:"ml-2",children:"Stop"})]})})]})]})})};function ge(t,p){const o=h=>h.replace(/[#_*>\-`]/g,"").replace(/\[.*?\]\(.*?\)/g,"").replace(/!\[.*?\]\(.*?\)/g,"").replace(/`{1,3}[\s\S]*?`{1,3}/g,"").replace(/\s+/g," ").trim();let n="";t.forEach(h=>{n+=" "+o(h.content),h.subsections?.forEach(l=>{n+=" "+o(l.title||""),n+=" "+o(l.description||"")})}),p?.content&&(n+=" "+o(p.content));const x=n.split(" ").filter(Boolean).length;return Math.ceil(x/200)}function be(){const{isAuthenticated:t,isSuperUser:p}=U(),{id:o}=H({strict:!1}),n=Number(o),x=re(),h=W(),l=G(),b=x.pathname.includes("/edit"),[j,u]=r.useState(!1),[w,v]=r.useState(0),[z,m]=r.useState(!1),{data:a,isLoading:g,error:F}=oe({queryKey:["tetelDetail",n],queryFn:()=>le(n),enabled:!isNaN(n)&&n>0,retry:2,refetchOnWindowFocus:!1});r.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"})},[x.pathname]);const f=J.lazy(()=>X(()=>import("./MarkdownHandler-CtF4JmIs.js").then(i=>i.M),__vite__mapDeps([0,1,2]))),c=ae({mutationFn:()=>{if(!t||!p)throw E.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return ie(n)},onSuccess:()=>{l.invalidateQueries({queryKey:["tetelek"]}),E.success("Sikeresen törölted a tételt."),h({to:"/tetelek"})}});if(g)return e.jsxs(e.Fragment,{children:[e.jsx(O,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(Y,{})})]});if(F)return navigator.onLine?e.jsxs(e.Fragment,{children:[e.jsx(O,{}),e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",F.message]})]}):e.jsx(e.Fragment,{children:e.jsx(me,{})});if(b)return e.jsx(Z,{});const y=a?.tetel??{name:"Ismeretlen tétel"},N=a?.osszegzes,k=a?.sections??[],S=a?.questions??[],P=S.length>0,V=S.length>1,M=ge(k,N),T=!/Mobi|Android|iPhone|iPad/i.test(navigator.userAgent)&&!("standalone"in window.navigator&&window.navigator.standalone)&&!window.matchMedia("(display-mode: standalone)").matches,D=[y.name,...k.flatMap(i=>[i.content,...i.subsections?.flatMap(C=>[C.title,C.description])??[]]),N?.content??""].filter(Boolean).join(". "),d=()=>{if(!V)return;let i=w;for(;i===w;)i=Math.floor(Math.random()*S.length);v(i)},s=()=>{P&&(v(Math.floor(Math.random()*S.length)),u(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(O,{}),e.jsx(r.Suspense,{children:e.jsxs("main",{className:"relative md:max-w-7xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 py-10 text-left",children:[e.jsxs(de,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(R,{to:"/tetelek",className:"inline-flex items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors","aria-label":"Vissza a tételekhez",title:"Vissza a tételekhez",children:[e.jsx(_,{className:"mr-2"}),"Tételekhez"]}),e.jsxs("div",{className:"flex items-center md:gap-4 gap-1",children:[!j&&e.jsxs("span",{className:"text-sm mx-auto text-secondary-foreground",children:[e.jsx(ee,{className:"inline mr-1",size:15}),M," perc"]}),!j&&T&&e.jsx(fe,{text:D}),!j&&P&&e.jsx("button",{onClick:s,className:"inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 rounded-md text-sm font-medium text-white hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer","aria-label":"Tanulás",title:"Tanulás",children:e.jsx(te,{size:20})})]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-foreground",children:y.name}),j?e.jsx(pe,{questions:S,currentIdx:w,onNext:d,onExit:()=>u(!1)}):e.jsxs("div",{className:"space-y-6",children:[k.map(i=>e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow-xl border border-transparent hover:border-border transition-colors",children:[e.jsx("div",{className:"text-xl font-semibold mb-4 text-foreground",children:e.jsx(f,{content:i.content})}),i.subsections?.map(C=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"font-medium text-foreground mb-2",children:e.jsx(f,{content:C.title})}),e.jsx("div",{className:"text-secondary-foreground prose prose-invert max-w-none",children:e.jsx(f,{content:C.description})})]},C.id))]},i.id)),N?.content&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 border border-transparent hover:border-border transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:"Összegzés"}),e.jsx("div",{className:"text-foreground prose prose-invert max-w-none whitespace-pre-wrap",children:e.jsx(f,{content:N.content})})]}),e.jsxs(R,{to:"/tetelek",className:"inline-flex items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors","aria-label":"Vissza a tételekhez",title:"Vissza a tételekhez",children:[e.jsx(_,{className:"mr-2"}),"Tételekhez"]})]}),e.jsx(ce,{isOpen:z,onClose:()=>m(!1),onDelete:()=>c.mutate(),isDeleting:c.isPending,itemName:y.name})]}),t&&e.jsxs(e.Fragment,{children:[e.jsx(R,{to:"/tetelek/$id/edit",params:{id:n.toString()},className:"fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Szerkeszd a tételt",children:e.jsx(se,{size:20})}),e.jsx("button",{onClick:()=>{if(!t){E.error("Ehhez be kell jelentkezned!");return}m(!0)},className:"fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full hover:bg-rose-700 transition-all transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50",title:"Töröld a tételt",children:e.jsx(ne,{size:20})})]})]})})]})}const Re=be;export{Re as component};
