const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LearningMode-DEAgVnPW.js","assets/index-DaQSTSUC.js","assets/index-DBzWI3Al.css","assets/FlashCard-jYIyxXet.js"])))=>i.map(i=>d[i]);
import{a as q,u as C,d as T,b as I,r as i,y as l,j as e,N,S as R,O as P,L as v,f as A,o as Q,R as K,q as V,s as B,_ as H}from"./index-DaQSTSUC.js";import{u as U,D as W}from"./DeleteModal-BoS2S-ov.js";import{u as $}from"./useQuery-CBSlM_z1.js";import{u as G}from"./useMutation-FWB7wHJa.js";import{g as J,h as X}from"./repo-WZqPlhe_.js";import"./utils-km2FGkQ4.js";const Y=K.lazy(()=>H(()=>import("./LearningMode-DEAgVnPW.js"),__vite__mapDeps([0,1,2,3])));function Z(){const{isAuthenticated:a,isSuperUser:y}=q(),{id:z}=C({strict:!1}),r=Number(z),w=U(),k=T(),M=I(),S=w.pathname.includes("/edit"),[m,u]=i.useState(!1),[d,x]=i.useState(0),[D,h]=i.useState(!1),{data:t,isLoading:E,error:f}=$({queryKey:["tetelDetail",r],queryFn:()=>X(r),enabled:!isNaN(r)&&r>0,retry:2,refetchOnWindowFocus:!1}),p=G({mutationFn:()=>{if(!a)throw l.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");if(!y)throw l.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return J(r)},onSuccess:()=>{M.invalidateQueries({queryKey:["tetelek"]}),l.success("Sikeresen törölted a tételt."),k({to:"/tetelek"})},onError:s=>{s.message}});if(E)return e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(R,{})})]});if(f)return e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",f.message]});if(S)return e.jsx(P,{});const g=(t==null?void 0:t.tetel)??{name:"Ismeretlen tétel"},o=t==null?void 0:t.osszegzes,F=(t==null?void 0:t.sections)??[],n=(t==null?void 0:t.questions)??[],b=n.length>0,L=n.length>1,O=()=>{if(!L)return;let s=d;for(;s===d;)s=Math.floor(Math.random()*n.length);x(s)},_=()=>{b&&(x(Math.floor(Math.random()*n.length)),u(!0))};return e.jsx(e.Fragment,{children:e.jsxs(i.Suspense,{children:[e.jsx(N,{}),e.jsxs("main",{className:"relative md:max-w-7xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 py-10 text-left",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(v,{to:"/tetelek",className:`inline-flex items-center px-3 py-2 border border-border rounded-md\r
                       text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground\r
                       focus:outline-none focus:ring-2 focus:ring-primary transition-colors`,children:[e.jsx(A,{className:"mr-2"}),"Vissza a tételekhez"]}),!m&&b&&e.jsxs("button",{onClick:_,className:`inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 \r
                         rounded-md text-sm font-medium text-white hover:bg-purple-700 \r
                         focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer`,children:[e.jsx(Q,{className:"mr-2"}),"Tanulás"]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-foreground",children:g.name}),m?e.jsx(Y,{questions:n,currentIdx:d,onNext:O,onExit:()=>u(!1)}):e.jsxs("div",{className:"space-y-6",children:[F.map(s=>{var j;return e.jsxs("div",{className:`bg-secondary rounded-lg p-6 shadow-xl border border-transparent\r
                           hover:border-border transition-colors`,children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-foreground",children:s.content}),(j=s.subsections)==null?void 0:j.map(c=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("h3",{className:"font-medium text-foreground mb-2",children:c.title}),e.jsx("p",{className:"text-secondary-foreground",children:c.description})]},c.id))]},s.id)}),(o==null?void 0:o.content)&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 border border-transparent hover:border-border transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:"Összegzés"}),e.jsx("p",{className:"text-foreground whitespace-pre-line",children:o.content})]})]}),e.jsx(W,{isOpen:D,onClose:()=>h(!1),onDelete:()=>p.mutate(),isDeleting:p.isPending,itemName:g.name}),a&&e.jsxs(e.Fragment,{children:[e.jsx(v,{to:"/tetelek/$id/edit",params:{id:r.toString()},className:`fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full \r
                 hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50`,title:"Szerkeszd a tételt",children:e.jsx(V,{size:20})}),e.jsx("button",{onClick:()=>{if(!a){l.error("Ehhez be kell jelentkezned!");return}h(!0)},className:`fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full \r
                 hover:bg-rose-700 transition-all hover:cursor-pointer transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50`,title:"Töröld a tételt",children:e.jsx(B,{size:20})})]})]})]})})}const ie=Z;export{ie as component};
