const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TetelForm-BcluFYRn.js","assets/index-T2y7T9f9.js","assets/index-DXpQFr3M.css","assets/types-CZYGTQuY.js","assets/InputField-IJfRP2qw.js","assets/PageTransition-tWocLthg.js","assets/index-fogcM-Me.js"])))=>i.map(i=>d[i]);
import{b as z,g as N,f as T,r,j as e,S as m,R as k,_ as P}from"./index-T2y7T9f9.js";import{u as _}from"./useQuery-3U0MuJa1.js";import{u as E}from"./useMutation-EXYSPziM.js";import{k as q,h as D}from"./repo-CZfOB8Ou.js";import{N as d}from"./Navbar-oboYmZBc.js";import{P as F}from"./PageTransition-tWocLthg.js";import{O}from"./OfflinePlaceholder-DdAa7frD.js";import{u as C}from"./useOnlineStatus-4ReRS2BE.js";import"./index-CvJvE3xi.js";import"./index-BnyUHx9F.js";const R=k.lazy(()=>P(()=>import("./TetelForm-BcluFYRn.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),I=()=>{const{id:p}=z({strict:!1}),i=Number(p),f=N(),x=T(),[g,l]=r.useState(null),[j,c]=r.useState(null),[b,o]=r.useState(!1),h=C(),{data:n,isLoading:S}=_({queryKey:["tetelDetail",i],queryFn:()=>D(i),enabled:!isNaN(i)}),u=E({mutationFn:s=>q(i,s),onMutate:()=>{o(!0)},onSuccess:()=>{x.invalidateQueries({queryKey:["tetelDetail",i]}),c("Sikeres frissítés!"),setTimeout(()=>{c(null),f({to:`/tetelek/${i}`}),o(!1)},2e3)},onError:s=>{l(s.response?.data?.error||"Hiba a frissítés közben."),o(!1)}}),v=s=>{l(null),u.mutate({...s,sections:s.sections.map(t=>({...t,subsections:t.subsections.map(a=>({...a,id:a.id&&a.id<0?void 0:a.id}))})),flashcards:s.flashcards.map(t=>({...t,id:t.id&&t.id<0?void 0:t.id}))})};if(!h)return e.jsxs(e.Fragment,{children:[e.jsx(d,{}),e.jsx(O,{})]});if(S)return e.jsx("div",{className:"p-10 text-center text-gray-300",children:e.jsx(m,{})});const y={name:n?.tetel.name||"",osszegzes:n?.osszegzes?.content||"",sections:n?.sections.map(s=>({...s,subsections:s.subsections||[]}))||[{content:"",subsections:[]}],flashcards:n?.questions||[]};return e.jsxs(e.Fragment,{children:[e.jsx(d,{}),e.jsx(F,{children:e.jsx(r.Suspense,{children:e.jsxs("div",{className:"relative",children:[b&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"rgba(25, 25, 30, 0.3)"},children:e.jsx(m,{})}),e.jsx(R,{initialData:y,onSubmit:v,isPending:u.isPending,error:g,success:j,label:"Tétel szerkesztése",submitLabel:"Tétel mentése"})]})})})]})},G=I;export{G as component};
