const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/InputField-DS0_v7lA.js","assets/index-CcgwBqJ8.js","assets/index-CHYqi3PZ.css","assets/FormContainer-DJ2_9kYL.js","assets/SubmitButton-Dm2xpmSJ.js"])))=>i.map(i=>d[i]);
import{j as e,r as j,aP as I,R as L,_ as V,d as B,aZ as D,a_ as ee,v as ce,aT as le,S as ie,g as Q}from"./index-CcgwBqJ8.js";import{z as p}from"./index-mSkvzYyn.js";import{M as P}from"./MarkdownHandler-Dojq23Qn.js";import ue from"./FlashCard-Cjfov8xy.js";import $ from"./InputField-DS0_v7lA.js";import{P as se}from"./PageTransition-DQrU03lL.js";const U=p.preprocess(s=>s!==void 0?Number(s):void 0,p.number()).optional(),me=p.object({id:U,title:p.string().min(1,"A cím nem lehet üres!"),description:p.string()}),he=p.object({id:U,content:p.string().min(1,"A szekció tartalma nem lehet üres!"),subsections:p.array(me).nullable().transform(s=>s||[])}),pe=p.object({id:U,question:p.string().min(1,"Üresen ne hagyd, zárd be ha nem akarsz."),answer:p.string().min(1,"Üresen ne hagyd, zárd be ha nem akarsz.")}),X=p.object({name:p.string().min(1,"Tétel cím megadása kötelező!"),osszegzes:p.string().min(1,"Összegzés megadása kötelező!"),sections:p.array(he).min(1,"Legalább egy szekció legyen!"),flashcards:p.array(pe).nullable().transform(s=>s||[])});function xe({data:s}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-center",children:s.name}),s.sections.map(r=>e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow transition-colors hover:border-border border border-transparent",children:[e.jsx("div",{className:"text-xl font-semibold mb-4",children:e.jsx(P,{content:r.content})}),r.subsections.map(t=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"font-medium mb-2",children:e.jsx(P,{content:t.title})}),e.jsx("div",{className:"prose prose-invert",children:e.jsx(P,{content:t.description})})]},t.id))]},r.id)),s.osszegzes&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow transition-colors hover:border-border border border-transparent",children:[e.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Összegzés"}),e.jsx("div",{className:"whitespace-pre-wrap prose prose-invert",children:e.jsx(P,{content:s.osszegzes})})]}),s.flashcards.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-2xl font-bold",children:"Flashcards"}),e.jsx("div",{className:"flex  ml-5 md:ml-15 mr-5 flex-wrap gap-2",children:s.flashcards.map(r=>e.jsx(ue,{question:r.question,answer:r.answer},r.id))})]})]})}const H=({label:s,value:r,onChange:t,error:a})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:s}),e.jsx("textarea",{rows:4,className:`w-full p-2 rounded bg-secondary text-foreground focus:outline-none focus:ring-2 focus:ring-primary ${a?"border border-red-500":"border border-border"}`,value:r,onChange:t}),a&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a})]}),be=({name:s,handleNameChange:r,osszegzes:t,handleOsszegzesChange:a,errorName:i,errorOsszegzes:g})=>e.jsxs("div",{children:[e.jsx($,{label:"Tétel címe",value:s,onChange:r,error:i}),e.jsx(H,{label:"Összegzés",value:t,onChange:a,error:g})]}),je=L.lazy(()=>V(()=>import("./InputField-DS0_v7lA.js"),__vite__mapDeps([0,1,2]))),ve=({subsection:s,onUpdate:r,onRemove:t,errors:a={}})=>e.jsx(j.Suspense,{children:e.jsxs("div",{className:"space-y-2 relative group",children:[e.jsx("button",{type:"button",onClick:t,className:"absolute -top-3 -right-3 text-red-500 bg-background rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx(I,{className:"w-5 h-5"})}),e.jsx(je,{label:"Cím",value:s.title,onChange:i=>r("title",i.target.value),error:a.title}),e.jsx(H,{label:"Leírás",value:s.description,onChange:i=>r("description",i.target.value),error:a.description})]})}),ge=({onUpdateContent:s,onAddSubsection:r,onRemoveSection:t,onUpdateSubsection:a,onRemoveSubsection:i,section:g,errors:h={}})=>e.jsx(j.Suspense,{children:e.jsxs("div",{className:"p-4 border rounded-lg border-border relative group",children:[e.jsx("button",{type:"button",onClick:t,className:"absolute -top-3 -right-3 text-red-500 bg-background rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx(I,{className:"w-5 h-5"})}),e.jsx(H,{label:"Szekció tartalma",value:g.content,onChange:c=>s(c.target.value),error:h.content}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("h4",{className:"text-md font-medium text-foreground",children:"Alszekciók"}),g.subsections.map((c,u)=>e.jsx(ve,{subsection:c,onRemove:()=>i(u),onUpdate:(d,o)=>a(u,d,o),errors:{title:h[`subsections.${u}.title`],description:h[`subsections.${u}.description`]}},u)),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{type:"button",onClick:r,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 hover:cursor-pointer text-white hover:bg-emerald-700",children:e.jsx(B,{size:15})}),e.jsx("span",{children:"Új Alszekció"})]})]})]})}),fe=({sections:s,openSections:r,setOpenSections:t,addSection:a,removeSection:i,updateSection:g,addSub:h,updateSub:c,removeSub:u,fieldErrors:d,showSectionErrors:o})=>e.jsxs("div",{className:"space-y-4",children:[s.map((n,l)=>{const f=r[n.id],m={};return Object.entries(d).forEach(([v,S])=>{v.startsWith(`sections.${l}.`)&&(m[v.replace(`sections.${l}.`,"")]=S)}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:"w-full flex justify-between p-4 bg-secondary rounded-md hover:cursor-pointer",onClick:()=>t({...r,[n.id]:!f}),children:[e.jsxs("span",{className:"font-medium",children:["Szekció #",l+1]}),f?e.jsx(D,{}):e.jsx(ee,{})]}),e.jsx(se,{show:f,children:e.jsx("div",{className:"p-4 border border-border rounded-b-md",children:e.jsx(ge,{index:l,section:n,onUpdateContent:v=>g(n.id,v),onAddSubsection:()=>h(n.id),onRemoveSection:()=>i(n.id),onUpdateSubsection:(v,S,T)=>c(n.id,v,S,T),onRemoveSubsection:v=>u(n.id,v),errors:o?m:{}})})})]},n.id)}),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{type:"button",onClick:a,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 text-white hover:bg-emerald-700 hover:cursor-pointer",children:e.jsx(B,{size:15})}),e.jsx("span",{children:"Új Szekció"})]})]}),ze=({flashcard:s,onUpdate:r,onRemove:t,errors:a={}})=>e.jsxs("div",{className:"space-y-2 relative group",children:[e.jsx("button",{type:"button",onClick:t,className:"absolute -top-3 -right-3 text-red-500 bg-secondary rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx(I,{className:"w-5 h-5"})}),e.jsx("hr",{className:"border-t-2 border-border w-full my-2"}),e.jsx($,{label:"Kérdés",value:s.question,onChange:i=>r("question",i.target.value),error:a.question}),e.jsx($,{label:"Válasz",value:s.answer,onChange:i=>r("answer",i.target.value),error:a.answer})]}),Se=({flashcards:s,openFlashcards:r,setOpenFlashcards:t,addFlashcard:a,removeFlashcard:i,updateFlashcard:g,fieldErrors:h,showFlashcardErrors:c})=>e.jsxs("div",{className:"space-y-4 mt-6",children:[s.map((u,d)=>{const o=r[u.id],n={};return Object.entries(h).forEach(([l,f])=>{l.startsWith(`flashcards.${d}.`)&&(n[l.replace(`flashcards.${d}.`,"")]=f)}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:"w-full flex justify-between p-4 bg-secondary rounded-md hover:cursor-pointer",onClick:()=>t({...r,[u.id]:!o}),children:[e.jsxs("span",{className:"font-medium",children:["Flashcard #",d+1]}),o?e.jsx(D,{}):e.jsx(ee,{})]}),e.jsx(se,{show:o,children:e.jsx("div",{className:"p-4 border border-secondary rounded-b-md",children:e.jsx(ze,{flashcard:u,onUpdate:(l,f)=>g(u.id,l,f),onRemove:()=>i(u.id),errors:c?n:{}})})})]},u.id)}),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{type:"button",onClick:a,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 text-white hover:bg-emerald-700 hover:cursor-pointer",children:e.jsx(B,{size:15})}),e.jsx("span",{children:"Új flashcard"})]})]});let q=Date.now();function A(s){var r;return s&&s.id!=null?s:{id:++q,content:(s==null?void 0:s.content)??"",subsections:((r=s==null?void 0:s.subsections)==null?void 0:r.map(t=>({id:++q,title:t.title,description:t.description})))??[]}}function Ne(s){const[r,t]=j.useState((s==null?void 0:s.map(A))??[A()]);return{sections:r,addSection:()=>{const d=A();t(o=>[...o,d])},removeSection:d=>t(o=>o.filter(n=>n.id!==d)),updateSection:(d,o)=>t(n=>n.map(l=>l.id===d?{...l,content:o}:l)),addSub:d=>t(o=>o.map(n=>n.id===d?{...n,subsections:[...n.subsections,{id:++q,title:"",description:""}]}:n)),updateSub:(d,o,n,l)=>t(f=>f.map(m=>m.id===d?{...m,subsections:m.subsections.map((v,S)=>S===o?{...v,[n]:l}:v)}:m)),removeSub:(d,o)=>t(n=>n.map(l=>l.id===d?{...l,subsections:l.subsections.filter((f,m)=>m!==o)}:l))}}let we=Date.now();function Y(s){return s&&s.id!=null?s:{id:++we,question:(s==null?void 0:s.question)??"",answer:(s==null?void 0:s.answer)??""}}function ye(s){const[r,t]=j.useState((s==null?void 0:s.map(Y))??[]);return{flashcards:r,addFlashcard:()=>{const h=Y();t(c=>[...c,h])},updateFlashcard:(h,c,u)=>t(d=>d.map(o=>o.id===h?{...o,[c]:u}:o)),removeFlashcard:h=>t(c=>c.filter(u=>u.id!==h))}}const ke=L.lazy(()=>V(()=>import("./FormContainer-DJ2_9kYL.js"),__vite__mapDeps([3,1,2]))),Fe=L.lazy(()=>V(()=>import("./SubmitButton-Dm2xpmSJ.js"),__vite__mapDeps([4,1,2])));function Re({initialData:s,onSubmit:r,isPending:t,error:a,success:i,label:g,submitLabel:h}){const{sections:c,addSection:u,removeSection:d,updateSection:o,addSub:n,updateSub:l,removeSub:f}=Ne(s==null?void 0:s.sections),{flashcards:m,addFlashcard:v,updateFlashcard:S,removeFlashcard:T}=ye(s==null?void 0:s.flashcards),[y,re]=j.useState((s==null?void 0:s.name)||""),[k,te]=j.useState((s==null?void 0:s.osszegzes)||""),[E,M]=j.useState({}),[_,O]=j.useState({}),[ne,W]=j.useState(()=>c.reduce((x,b,N)=>({...x,[b.id]:N===0}),{})),[oe,J]=j.useState(()=>m.reduce((x,b)=>({...x,[b.id]:!1}),{})),[R,ae]=j.useState(!1);j.useEffect(()=>{const x=X.safeParse({name:y,osszegzes:k,sections:c,flashcards:m});if(x.success)M({});else{const b={};x.error.errors.forEach(N=>{b[N.path.join(".")]=N.message}),M(b)}},[y,k,c,m]),j.useEffect(()=>{(a||i)&&window.scrollTo({top:0,behavior:"smooth"})},[a,i]);const de=x=>{x.preventDefault(),O({name:!0,osszegzes:!0,sections:!0,flashcards:!0});const b=X.safeParse({name:y,osszegzes:k,sections:c,flashcards:m});if(!b.success){Q.error("Javítsd ki a hibákat mielőtt mentenél!");const N=new Set,K=new Set;b.error.errors.forEach(F=>{var Z,G;const[z,w]=F.path;if(z==="sections"){const C=(Z=c[w])==null?void 0:Z.id;C!=null&&N.add(C)}if(z==="flashcards"){const C=(G=m[w])==null?void 0:G.id;C!=null&&K.add(C)}}),W(F=>{const z={...F};return N.forEach(w=>z[w]=!0),z}),J(F=>{const z={...F};return K.forEach(w=>z[w]=!0),z});return}r(b.data),Q.success("Sikeres mentés!")};return e.jsx("div",{children:e.jsx(j.Suspense,{fallback:e.jsx(ie,{}),children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx("button",{onClick:()=>ae(x=>!x),className:"fixed hover:cursor-pointer bottom-7 right-7 p-3 bg-purple-600 text-white rounded-full hover:bg-purple-700 transition-all transform hover:scale-105 flex items-center justify-center z-50",title:R?"Vissza szerkesztéshez":"Előnézet",children:R?e.jsx(ce,{size:20}):e.jsx(le,{size:20})})}),e.jsx(ke,{error:a,success:i,label:g,children:e.jsx("form",{onSubmit:de,className:"space-y-6",children:R?e.jsx(xe,{data:{name:y,osszegzes:k,sections:c,flashcards:m}}):e.jsxs(e.Fragment,{children:[e.jsx(be,{name:y,handleNameChange:x=>{re(x.target.value),O(b=>({...b,name:!0}))},osszegzes:k,handleOsszegzesChange:x=>{te(x.target.value),O(b=>({...b,osszegzes:!0}))},errorName:_.name?E.name:void 0,errorOsszegzes:_.osszegzes?E.osszegzes:void 0}),e.jsx(fe,{sections:c,openSections:ne,setOpenSections:W,addSection:u,removeSection:d,updateSection:o,addSub:n,updateSub:l,removeSub:f,fieldErrors:E,showSectionErrors:_.sections}),e.jsx(Se,{flashcards:m,openFlashcards:oe,setOpenFlashcards:J,addFlashcard:v,removeFlashcard:T,updateFlashcard:S,fieldErrors:E,showFlashcardErrors:_.flashcards}),e.jsx(Fe,{isPending:t,label:h})]})})})]})})})}export{Re as default};
