const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TetelForm-BHFwfEtR.js","assets/index-Devi4yYS.js","assets/index-DBzWI3Al.css","assets/SubmitButton-blNto2aN.js","assets/InputField-BwGDGN5j.js"])))=>i.map(i=>d[i]);
import{u as h,d as k,b as z,r,j as i,S as l,R as T,_}from"./index-Devi4yYS.js";import{u as E}from"./useQuery-CFWVEYDE.js";import{u as N}from"./useMutation-BqAPE7zp.js";import{k as q,h as D}from"./repo-Br9-sPjB.js";import"./utils-km2FGkQ4.js";const P=T.lazy(()=>_(()=>import("./TetelForm-BHFwfEtR.js"),__vite__mapDeps([0,1,2,3,4]))),C=()=>{var d;const{id:p}=h({strict:!1}),o=Number(p),f=k(),x=z(),[b,c]=r.useState(null),[g,u]=r.useState(null),[y,a]=r.useState(!1),{data:e,isLoading:S}=E({queryKey:["tetelDetail",o],queryFn:()=>D(o),enabled:!isNaN(o)}),m=N({mutationFn:s=>q(o,s),onMutate:()=>{a(!0)},onSuccess:()=>{x.invalidateQueries({queryKey:["tetelDetail",o]}),u("Sikeres frissítés!"),setTimeout(()=>{u(null),f({to:`/tetelek/${o}`}),a(!1)},2e3)},onError:s=>{var t,n;c(((n=(t=s.response)==null?void 0:t.data)==null?void 0:n.error)||"Hiba a frissítés közben."),a(!1)}}),j=s=>{c(null),m.mutate({...s,sections:s.sections.map(t=>({...t,subsections:t.subsections.map(n=>({...n,id:n.id&&n.id<0?void 0:n.id}))})),flashcards:s.flashcards.map(t=>({...t,id:t.id&&t.id<0?void 0:t.id}))})};if(S)return i.jsx("div",{className:"p-10 text-center text-gray-300",children:i.jsx(l,{})});const v={name:(e==null?void 0:e.tetel.name)||"",osszegzes:((d=e==null?void 0:e.osszegzes)==null?void 0:d.content)||"",sections:(e==null?void 0:e.sections.map(s=>({...s,subsections:s.subsections||[]})))||[{content:"",subsections:[]}],flashcards:(e==null?void 0:e.questions)||[]};return i.jsx(r.Suspense,{fallback:i.jsx(l,{}),children:i.jsxs("div",{className:"relative",children:[y&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"rgba(25, 25, 30, 0.3)"},children:i.jsx(l,{})}),i.jsx(P,{initialData:v,onSubmit:j,isPending:m.isPending,error:b,success:g,label:"Tétel szerkesztése",submitLabel:"Tétel mentése"})]})})},B=C;export{B as component};
