import{r as a,ag as he,f as R,g as le,s as ve,K as W,q as B,ah as V,o as L,ai as K,X as we,v as T,aj as D,ak as S,a0 as U,al as Pe,$ as oe,x as ye,z as je,_ as ie,A as ke,k as J,am as q,an as G,a6 as ne,ao as Y,a as Te,e as Se,j as n,N as Ie,ap as $e,y as ae}from"./index-CyLvEBSo.js";import{z as _,F as ze,S as Ce}from"./SubmitButton-BYBxVvoL.js";import{u as Ee}from"./repo-Bzh9IUS-.js";import{I as X}from"./InputField-C8K4h3A6.js";function Fe({onFocus:e}){let[t,r]=a.useState(!0),s=he();return t?R.createElement(le,{as:"button",type:"button",features:ve.Focusable,onFocus:u=>{u.preventDefault();let l,o=50;function c(){if(o--<=0){l&&cancelAnimationFrame(l);return}if(e()){if(cancelAnimationFrame(l),!s.current)return;r(!1);return}l=requestAnimationFrame(c)}l=requestAnimationFrame(c)}}):null}const ue=a.createContext(null);function Ne(){return{groups:new Map,get(e,t){var r;let s=this.groups.get(e);s||(s=new Map,this.groups.set(e,s));let u=(r=s.get(t))!=null?r:0;s.set(t,u+1);let l=Array.from(s.keys()).indexOf(t);function o(){let c=s.get(t);c>1?s.set(t,c-1):s.delete(t)}return[l,o]}}}function Ae({children:e}){let t=a.useRef(Ne());return a.createElement(ue.Provider,{value:t},e)}function ce(e){let t=a.useContext(ue);if(!t)throw new Error("You must wrap your component in a <StableCollection>");let r=a.useId(),[s,u]=t.current.get(e,r);return a.useEffect(()=>u,[]),s}var Le=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Le||{}),Me=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(Me||{}),De=(e=>(e[e.SetSelectedIndex=0]="SetSelectedIndex",e[e.RegisterTab=1]="RegisterTab",e[e.UnregisterTab=2]="UnregisterTab",e[e.RegisterPanel=3]="RegisterPanel",e[e.UnregisterPanel=4]="UnregisterPanel",e))(De||{});let Re={0(e,t){var r;let s=G(e.tabs,p=>p.current),u=G(e.panels,p=>p.current),l=s.filter(p=>{var h;return!((h=p.current)!=null&&h.hasAttribute("disabled"))}),o={...e,tabs:s,panels:u};if(t.index<0||t.index>s.length-1){let p=U(Math.sign(t.index-e.selectedIndex),{[-1]:()=>1,0:()=>U(Math.sign(t.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(l.length===0)return o;let h=U(p,{0:()=>s.indexOf(l[0]),1:()=>s.indexOf(l[l.length-1])});return{...o,selectedIndex:h===-1?e.selectedIndex:h}}let c=s.slice(0,t.index),w=[...s.slice(t.index),...c].find(p=>l.includes(p));if(!w)return o;let m=(r=s.indexOf(w))!=null?r:e.selectedIndex;return m===-1&&(m=e.selectedIndex),{...o,selectedIndex:m}},1(e,t){if(e.tabs.includes(t.tab))return e;let r=e.tabs[e.selectedIndex],s=G([...e.tabs,t.tab],l=>l.current),u=e.selectedIndex;return e.info.current.isControlled||(u=s.indexOf(r),u===-1&&(u=e.selectedIndex)),{...e,tabs:s,selectedIndex:u}},2(e,t){return{...e,tabs:e.tabs.filter(r=>r!==t.tab)}},3(e,t){return e.panels.includes(t.panel)?e:{...e,panels:G([...e.panels,t.panel],r=>r.current)}},4(e,t){return{...e,panels:e.panels.filter(r=>r!==t.panel)}}},Q=a.createContext(null);Q.displayName="TabsDataContext";function O(e){let t=a.useContext(Q);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,O),r}return t}let Z=a.createContext(null);Z.displayName="TabsActionsContext";function ee(e){let t=a.useContext(Z);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,ee),r}return t}function Oe(e,t){return U(t.type,Re,e,t)}let Ge="div";function Ue(e,t){let{defaultIndex:r=0,vertical:s=!1,manual:u=!1,onChange:l,selectedIndex:o=null,...c}=e;const w=s?"vertical":"horizontal",m=u?"manual":"auto";let p=o!==null,h=q({isControlled:p}),y=B(t),[b,f]=a.useReducer(Oe,{info:h,selectedIndex:o??r,tabs:[],panels:[]}),E=a.useMemo(()=>({selectedIndex:b.selectedIndex}),[b.selectedIndex]),$=q(l||(()=>{})),j=q(b.tabs),g=a.useMemo(()=>({orientation:w,activation:m,...b}),[w,m,b]),z=L(d=>(f({type:1,tab:d}),()=>f({type:2,tab:d}))),F=L(d=>(f({type:3,panel:d}),()=>f({type:4,panel:d}))),v=L(d=>{i.current!==d&&$.current(d),p||f({type:0,index:d})}),i=q(p?e.selectedIndex:b.selectedIndex),k=a.useMemo(()=>({registerTab:z,registerPanel:F,change:v}),[]);V(()=>{f({type:0,index:o??r})},[o]),V(()=>{if(i.current===void 0||b.tabs.length<=0)return;let d=G(b.tabs,P=>P.current);d.some((P,N)=>b.tabs[N]!==P)&&v(d.indexOf(b.tabs[i.current]))});let M={ref:y},C=J();return R.createElement(Ae,null,R.createElement(Z.Provider,{value:k},R.createElement(Q.Provider,{value:g},g.tabs.length<=0&&R.createElement(Fe,{onFocus:()=>{var d,P;for(let N of j.current)if(((d=N.current)==null?void 0:d.tabIndex)===0)return(P=N.current)==null||P.focus(),!0;return!1}}),C({ourProps:M,theirProps:c,slot:E,defaultTag:Ge,name:"Tabs"}))))}let We="div";function Be(e,t){let{orientation:r,selectedIndex:s}=O("Tab.List"),u=B(t),l=a.useMemo(()=>({selectedIndex:s}),[s]),o=e,c={ref:u,role:"tablist","aria-orientation":r};return J()({ourProps:c,theirProps:o,slot:l,defaultTag:We,name:"Tabs.List"})}let Je="button";function He(e,t){var r,s;let u=a.useId(),{id:l=`headlessui-tabs-tab-${u}`,disabled:o=!1,autoFocus:c=!1,...w}=e,{orientation:m,activation:p,selectedIndex:h,tabs:y,panels:b}=O("Tab"),f=ee("Tab"),E=O("Tab"),[$,j]=a.useState(null),g=a.useRef(null),z=B(g,t,j);V(()=>f.registerTab(g),[f,g]);let F=ce("tabs"),v=y.indexOf(g);v===-1&&(v=F);let i=v===h,k=L(x=>{var I;let H=x();if(H===K.Success&&p==="auto"){let ge=(I=we(g))==null?void 0:I.activeElement,se=E.tabs.findIndex(me=>me.current===ge);se!==-1&&f.change(se)}return H}),M=L(x=>{let I=y.map(H=>H.current).filter(Boolean);if(x.key===T.Space||x.key===T.Enter){x.preventDefault(),x.stopPropagation(),f.change(v);return}switch(x.key){case T.Home:case T.PageUp:return x.preventDefault(),x.stopPropagation(),k(()=>D(I,S.First));case T.End:case T.PageDown:return x.preventDefault(),x.stopPropagation(),k(()=>D(I,S.Last))}if(k(()=>U(m,{vertical(){return x.key===T.ArrowUp?D(I,S.Previous|S.WrapAround):x.key===T.ArrowDown?D(I,S.Next|S.WrapAround):K.Error},horizontal(){return x.key===T.ArrowLeft?D(I,S.Previous|S.WrapAround):x.key===T.ArrowRight?D(I,S.Next|S.WrapAround):K.Error}}))===K.Success)return x.preventDefault()}),C=a.useRef(!1),d=L(()=>{var x;C.current||(C.current=!0,(x=g.current)==null||x.focus({preventScroll:!0}),f.change(v),Pe(()=>{C.current=!1}))}),P=L(x=>{x.preventDefault()}),{isFocusVisible:N,focusProps:de}=oe({autoFocus:c}),{isHovered:te,hoverProps:fe}=ye({isDisabled:o}),{pressed:re,pressProps:xe}=je({disabled:o}),pe=a.useMemo(()=>({selected:i,hover:te,active:re,focus:N,autofocus:c,disabled:o}),[i,te,N,re,c,o]),be=ie({ref:z,onKeyDown:M,onMouseDown:P,onClick:d,id:l,role:"tab",type:ke(e,$),"aria-controls":(s=(r=b[v])==null?void 0:r.current)==null?void 0:s.id,"aria-selected":i,tabIndex:i?0:-1,disabled:o||void 0,autoFocus:c},de,fe,xe);return J()({ourProps:be,theirProps:w,slot:pe,defaultTag:Je,name:"Tabs.Tab"})}let Ke="div";function qe(e,t){let{selectedIndex:r}=O("Tab.Panels"),s=B(t),u=a.useMemo(()=>({selectedIndex:r}),[r]),l=e,o={ref:s};return J()({ourProps:o,theirProps:l,slot:u,defaultTag:Ke,name:"Tabs.Panels"})}let _e="div",Ve=ne.RenderStrategy|ne.Static;function Xe(e,t){var r,s,u,l;let o=a.useId(),{id:c=`headlessui-tabs-panel-${o}`,tabIndex:w=0,...m}=e,{selectedIndex:p,tabs:h,panels:y}=O("Tab.Panel"),b=ee("Tab.Panel"),f=a.useRef(null),E=B(f,t);V(()=>b.registerPanel(f),[b,f]);let $=ce("panels"),j=y.indexOf(f);j===-1&&(j=$);let g=j===p,{isFocusVisible:z,focusProps:F}=oe(),v=a.useMemo(()=>({selected:g,focus:z}),[g,z]),i=ie({ref:E,id:c,role:"tabpanel","aria-labelledby":(s=(r=h[j])==null?void 0:r.current)==null?void 0:s.id,tabIndex:g?w:-1},F),k=J();return!g&&((u=m.unmount)==null||u)&&!((l=m.static)!=null&&l)?R.createElement(le,{"aria-hidden":"true",...i}):k({ourProps:i,theirProps:m,slot:v,defaultTag:_e,features:Ve,visible:g,name:"Tabs.Panel"})}let Ye=W(He),Qe=W(Ue),Ze=W(Be),et=W(qe),tt=W(Xe),A=Object.assign(Ye,{Group:Qe,List:Ze,Panels:et,Panel:tt});function rt(e){return Y({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"},child:[]}]})(e)}function st(e){return Y({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(e)}function nt(e){return Y({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(e)}const ut=()=>{const{logout:e,isAuthenticated:t,isSuperUser:r,username:s}=Te(),u=Se(),[l,o]=a.useState(""),[c,w]=a.useState(""),[m,p]=a.useState(""),[h,y]=a.useState({}),[b,f]=a.useState(!1),[E,$]=a.useState(null),[j,g]=a.useState(!1),z=_.object({currentPassword:_.string().min(1,"Kötelező mező"),newPassword:_.string().min(6,"A jelszónak legalább 6 karakter hosszúnak kell lennie"),confirmPassword:_.string()}).refine(i=>i.newPassword===i.confirmPassword,{message:"A jelszavak nem egyeznek",path:["confirmPassword"]}),F=async()=>{try{await e(),ae.success("Sikeres kijelentkezés!"),u({to:"/login"})}catch{ae.error("Hiba történt a kijelentkezés során")}},v=async i=>{var M,C;i.preventDefault(),f(!0),$(null);const k=z.safeParse({currentPassword:l,newPassword:c,confirmPassword:m});if(!k.success){const d={};k.error.issues.forEach(P=>{d[P.path[0]]=P.message}),y(d),f(!1);return}try{await Ee(l,c,m),$("Jelszó sikeresen frissítve!"),o(""),w(""),p(""),y({})}catch(d){y({general:((C=(M=d.response)==null?void 0:M.data)==null?void 0:C.error)||"Hiba történt a jelszó frissítésekor"})}finally{f(!1)}};return n.jsxs(n.Fragment,{children:[n.jsx(Ie,{}),n.jsx("div",{className:"lg:hidden p-4 flex justify-between items-center mt-15 z-50 overflow-hidden",children:n.jsx("button",{className:"text-white p-2 border-white rounded-md focus:outline-none",onClick:()=>g(!0),"aria-label":"Open menu",children:n.jsx($e,{size:36})})}),n.jsx(A.Group,{children:n.jsxs("div",{className:"flex mt-4 relative",children:[n.jsxs("div",{className:`w-64 p-6 space-y-4 bg-gray-800 transition-all duration-300 transform lg:h-[110dvh] mt-13 h-full fixed z-40 top-0 lg:relative ${j?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[n.jsx("div",{className:"lg:hidden flex justify-end mb-4",children:n.jsx("button",{className:"text-white bg-gray-600 p-1 rounded",onClick:()=>g(!1),"aria-label":"Close menu",children:n.jsx(nt,{size:24,style:{strokeWidth:3}})})}),n.jsxs(A.List,{className:"space-y-4",children:[n.jsx(A,{className:({selected:i})=>`block w-full px-4 py-4 text-xl font-medium text-center transition-colors rounded  hover:cursor-pointer ${i?"bg-gray-700 text-teal-500 font-bold ":"text-gray-300 hover:bg-gray-600"}`,children:"Rólam"}),n.jsx(A,{className:({selected:i})=>`block w-full px-4 py-4 text-xl font-medium transition-colors rounded text-center hover:cursor-pointer ${i?"bg-gray-700 text-teal-500 font-bold":"text-gray-300 hover:bg-gray-600"}`,children:"Jelszó módosítása"})]})]}),n.jsxs("div",{className:"flex-1 p-8 ml-0 lg:mr-64 lg:ml-64",children:[n.jsx(A.Panels,{children:n.jsx(A.Panel,{children:n.jsxs("div",{className:"flex flex-col justify-center items-center h-full min-h-[60vh] p-8 ml-0 ",children:[n.jsxs("div",{className:"flex items-center space-x-6 p-6 rounded-2xl shadow-xl mb-6",children:[" ",n.jsx(st,{size:100,className:"text-white bg-gray-700 p-2 rounded-full"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-4xl font-bold mb-5 text-center justify-center",children:t?`${s}`:"Nincs felhasználói név"}),n.jsx("span",{className:`inline-block mt-2 px-3 py-1 text-lg font-semibold rounded-full text-white ${r?"bg-red-500":"bg-teal-500"}`,children:r?"Szuperfelhasználó":"Felhasználó"})]})]}),n.jsxs("button",{className:"w-auto px-4 py-2 text-xl text-white font-bold hover:bg-red-800 hover:cursor-pointer bg-red-700 rounded transition-colors flex items-center gap-2",onClick:F,children:[n.jsx(rt,{size:20}),"Kijelentkezés"]})]})})}),n.jsx(A.Panel,{children:n.jsx(ze,{error:h.general||null,success:E,label:"Jelszó módosítása",children:n.jsxs("form",{onSubmit:v,className:"space-y-6",children:[n.jsx(X,{label:"Jelenlegi jelszó",value:l,onChange:i=>o(i.target.value),error:h.currentPassword,enablePasswordToggle:!0}),n.jsx(X,{label:"Új jelszó",value:c,onChange:i=>w(i.target.value),error:h.newPassword,enablePasswordToggle:!0}),n.jsx(X,{label:"Jelszó megerősítése",value:m,onChange:i=>p(i.target.value),error:h.confirmPassword,enablePasswordToggle:!0}),n.jsx(Ce,{isPending:b,label:b?"Feldolgozás...":"Jelszó mentése"})]})})})]})]})})]})};export{ut as P};
