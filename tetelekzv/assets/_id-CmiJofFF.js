import{aa as O,j as e,ab as g,D as q,P,a as Q,u as R,d as A,c as I,r as p,y as f,N as F,S as K,O as B,L as M,ac as V,a8 as H,ad as W,ae as $}from"./index-W4Q2XZbk.js";import{u as G}from"./useQuery-D08VLsAS.js";import{u as J}from"./useMutation-C82pqCxx.js";import{F as U}from"./FlashCard-CS6xbqRz.js";import{e as X,g as Y}from"./repo-DCCUqUpe.js";import"./utils-km2FGkQ4.js";function Z(s){return O({select:n=>n.location})}function _({isOpen:s,onClose:n,onDelete:r,isDeleting:o,itemName:i}){return e.jsxs(g,{open:s,onClose:n,className:"relative z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsxs(g.Panel,{className:"w-full max-w-md rounded-lg bg-gray-800 p-6",children:[e.jsx(g.Title,{className:"text-xl font-bold text-gray-100 mb-4",children:"Tétel törlése"}),e.jsxs("p",{className:"text-gray-300 mb-6",children:['Biztosan törölni szeretnéd a(z) "',i,'" tételt? Minden kapcsolódó adat (összegzés, szekciók, flashcardok) végleg törlődni fog.']}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{onClick:n,className:"px-4 py-2 text-gray-300 hover:text-white",disabled:o,children:"Mégse"}),e.jsx("button",{onClick:r,disabled:o,className:`px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 \r
                         disabled:bg-red-400 disabled:cursor-not-allowed hover:cursor-pointer`,children:o?"Törlés...":"Törlés"})]})]})})]})}const ee=({questions:s,currentIdx:n,onNext:r,onExit:o})=>{var d,l;const i=s.length>0,x=s.length>1;return e.jsx(q,{show:!0,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",as:"div",children:e.jsx("div",{className:"flex flex-col items-center gap-6 mt-10",children:i&&e.jsxs(e.Fragment,{children:[e.jsx(U,{question:((d=s[n])==null?void 0:d.question)??"",answer:((l=s[n])==null?void 0:l.answer)??""}),e.jsxs("div",{className:"flex gap-4",children:[x&&e.jsxs("button",{onClick:r,className:`px-6 py-3 bg-orange-400 text-white rounded-lg hover:cursor-pointer\r
                             hover:bg-orange-600 transition-colors flex items-center`,children:[e.jsx(P,{className:"mr-2 animate-spin"}),"Következő kérdés"]}),e.jsx("button",{onClick:o,className:`px-6 py-3 border border-gray-400 text-gray-300 hover:cursor-pointer\r
                             rounded-lg hover:bg-gray-700 transition-colors`,children:"Vissza"})]})]})})})};function te(){const{isAuthenticated:s}=Q(),{id:n}=R({strict:!1}),r=Number(n),o=Z(),i=A(),x=I(),d=o.pathname.includes("/edit"),[l,b]=p.useState(!1),[u,j]=p.useState(0),[T,y]=p.useState(!1),{data:t,isLoading:C,error:v}=G({queryKey:["tetelDetail",r],queryFn:()=>Y(r),enabled:!isNaN(r)&&r>0,retry:2,refetchOnWindowFocus:!1}),N=J({mutationFn:()=>{if(!s)throw f.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return X(r)},onSuccess:()=>{x.invalidateQueries({queryKey:["tetelek"]}),i({to:"/tetelek"})},onError:a=>{a.message==="Nincs engedélyed a művelethez"&&f.info("Ehhez a művelethez be kell jelentkezned!")}});if(C)return e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(K,{})})]});if(v)return e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",v.message]});if(d)return e.jsx(B,{});const z=(t==null?void 0:t.tetel)??{name:"Ismeretlen tétel"},m=t==null?void 0:t.osszegzes,S=(t==null?void 0:t.sections)??[],c=(t==null?void 0:t.questions)??[],k=c.length>0,E=c.length>1,L=()=>{if(!E)return;let a=u;for(;a===u;)a=Math.floor(Math.random()*c.length);j(a)},D=()=>{k&&(j(Math.floor(Math.random()*c.length)),b(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsxs("main",{className:"relative md:max-w-7xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 py-10 text-left",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(M,{to:"/tetelek",className:`inline-flex items-center px-3 py-2 border border-gray-300 rounded-md\r
                       text-sm font-medium text-gray-400 hover:bg-gray-500 hover:text-white\r
                       focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors`,children:[e.jsx(V,{className:"mr-2"}),"Vissza a tételekhez"]}),!l&&k&&e.jsxs("button",{onClick:D,className:`inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 \r
                         rounded-md text-sm font-medium text-white hover:bg-purple-700 \r
                         focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer`,children:[e.jsx(H,{className:"mr-2"}),"Tanulás"]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-gray-100",children:z.name}),l?e.jsx(ee,{questions:c,currentIdx:u,onNext:L,onExit:()=>b(!1)}):e.jsxs("div",{className:"space-y-6",children:[S.map(a=>{var w;return e.jsxs("div",{className:`bg-gray-800 rounded-lg p-6 shadow-xl border border-gray-700\r
                           hover:border-gray-500 transition-colors`,children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-100",children:a.content}),(w=a.subsections)==null?void 0:w.map(h=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-gray-700 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-100 mb-2",children:h.title}),e.jsx("p",{className:"text-gray-300",children:h.description})]},h.id))]},a.id)}),(m==null?void 0:m.content)&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700 hover:border-gray-500 transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-100",children:"Összegzés"}),e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:m.content})]})]}),e.jsx(_,{isOpen:T,onClose:()=>y(!1),onDelete:()=>N.mutate(),isDeleting:N.isPending,itemName:z.name}),s&&e.jsxs(e.Fragment,{children:[e.jsx(M,{to:"/tetelek/$id/edit",params:{id:r.toString()},className:`fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full \r
                 hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50`,title:"Szerkeszd a tételt",children:e.jsx(W,{size:20})}),e.jsx("button",{onClick:()=>{if(!s){f.error("Ehhez be kell jelentkezned!");return}y(!0)},className:`fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full \r
                 hover:bg-rose-700 transition-all transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50`,title:"Töröld a tételt",children:e.jsx($,{size:20})})]})]})]})}const le=te;export{le as component};
