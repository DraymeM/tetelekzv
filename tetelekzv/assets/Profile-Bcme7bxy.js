import{r as a,E as he,R as D,G as le,H as ve,K as W,I as J,J as V,M,T as K,P as Pe,Q as T,U as R,V as I,W as U,X as we,$ as oe,Y as ye,Z as je,a0 as ie,a1 as ke,a2 as B,a3 as _,a4 as G,a5 as ne,a6 as Y,a as Te,d as Ie,j as n,N as Se,a7 as $e,y as ae}from"./index-GncX1r6g.js";import{z as q,F as ze,S as Ee}from"./SubmitButton-B8SN_Nro.js";import{u as Ce}from"./repo-HgviLFAr.js";import{I as X}from"./InputField-BbTPsTCZ.js";function Fe({onFocus:e}){let[t,r]=a.useState(!0),s=he();return t?D.createElement(le,{as:"button",type:"button",features:ve.Focusable,onFocus:u=>{u.preventDefault();let l,o=50;function c(){if(o--<=0){l&&cancelAnimationFrame(l);return}if(e()){if(cancelAnimationFrame(l),!s.current)return;r(!1);return}l=requestAnimationFrame(c)}l=requestAnimationFrame(c)}}):null}const ue=a.createContext(null);function Ne(){return{groups:new Map,get(e,t){var r;let s=this.groups.get(e);s||(s=new Map,this.groups.set(e,s));let u=(r=s.get(t))!=null?r:0;s.set(t,u+1);let l=Array.from(s.keys()).indexOf(t);function o(){let c=s.get(t);c>1?s.set(t,c-1):s.delete(t)}return[l,o]}}}function Ae({children:e}){let t=a.useRef(Ne());return a.createElement(ue.Provider,{value:t},e)}function ce(e){let t=a.useContext(ue);if(!t)throw new Error("You must wrap your component in a <StableCollection>");let r=a.useId(),[s,u]=t.current.get(e,r);return a.useEffect(()=>u,[]),s}var Me=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Me||{}),Le=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(Le||{}),Re=(e=>(e[e.SetSelectedIndex=0]="SetSelectedIndex",e[e.RegisterTab=1]="RegisterTab",e[e.UnregisterTab=2]="UnregisterTab",e[e.RegisterPanel=3]="RegisterPanel",e[e.UnregisterPanel=4]="UnregisterPanel",e))(Re||{});let De={0(e,t){var r;let s=G(e.tabs,x=>x.current),u=G(e.panels,x=>x.current),l=s.filter(x=>{var h;return!((h=x.current)!=null&&h.hasAttribute("disabled"))}),o={...e,tabs:s,panels:u};if(t.index<0||t.index>s.length-1){let x=U(Math.sign(t.index-e.selectedIndex),{[-1]:()=>1,0:()=>U(Math.sign(t.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(l.length===0)return o;let h=U(x,{0:()=>s.indexOf(l[0]),1:()=>s.indexOf(l[l.length-1])});return{...o,selectedIndex:h===-1?e.selectedIndex:h}}let c=s.slice(0,t.index),P=[...s.slice(t.index),...c].find(x=>l.includes(x));if(!P)return o;let g=(r=s.indexOf(P))!=null?r:e.selectedIndex;return g===-1&&(g=e.selectedIndex),{...o,selectedIndex:g}},1(e,t){if(e.tabs.includes(t.tab))return e;let r=e.tabs[e.selectedIndex],s=G([...e.tabs,t.tab],l=>l.current),u=e.selectedIndex;return e.info.current.isControlled||(u=s.indexOf(r),u===-1&&(u=e.selectedIndex)),{...e,tabs:s,selectedIndex:u}},2(e,t){return{...e,tabs:e.tabs.filter(r=>r!==t.tab)}},3(e,t){return e.panels.includes(t.panel)?e:{...e,panels:G([...e.panels,t.panel],r=>r.current)}},4(e,t){return{...e,panels:e.panels.filter(r=>r!==t.panel)}}},Q=a.createContext(null);Q.displayName="TabsDataContext";function O(e){let t=a.useContext(Q);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,O),r}return t}let Z=a.createContext(null);Z.displayName="TabsActionsContext";function ee(e){let t=a.useContext(Z);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,ee),r}return t}function Oe(e,t){return U(t.type,De,e,t)}let Ge="div";function Ue(e,t){let{defaultIndex:r=0,vertical:s=!1,manual:u=!1,onChange:l,selectedIndex:o=null,...c}=e;const P=s?"vertical":"horizontal",g=u?"manual":"auto";let x=o!==null,h=_({isControlled:x}),y=J(t),[b,f]=a.useReducer(Oe,{info:h,selectedIndex:o??r,tabs:[],panels:[]}),C=a.useMemo(()=>({selectedIndex:b.selectedIndex}),[b.selectedIndex]),$=_(l||(()=>{})),j=_(b.tabs),m=a.useMemo(()=>({orientation:P,activation:g,...b}),[P,g,b]),z=M(d=>(f({type:1,tab:d}),()=>f({type:2,tab:d}))),F=M(d=>(f({type:3,panel:d}),()=>f({type:4,panel:d}))),v=M(d=>{i.current!==d&&$.current(d),x||f({type:0,index:d})}),i=_(x?e.selectedIndex:b.selectedIndex),k=a.useMemo(()=>({registerTab:z,registerPanel:F,change:v}),[]);V(()=>{f({type:0,index:o??r})},[o]),V(()=>{if(i.current===void 0||b.tabs.length<=0)return;let d=G(b.tabs,w=>w.current);d.some((w,N)=>b.tabs[N]!==w)&&v(d.indexOf(b.tabs[i.current]))});let L={ref:y},E=B();return D.createElement(Ae,null,D.createElement(Z.Provider,{value:k},D.createElement(Q.Provider,{value:m},m.tabs.length<=0&&D.createElement(Fe,{onFocus:()=>{var d,w;for(let N of j.current)if(((d=N.current)==null?void 0:d.tabIndex)===0)return(w=N.current)==null||w.focus(),!0;return!1}}),E({ourProps:L,theirProps:c,slot:C,defaultTag:Ge,name:"Tabs"}))))}let We="div";function Je(e,t){let{orientation:r,selectedIndex:s}=O("Tab.List"),u=J(t),l=a.useMemo(()=>({selectedIndex:s}),[s]),o=e,c={ref:u,role:"tablist","aria-orientation":r};return B()({ourProps:c,theirProps:o,slot:l,defaultTag:We,name:"Tabs.List"})}let Be="button";function He(e,t){var r,s;let u=a.useId(),{id:l=`headlessui-tabs-tab-${u}`,disabled:o=!1,autoFocus:c=!1,...P}=e,{orientation:g,activation:x,selectedIndex:h,tabs:y,panels:b}=O("Tab"),f=ee("Tab"),C=O("Tab"),[$,j]=a.useState(null),m=a.useRef(null),z=J(m,t,j);V(()=>f.registerTab(m),[f,m]);let F=ce("tabs"),v=y.indexOf(m);v===-1&&(v=F);let i=v===h,k=M(p=>{var S;let H=p();if(H===K.Success&&x==="auto"){let me=(S=Pe(m))==null?void 0:S.activeElement,se=C.tabs.findIndex(ge=>ge.current===me);se!==-1&&f.change(se)}return H}),L=M(p=>{let S=y.map(H=>H.current).filter(Boolean);if(p.key===T.Space||p.key===T.Enter){p.preventDefault(),p.stopPropagation(),f.change(v);return}switch(p.key){case T.Home:case T.PageUp:return p.preventDefault(),p.stopPropagation(),k(()=>R(S,I.First));case T.End:case T.PageDown:return p.preventDefault(),p.stopPropagation(),k(()=>R(S,I.Last))}if(k(()=>U(g,{vertical(){return p.key===T.ArrowUp?R(S,I.Previous|I.WrapAround):p.key===T.ArrowDown?R(S,I.Next|I.WrapAround):K.Error},horizontal(){return p.key===T.ArrowLeft?R(S,I.Previous|I.WrapAround):p.key===T.ArrowRight?R(S,I.Next|I.WrapAround):K.Error}}))===K.Success)return p.preventDefault()}),E=a.useRef(!1),d=M(()=>{var p;E.current||(E.current=!0,(p=m.current)==null||p.focus({preventScroll:!0}),f.change(v),we(()=>{E.current=!1}))}),w=M(p=>{p.preventDefault()}),{isFocusVisible:N,focusProps:de}=oe({autoFocus:c}),{isHovered:te,hoverProps:fe}=ye({isDisabled:o}),{pressed:re,pressProps:pe}=je({disabled:o}),xe=a.useMemo(()=>({selected:i,hover:te,active:re,focus:N,autofocus:c,disabled:o}),[i,te,N,re,c,o]),be=ie({ref:z,onKeyDown:L,onMouseDown:w,onClick:d,id:l,role:"tab",type:ke(e,$),"aria-controls":(s=(r=b[v])==null?void 0:r.current)==null?void 0:s.id,"aria-selected":i,tabIndex:i?0:-1,disabled:o||void 0,autoFocus:c},de,fe,pe);return B()({ourProps:be,theirProps:P,slot:xe,defaultTag:Be,name:"Tabs.Tab"})}let Ke="div";function _e(e,t){let{selectedIndex:r}=O("Tab.Panels"),s=J(t),u=a.useMemo(()=>({selectedIndex:r}),[r]),l=e,o={ref:s};return B()({ourProps:o,theirProps:l,slot:u,defaultTag:Ke,name:"Tabs.Panels"})}let qe="div",Ve=ne.RenderStrategy|ne.Static;function Xe(e,t){var r,s,u,l;let o=a.useId(),{id:c=`headlessui-tabs-panel-${o}`,tabIndex:P=0,...g}=e,{selectedIndex:x,tabs:h,panels:y}=O("Tab.Panel"),b=ee("Tab.Panel"),f=a.useRef(null),C=J(f,t);V(()=>b.registerPanel(f),[b,f]);let $=ce("panels"),j=y.indexOf(f);j===-1&&(j=$);let m=j===x,{isFocusVisible:z,focusProps:F}=oe(),v=a.useMemo(()=>({selected:m,focus:z}),[m,z]),i=ie({ref:C,id:c,role:"tabpanel","aria-labelledby":(s=(r=h[j])==null?void 0:r.current)==null?void 0:s.id,tabIndex:m?P:-1},F),k=B();return!m&&((u=g.unmount)==null||u)&&!((l=g.static)!=null&&l)?D.createElement(le,{"aria-hidden":"true",...i}):k({ourProps:i,theirProps:g,slot:v,defaultTag:qe,features:Ve,visible:m,name:"Tabs.Panel"})}let Ye=W(He),Qe=W(Ue),Ze=W(Je),et=W(_e),tt=W(Xe),A=Object.assign(Ye,{Group:Qe,List:Ze,Panels:et,Panel:tt});function rt(e){return Y({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"},child:[]}]})(e)}function st(e){return Y({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(e)}function nt(e){return Y({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(e)}const ut=()=>{const{logout:e,isAuthenticated:t,isSuperUser:r,username:s}=Te(),u=Ie(),[l,o]=a.useState(""),[c,P]=a.useState(""),[g,x]=a.useState(""),[h,y]=a.useState({}),[b,f]=a.useState(!1),[C,$]=a.useState(null),[j,m]=a.useState(!1),z=q.object({currentPassword:q.string().min(1,"Kötelező mező"),newPassword:q.string().min(6,"A jelszónak legalább 6 karakter hosszúnak kell lennie"),confirmPassword:q.string()}).refine(i=>i.newPassword===i.confirmPassword,{message:"A jelszavak nem egyeznek",path:["confirmPassword"]}),F=async()=>{try{await e(),ae.success("Sikeres kijelentkezés!"),u({to:"/login"})}catch{ae.error("Hiba történt a kijelentkezés során")}},v=async i=>{var L,E;i.preventDefault(),f(!0),$(null);const k=z.safeParse({currentPassword:l,newPassword:c,confirmPassword:g});if(!k.success){const d={};k.error.issues.forEach(w=>{d[w.path[0]]=w.message}),y(d),f(!1);return}try{await Ce(l,c,g),$("Jelszó sikeresen frissítve!"),o(""),P(""),x(""),y({})}catch(d){y({general:((E=(L=d.response)==null?void 0:L.data)==null?void 0:E.error)||"Hiba történt a jelszó frissítésekor"})}finally{f(!1)}};return n.jsxs(n.Fragment,{children:[n.jsx(Se,{}),n.jsx("div",{className:"lg:hidden p-4 flex justify-between items-center mt-15 z-50 overflow-hidden",children:n.jsx("button",{className:" p-2 border-border rounded-md focus:outline-none",onClick:()=>m(!0),"aria-label":"Open menu",children:n.jsx($e,{size:36})})}),n.jsx(A.Group,{children:n.jsxs("div",{className:"flex mt-4 relative",children:[n.jsxs("div",{className:`w-64 p-6 space-y-4 bg-secondary transition-all duration-300 transform lg:h-[110dvh] mt-13 h-full fixed z-40 top-0 lg:relative ${j?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[n.jsx("div",{className:"lg:hidden flex justify-end mb-4",children:n.jsx("button",{className:"text-foreground bg-muted p-1 rounded",onClick:()=>m(!1),"aria-label":"Close menu",children:n.jsx(nt,{size:24,style:{strokeWidth:3}})})}),n.jsxs(A.List,{className:"space-y-4",children:[n.jsx(A,{className:({selected:i})=>`block w-full px-4 py-4 text-xl font-medium text-center transition-colors rounded  hover:cursor-pointer ${i?"bg-muted text-primary font-bold ":"text-secondary-foreground hover:bg-muted"}`,children:"Rólam"}),n.jsx(A,{className:({selected:i})=>`block w-full px-4 py-4 text-xl font-medium transition-colors rounded text-center hover:cursor-pointer ${i?"bg-muted text-primary font-bold ":"text-secondary-foreground hover:bg-muted"}`,children:"Jelszó módosítása"})]})]}),n.jsxs("div",{className:"flex-1 p-8 ml-0 lg:mr-64 lg:ml-64",children:[n.jsx(A.Panels,{children:n.jsx(A.Panel,{children:n.jsxs("div",{className:"flex flex-col justify-center items-center h-full min-h-[60vh] p-8 ml-0 ",children:[n.jsxs("div",{className:"flex items-center space-x-6 p-6 rounded-2xl shadow-xl mb-6",children:[" ",n.jsx(st,{size:100,className:"text-foreground bg-secondary p-2 rounded-full"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-4xl font-bold mb-5 text-center justify-center",children:t?`${s}`:"Nincs felhasználói név"}),n.jsx("span",{className:`inline-block mt-2 px-3 py-1 text-lg font-semibold rounded-full text-white ${r?"bg-red-500":"bg-teal-500"}`,children:r?"Szuperfelhasználó":"Felhasználó"})]})]}),n.jsxs("button",{className:"w-auto px-4 py-2 text-xl text-white font-bold hover:bg-red-800 hover:cursor-pointer bg-red-700 rounded transition-colors flex items-center gap-2",onClick:F,children:[n.jsx(rt,{size:20}),"Kijelentkezés"]})]})})}),n.jsx(A.Panel,{children:n.jsx(ze,{error:h.general||null,success:C,label:"Jelszó módosítása",children:n.jsxs("form",{onSubmit:v,className:"space-y-6",children:[n.jsx(X,{label:"Jelenlegi jelszó",value:l,onChange:i=>o(i.target.value),error:h.currentPassword,enablePasswordToggle:!0}),n.jsx(X,{label:"Új jelszó",value:c,onChange:i=>P(i.target.value),error:h.newPassword,enablePasswordToggle:!0}),n.jsx(X,{label:"Jelszó megerősítése",value:g,onChange:i=>x(i.target.value),error:h.confirmPassword,enablePasswordToggle:!0}),n.jsx(Ee,{isPending:b,label:b?"Feldolgozás...":"Jelszó mentése"})]})})})]})]})})]})};export{ut as P};
