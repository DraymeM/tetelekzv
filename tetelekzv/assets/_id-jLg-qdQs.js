const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PlayPauseControls-CSgysQQl.js","assets/index-kmHkZ3G4.js","assets/index-nqCCpPJI.css","assets/index-CLWfEBma.js","assets/VoiceSelector-CLxA7cMO.js","assets/SpeechSliders-_dWarK5B.js","assets/MarkdownHandler-ZGz4ser3.js"])))=>i.map(i=>d[i]);
import{G as R,r as s,j as e,z as L,v as A,i as F,S as T,w as B,x as $,_ as V,d as q,b as H,g as Q,f as K,R as G,y as _,O as U,a as E,p as W,s as X,A as Y,B as J}from"./index-kmHkZ3G4.js";import{u as Z}from"./useLocation-DGZk7Tag.js";import{u as ee}from"./useQuery-RbEzchDT.js";import{u as te}from"./useMutation-CSLThGRm.js";import{N as I}from"./Navbar-C731SFxd.js";import{g as se,h as re}from"./repo-pF7mNEog.js";import ne from"./DeleteModal-Dsd3SoQI.js";import{P as oe}from"./PageTransition-ugRpHncv.js";import ae from"./FlashCard-Cq0dzN-w.js";import{O as ie}from"./OfflinePlaceholder-B51CrRbi.js";import{l as O}from"./menu-Be-iGg_Q.js";import"./index-CLWfEBma.js";import"./index-DceL5wBQ.js";import"./use-resolve-button-type-BpufPY4Y.js";import"./bugs-CApWfGuR.js";import"./label-BYDPxjIC.js";function le(t){return R({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M48 399.26C48 335.19 62.44 284 90.91 247c34.38-44.67 88.68-68.77 161.56-71.75V72L464 252 252.47 432V329.35c-44.25 1.19-77.66 7.58-104.27 19.84-28.75 13.25-49.6 33.05-72.08 58.7L48 440z"},child:[]}]})(t)}const ce=({questions:t,onExit:x})=>{const[r,n]=s.useState(null),[u,d]=s.useState(null),l=i=>n(i),h=()=>{n(null),d(null)};return e.jsx(L,{show:!0,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",as:"div",children:e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx("div",{className:"w-full md:max-w-[450px] overflow-x-auto scrollbar-hide touch-pan-x",children:e.jsx("div",{className:"flex flex-row items-center space-x-[-30px] px-2 py-6 select-none",children:t.map((i,o)=>{const v=Math.floor(t.length/2),g=o>v,f=u===o,m=()=>{f?l(o):d(o)},a=f?g?"-translate-x-8":"translate-x-8":"",p=f?"":g?"hover:-translate-x-8":"hover:translate-x-8";return e.jsx("div",{onClick:m,className:`relative w-48 h-32 bg-secondary border border-border rounded-lg shadow-md flex items-center justify-center p-4
                    text-center font-semibold text-foreground cursor-pointer transition-transform duration-300 ease-in-out
                    ${f?`z-50 ${a} scale-125 border-primary text-primary shadow-lg`:""}
                    ${p} hover:z-50 hover:scale-125 hover:shadow-lg hover:border-primary hover:text-primary`,style:{transform:"skewY(-10deg)"},title:`Card ${o+1}`,children:e.jsxs("div",{className:"relative text-lg font-bold",children:[o+1,f&&e.jsx(A,{className:"absolute -top-6 left-1/2 -translate-x-1/2 text-primary text-xl"})]})},i.question)})})}),r!==null&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:h,className:"inline-flex items-center hover:cursor-pointer px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors","aria-label":"Put card back to deck",title:"Put card back to deck",children:[e.jsx(le,{className:"mr-2",style:{transform:"rotate(-90deg)"}}),"Vissza rak"]}),e.jsx(ae,{question:t[r]?.question??"",answer:t[r]?.answer??""}),e.jsxs("div",{className:"flex gap-4 mt-4",children:[e.jsxs("button",{onClick:x,className:"inline-flex items-center hover:cursor-pointer px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors","aria-label":"Vissza a tételekhez",title:"Vissza a tételhez",children:[e.jsx(F,{className:"mr-2"}),"Tételhez"]}),e.jsxs("button",{onClick:()=>{n(i=>{const o=i!==null&&i<t.length-1?i+1:0;return d(o),o})},className:"px-6 py-2 bg-amber-700 text-white rounded-lg hover:cursor-pointer hover:bg-amber-600 transition-colors flex items-center",children:[e.jsx(F,{className:"mr-2",style:{transform:"rotate(180deg)"}}),"Következő"]})]})]})]})})};function de(){const t=window.speechSynthesis,[x,r]=s.useState([]),[n,u]=s.useState(!1),[d,l]=s.useState(!1),h=s.useRef(null),i=()=>new Promise(m=>{let a=t.getVoices();if(a.length>0)r(a),m(a);else{const p=setInterval(()=>{a=t.getVoices(),a.length>0&&(clearInterval(p),r(a),m(a))},100)}});s.useEffect(()=>(i(),"onvoiceschanged"in t&&(t.onvoiceschanged=i),()=>{"onvoiceschanged"in t&&(t.onvoiceschanged=null)}),[]);const o=(m,a,p=1,N=1,j=1)=>{if(!m)return;f();const c=new SpeechSynthesisUtterance(m);if(a){const y=x.find(w=>w.name===a);y&&(c.voice=y)}c.rate=p,c.pitch=N,c.volume=j,c.onstart=()=>{u(!0),l(!1)},c.onend=()=>{u(!1),l(!1)},c.onerror=()=>{u(!1),l(!1)},h.current=c,t.speak(c)},v=()=>{t.speaking&&!t.paused&&(t.pause(),l(!0))},g=()=>{t.paused&&(t.resume(),l(!1))},f=()=>{t.cancel(),u(!1),l(!1)};return{voices:x,speak:o,pause:v,resume:g,stop:f,isSpeaking:n,isPaused:d}}const ue=()=>{if(typeof window>"u")return!1;const t=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone;return/Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile/i.test(navigator.userAgent)||t},me=s.lazy(()=>V(()=>import("./PlayPauseControls-CSgysQQl.js"),__vite__mapDeps([0,1,2,3]))),xe=s.lazy(()=>V(()=>import("./VoiceSelector-CLxA7cMO.js"),__vite__mapDeps([4,1,2]))),he=s.lazy(()=>V(()=>import("./SpeechSliders-_dWarK5B.js"),__vite__mapDeps([5,1,2]))),fe=({text:t,className:x})=>{if(typeof window<"u"&&ue())return null;const{voices:r,speak:n,pause:u,resume:d,stop:l,isSpeaking:h,isPaused:i}=de(),[o,v]=s.useState(),[g,f]=s.useState(1),[m,a]=s.useState(1),[p,N]=s.useState(1),[j,c]=s.useState(!1),[y,w]=s.useState("");s.useEffect(()=>{r.length>0&&!o&&v(r[0].name)},[r,o]),s.useEffect(()=>()=>window.speechSynthesis.cancel(),[]);const z=()=>{!t||r.length===0||(h?i?d():u():n(t,o,g,m,p))},C=b=>{v(b),c(!1),h&&l()},P=(b,M)=>{b==="rate"&&f(M),b==="pitch"&&a(M),b==="volume"&&N(M),h&&l()};return e.jsx(O,{as:"div",className:`relative inline-block text-left ${x??""}`,children:({open:b})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex space-x-0",children:[e.jsx(s.Suspense,{fallback:e.jsx(T,{}),children:e.jsx(me,{isSpeaking:h,isPaused:i,hasVoices:r.length>0,onClick:z})}),e.jsx(O.Button,{className:"inline-flex items-center px-2 py-2.5 bg-blue-600 border-l-2 border-blue-800 hover:cursor-pointer rounded-r-md text-sm font-medium text-white hover:bg-blue-700","aria-label":"Felolvasási Beállítások",title:"Felolvasási Beállítások",children:e.jsx(B,{size:16,className:`transition-transform duration-300 ${b?"rotate-180":"rotate-0"}`})})]}),e.jsx(O.Items,{className:"absolute right-0 mt-2 w-64 bg-secondary border border-border rounded-md shadow-lg p-4 space-y-4 max-h-[400px] overflow-auto z-50",children:e.jsxs(s.Suspense,{fallback:e.jsx(T,{}),children:[e.jsx(xe,{voices:r,selectedVoice:o,isDropdownOpen:j,setDropdownOpen:c,searchTerm:y,setSearchTerm:w,handleVoiceChange:C}),e.jsx(he,{rate:g,pitch:m,volume:p,onChange:P}),e.jsx("div",{className:"flex justify-between mt-2",children:e.jsxs("button",{onClick:l,disabled:!h,className:`inline-flex items-center px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition ${h?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx($,{}),e.jsx("span",{className:"ml-2",children:"Stop"})]})})]})})]})})};function pe(t,x){const r=d=>d.replace(/[#_*>\-`]/g,"").replace(/\[.*?\]\(.*?\)/g,"").replace(/!\[.*?\]\(.*?\)/g,"").replace(/`{1,3}[\s\S]*?`{1,3}/g,"").replace(/\s+/g," ").trim();let n="";t.forEach(d=>{n+=" "+r(d.content),d.subsections?.forEach(l=>{n+=" "+r(l.title||""),n+=" "+r(l.description||"")})}),x?.content&&(n+=" "+r(x.content));const u=n.split(" ").filter(Boolean).length;return Math.ceil(u/200)}function ge(){const{isAuthenticated:t,isSuperUser:x}=q(),{id:r}=H({strict:!1}),n=Number(r),u=Z(),d=Q(),l=K(),h=u.pathname.includes("/edit"),[i,o]=s.useState(!1),[v,g]=s.useState(0),[f,m]=s.useState(!1),{data:a,isLoading:p,error:N}=ee({queryKey:["tetelDetail",n],queryFn:()=>re(n),enabled:!isNaN(n)&&n>0,retry:2,refetchOnWindowFocus:!1});s.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"})},[u.pathname]);const j=G.lazy(()=>V(()=>import("./MarkdownHandler-ZGz4ser3.js").then(k=>k.M),__vite__mapDeps([6,1,2]))),c=te({mutationFn:()=>{if(!t||!x)throw _.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return se(n)},onSuccess:()=>{l.invalidateQueries({queryKey:["tetelek"]}),_.success("Sikeresen törölted a tételt."),d({to:"/tetelek"})}});if(p)return e.jsxs(e.Fragment,{children:[e.jsx(I,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(T,{})})]});if(N)return navigator.onLine?e.jsxs(e.Fragment,{children:[e.jsx(I,{}),e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",N.message]})]}):e.jsx(e.Fragment,{children:e.jsx(ie,{})});if(h)return e.jsx(U,{});const y=a?.tetel??{name:"Ismeretlen tétel"},w=a?.osszegzes,z=a?.sections??[],C=a?.questions??[],P=C.length>0,b=pe(z,w),M=[y.name,...z.flatMap(k=>[k.content,...k.subsections?.flatMap(S=>[S.title,S.description])??[]]),"Összegzés:",w?.content??"","Vége"].filter(Boolean).join(". "),D=()=>{P&&(g(Math.floor(Math.random()*C.length)),o(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(I,{}),e.jsx(s.Suspense,{fallback:e.jsx(T,{}),children:e.jsxs("main",{className:"relative md:max-w-7xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 py-10 text-left",children:[e.jsxs(oe,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(E,{to:"/tetelek",className:"inline-flex items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors","aria-label":"Vissza a tételekhez",title:"Vissza a tételekhez",children:[e.jsx(F,{className:"mr-2"}),"Tételekhez"]}),e.jsxs("div",{className:"flex items-center md:gap-4 gap-1",children:[!i&&e.jsxs("span",{className:"text-sm mx-auto text-secondary-foreground",children:[e.jsx(W,{className:"inline mr-1",size:15}),b," perc"]}),!i&&e.jsx(fe,{text:M}),!i&&P&&e.jsx("button",{onClick:D,className:"inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 rounded-md text-sm font-medium text-white hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer","aria-label":"Tanulás",title:"Tanulás",children:e.jsx(X,{size:20})})]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-foreground",children:y.name}),i?e.jsx(ce,{questions:C,onExit:()=>o(!1)},v):e.jsxs("div",{className:"space-y-6",children:[z.map(k=>e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow-xl border border-transparent hover:border-border transition-colors",children:[e.jsx(s.Suspense,{fallback:e.jsx("div",{className:"bg-secondary rounded-lg p-6 shadow-xl animate-pulse "}),children:e.jsx("div",{className:"text-xl font-semibold mb-4 text-foreground",children:e.jsx(j,{content:k.content})})}),k.subsections?.map(S=>e.jsx(s.Suspense,{fallback:e.jsx("div",{className:"bg-muted rounded-lg p-6 shadow-xl animate-pulse "}),children:e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"font-medium text-foreground mb-2",children:e.jsx(j,{content:S.title})}),e.jsx("div",{className:"text-secondary-foreground prose prose-invert max-w-none",children:e.jsx(j,{content:S.description})})]})},S.id))]},k.id)),w?.content&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 border border-transparent hover:border-border transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:"Összegzés"}),e.jsx("div",{className:"text-foreground prose prose-invert max-w-none whitespace-pre-wrap",children:e.jsx(j,{content:w.content})})]}),e.jsxs(E,{to:"/tetelek",className:"inline-flex items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors","aria-label":"Vissza a tételekhez",title:"Vissza a tételekhez",children:[e.jsx(F,{className:"mr-2"}),"Tételekhez"]})]}),e.jsx(ne,{isOpen:f,onClose:()=>m(!1),onDelete:()=>c.mutate(),isDeleting:c.isPending,itemName:y.name})]}),t&&e.jsxs(e.Fragment,{children:[e.jsx(E,{to:"/tetelek/$id/edit",params:{id:n.toString()},className:"fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Szerkeszd a tételt",children:e.jsx(Y,{size:20})}),e.jsx("button",{onClick:()=>{if(!t){_.error("Ehhez be kell jelentkezned!");return}m(!0)},className:"fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full hover:bg-rose-700 transition-all transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50",title:"Töröld a tételt",children:e.jsx(J,{size:20})})]})]})})]})}const Ee=ge;export{Ee as component};
