import{ab as R,j as e,ac as p,E as q,R as Q,a as A,u as I,e as P,d as K,r as f,y as x,N as M,S as B,O as V,L as S,ad as H,a9 as U,ae as W,af as $}from"./index-D11hHrFM.js";import{u as G}from"./useQuery-CIM2RExT.js";import{u as J}from"./useMutation-BkcVRlNx.js";import{F as X}from"./FlashCard-BIVeCMsy.js";import{e as Y,g as Z}from"./repo-Di0wT-X2.js";import"./utils-km2FGkQ4.js";function _(r){return R({select:n=>n.location})}function ee({isOpen:r,onClose:n,onDelete:o,isDeleting:t,itemName:i}){return e.jsxs(p,{open:r,onClose:n,className:"relative z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsxs(p.Panel,{className:"w-full max-w-md rounded-lg bg-gray-800 p-6",children:[e.jsx(p.Title,{className:"text-xl font-bold text-gray-100 mb-4",children:"Tétel törlése"}),e.jsxs("p",{className:"text-gray-300 mb-6",children:['Biztosan törölni szeretnéd a(z) "',i,'" tételt? Minden kapcsolódó adat (összegzés, szekciók, flashcardok) végleg törlődni fog.']}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{onClick:n,className:"px-4 py-2 text-gray-300 hover:text-white",disabled:t,children:"Mégse"}),e.jsx("button",{onClick:o,disabled:t,className:`px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 \r
                         disabled:bg-red-400 disabled:cursor-not-allowed hover:cursor-pointer`,children:t?"Törlés...":"Törlés"})]})]})})]})}const te=({questions:r,currentIdx:n,onNext:o,onExit:t})=>{var c,d;const i=r.length>0,u=r.length>1;return e.jsx(q,{show:!0,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",as:"div",children:e.jsx("div",{className:"flex flex-col items-center gap-6 mt-10",children:i&&e.jsxs(e.Fragment,{children:[e.jsx(X,{question:((c=r[n])==null?void 0:c.question)??"",answer:((d=r[n])==null?void 0:d.answer)??""}),e.jsxs("div",{className:"flex gap-4",children:[u&&e.jsxs("button",{onClick:o,className:`px-6 py-3 bg-orange-400 text-white rounded-lg hover:cursor-pointer\r
                             hover:bg-orange-600 transition-colors flex items-center`,children:[e.jsx(Q,{className:"mr-2 animate-spin"}),"Következő kérdés"]}),e.jsx("button",{onClick:t,className:`px-6 py-3 border border-gray-400 text-gray-300 hover:cursor-pointer\r
                             rounded-lg hover:bg-gray-700 transition-colors`,children:"Vissza"})]})]})})})};function se(){const{isAuthenticated:r,isSuperUser:n}=A(),{id:o}=I({strict:!1}),t=Number(o),i=_(),u=P(),c=K(),d=i.pathname.includes("/edit"),[b,y]=f.useState(!1),[h,j]=f.useState(0),[T,v]=f.useState(!1),{data:s,isLoading:C,error:N}=G({queryKey:["tetelDetail",t],queryFn:()=>Z(t),enabled:!isNaN(t)&&t>0,retry:2,refetchOnWindowFocus:!1}),z=J({mutationFn:()=>{if(!r)throw x.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");if(!n)throw x.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return Y(t)},onSuccess:()=>{c.invalidateQueries({queryKey:["tetelek"]}),x.success("Sikeresen törölted a tételt."),u({to:"/tetelek"})},onError:a=>{a.message}});if(C)return e.jsxs(e.Fragment,{children:[e.jsx(M,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(B,{})})]});if(N)return e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",N.message]});if(d)return e.jsx(V,{});const w=(s==null?void 0:s.tetel)??{name:"Ismeretlen tétel"},m=s==null?void 0:s.osszegzes,E=(s==null?void 0:s.sections)??[],l=(s==null?void 0:s.questions)??[],k=l.length>0,L=l.length>1,O=()=>{if(!L)return;let a=h;for(;a===h;)a=Math.floor(Math.random()*l.length);j(a)},D=()=>{k&&(j(Math.floor(Math.random()*l.length)),y(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(M,{}),e.jsxs("main",{className:"relative md:max-w-7xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 py-10 text-left",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(S,{to:"/tetelek",className:`inline-flex items-center px-3 py-2 border border-gray-300 rounded-md\r
                       text-sm font-medium text-gray-400 hover:bg-gray-500 hover:text-white\r
                       focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors`,children:[e.jsx(H,{className:"mr-2"}),"Vissza a tételekhez"]}),!b&&k&&e.jsxs("button",{onClick:D,className:`inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 \r
                         rounded-md text-sm font-medium text-white hover:bg-purple-700 \r
                         focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer`,children:[e.jsx(U,{className:"mr-2"}),"Tanulás"]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-gray-100",children:w.name}),b?e.jsx(te,{questions:l,currentIdx:h,onNext:O,onExit:()=>y(!1)}):e.jsxs("div",{className:"space-y-6",children:[E.map(a=>{var F;return e.jsxs("div",{className:`bg-gray-800 rounded-lg p-6 shadow-xl border border-gray-700\r
                           hover:border-gray-500 transition-colors`,children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-100",children:a.content}),(F=a.subsections)==null?void 0:F.map(g=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-gray-700 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-100 mb-2",children:g.title}),e.jsx("p",{className:"text-gray-300",children:g.description})]},g.id))]},a.id)}),(m==null?void 0:m.content)&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700 hover:border-gray-500 transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-100",children:"Összegzés"}),e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:m.content})]})]}),e.jsx(ee,{isOpen:T,onClose:()=>v(!1),onDelete:()=>z.mutate(),isDeleting:z.isPending,itemName:w.name}),r&&e.jsxs(e.Fragment,{children:[e.jsx(S,{to:"/tetelek/$id/edit",params:{id:t.toString()},className:`fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full \r
                 hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50`,title:"Szerkeszd a tételt",children:e.jsx(W,{size:20})}),e.jsx("button",{onClick:()=>{if(!r){x.error("Ehhez be kell jelentkezned!");return}v(!0)},className:`fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full \r
                 hover:bg-rose-700 transition-all transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50`,title:"Töröld a tételt",children:e.jsx($,{size:20})})]})]})]})}const ce=se;export{ce as component};
