const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TetelForm-msN8wsbk.js","assets/index-DNhYfZVa.js","assets/index-5GsZzLaf.css","assets/types-CZYGTQuY.js","assets/InputField-zIuhasih.js","assets/PageTransition-CKedCoC9.js","assets/index-6l3BXJum.js"])))=>i.map(i=>d[i]);
import{u as S,f as y,e as v,r,j as e,S as T,R as z,_ as P}from"./index-DNhYfZVa.js";import{u as _}from"./useQuery-B90wnf1T.js";import{u as k}from"./useMutation-DFJrYgeH.js";import{l as E,d as N}from"./repo-I0R3ESGW.js";import{P as q}from"./PageTransition-CKedCoC9.js";import{O as D}from"./OfflinePlaceholder-BfCSPmJv.js";import{u as F}from"./useOnlineStatus-CFArgxL8.js";const O=z.lazy(()=>P(()=>import("./TetelForm-msN8wsbk.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),M=()=>{const{id:m}=S({strict:!1}),i=Number(m),d=y(),f=v(),[p,l]=r.useState(null),[x,u]=r.useState(null),[b,o]=r.useState(!1),g=F(),{data:n}=_({queryKey:["tetelDetail",i],queryFn:()=>N(i),enabled:!isNaN(i)}),c=k({mutationFn:s=>E(i,s),onMutate:()=>{o(!0)},onSuccess:()=>{f.invalidateQueries({queryKey:["tetelDetail",i]}),u("Sikeres frissítés!"),setTimeout(()=>{u(null),d({to:`/tetelek/${i}`}),o(!1)},2e3)},onError:s=>{l(s.response?.data?.error||"Hiba a frissítés közben."),o(!1)}}),h=s=>{l(null),c.mutate({...s,sections:s.sections.map(t=>({...t,subsections:t.subsections.map(a=>({...a,id:a.id&&a.id<0?void 0:a.id}))})),flashcards:s.flashcards.map(t=>({...t,id:t.id&&t.id<0?void 0:t.id}))})};if(!g)return e.jsx(e.Fragment,{children:e.jsx(D,{})});const j={name:n?.tetel.name||"",osszegzes:n?.osszegzes?.content||"",sections:n?.sections.map(s=>({...s,subsections:s.subsections||[]}))||[{content:"",subsections:[]}],flashcards:n?.questions||[]};return e.jsx(e.Fragment,{children:e.jsx(q,{children:e.jsx(r.Suspense,{children:e.jsxs("div",{className:"relative",children:[b&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"rgba(25, 25, 30, 0.3)"},children:e.jsx(T,{})}),e.jsx(O,{initialData:j,onSubmit:h,isPending:c.isPending,error:p,success:x,label:"Tétel szerkesztése",submitLabel:"Tétel mentése"})]})})})})};export{M as T};
