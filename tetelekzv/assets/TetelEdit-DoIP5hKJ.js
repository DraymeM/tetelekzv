const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TetelForm-CxyI3yQc.js","assets/index-BV4Ew1CB.js","assets/index-DYx34bjO.css","assets/types-CZYGTQuY.js","assets/InputField-atYoBxRM.js","assets/PageTransition-CV21mfqc.js","assets/index-dkWrTg2q.js"])))=>i.map(i=>d[i]);
import{u as j,f as S,e as v,r,j as e,S as T,R as z,_ as k}from"./index-BV4Ew1CB.js";import{u as P}from"./useQuery-U3GhT_pK.js";import{u as _}from"./useMutation-DXNI1_Xa.js";import{l as E,d as q}from"./repo-DjS-Wy59.js";import{P as N}from"./PageTransition-CV21mfqc.js";import{O as D}from"./OfflinePlaceholder-e_2sxJ83.js";import{u as F}from"./useOnlineStatus-DPCafnqf.js";const O=z.lazy(()=>k(()=>import("./TetelForm-CxyI3yQc.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),M=()=>{const{id:d}=j({strict:!1}),i=Number(d),f=S(),l=v(),[p,u]=r.useState(null),[x,c]=r.useState(null),[b,o]=r.useState(!1),g=F(),{data:n}=P({queryKey:["tetelDetail",i],queryFn:()=>q(i),enabled:!isNaN(i)}),m=_({mutationFn:s=>E(i,s),onMutate:()=>{o(!0)},onSuccess:()=>{l.invalidateQueries({queryKey:["tetelDetail",i]}),l.invalidateQueries({queryKey:["tetelek"]}),c("Sikeres frissítés!"),setTimeout(()=>{c(null),f({to:`/tetelek/${i}`,replace:!0}),o(!1)},3e3)},onError:s=>{u(s.response?.data?.error||"Hiba a frissítés közben."),o(!1)}}),y=s=>{u(null),m.mutate({...s,sections:s.sections.map(t=>({...t,subsections:t.subsections.map(a=>({...a,id:a.id&&a.id<0?void 0:a.id}))})),flashcards:s.flashcards.map(t=>({...t,id:t.id&&t.id<0?void 0:t.id}))})};if(!g)return e.jsx(e.Fragment,{children:e.jsx(D,{})});const h={name:n?.tetel.name||"",osszegzes:n?.osszegzes?.content||"",sections:n?.sections.map(s=>({...s,subsections:s.subsections||[]}))||[{content:"",subsections:[]}],flashcards:n?.questions||[]};return e.jsx(e.Fragment,{children:e.jsx(N,{children:e.jsx(r.Suspense,{children:e.jsxs("div",{className:"relative",children:[b&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"rgba(25, 25, 30, 0.3)"},children:e.jsx(T,{})}),e.jsx(O,{initialData:h,onSubmit:y,isPending:m.isPending,error:p,success:x,label:"Tétel szerkesztése",submitLabel:"Tétel mentése"})]})})})})};export{M as T};
