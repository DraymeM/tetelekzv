import{a8 as O,j as e,a9 as g,A as D,G as q,u as Q,c as R,b as E,r as p,N as k,S as I,O as P,L as w,aa as A,a6 as K,ab as B,ac as V}from"./index-iAGKMsNr.js";import{u as G}from"./useQuery-CKb8X-9l.js";import{u as H}from"./useMutation-CMwQQl5e.js";import{F as W}from"./FlashCard-DRFvXySI.js";import{e as $,g as J}from"./repo-mV3UUzmy.js";function U(r){return O({select:t=>t.location})}function X({isOpen:r,onClose:t,onDelete:o,isDeleting:n,itemName:i}){return e.jsxs(g,{open:r,onClose:t,className:"relative z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsxs(g.Panel,{className:"w-full max-w-md rounded-lg bg-gray-800 p-6",children:[e.jsx(g.Title,{className:"text-xl font-bold text-gray-100 mb-4",children:"Tétel törlése"}),e.jsxs("p",{className:"text-gray-300 mb-6",children:['Biztosan törölni szeretnéd a(z) "',i,'" tételt? Minden kapcsolódó adat (összegzés, szekciók, flashcardok) végleg törlődni fog.']}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-300 hover:text-white",disabled:n,children:"Mégse"}),e.jsx("button",{onClick:o,disabled:n,className:`px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 \r
                         disabled:bg-red-400 disabled:cursor-not-allowed hover:cursor-pointer`,children:n?"Törlés...":"Törlés"})]})]})})]})}const Y=({questions:r,currentIdx:t,onNext:o,onExit:n})=>{var l,c;const i=r.length>0,x=r.length>1;return e.jsx(D,{show:!0,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",as:"div",children:e.jsx("div",{className:"flex flex-col items-center gap-6 mt-10",children:i&&e.jsxs(e.Fragment,{children:[e.jsx(W,{question:((l=r[t])==null?void 0:l.question)??"",answer:((c=r[t])==null?void 0:c.answer)??""}),e.jsxs("div",{className:"flex gap-4",children:[x&&e.jsxs("button",{onClick:o,className:`px-6 py-3 bg-orange-400 text-white rounded-lg\r
                             hover:bg-orange-600 transition-colors flex items-center`,children:[e.jsx(q,{className:"mr-2 animate-spin"}),"Következő kérdés"]}),e.jsx("button",{onClick:n,className:`px-6 py-3 border border-gray-400 text-gray-300\r
                             rounded-lg hover:bg-gray-700 transition-colors`,children:"Vissza"})]})]})})})};function Z(){const{id:r}=Q({strict:!1}),t=Number(r),o=U(),n=R(),i=E(),x=o.pathname.includes("/edit"),[l,c]=p.useState(!1),[u,f]=p.useState(0),[F,b]=p.useState(!1),{data:s,isLoading:M,error:j}=G({queryKey:["tetelDetail",t],queryFn:()=>J(t),enabled:!isNaN(t)&&t>0,retry:2,refetchOnWindowFocus:!1}),y=H({mutationFn:()=>$(t),onSuccess:()=>{i.invalidateQueries({queryKey:["tetelek"]}),n({to:"/tetelek"})}});if(M)return e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(I,{})})]});if(j)return e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",j.message]});if(x)return e.jsx(P,{});const N=(s==null?void 0:s.tetel)??{name:"Ismeretlen tétel"},m=s==null?void 0:s.osszegzes,T=(s==null?void 0:s.sections)??[],d=(s==null?void 0:s.questions)??[],v=d.length>0,C=d.length>1,S=()=>{if(!C)return;let a=u;for(;a===u;)a=Math.floor(Math.random()*d.length);f(a)},L=()=>{v&&(f(Math.floor(Math.random()*d.length)),c(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsxs("main",{className:"relative md:max-w-6xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 py-10 text-left",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(w,{to:"/tetelek",className:`inline-flex items-center px-3 py-2 border border-gray-300 rounded-md\r
                       text-sm font-medium text-gray-400 hover:bg-gray-500 hover:text-white\r
                       focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors`,children:[e.jsx(A,{className:"mr-2"}),"Vissza a tételekhez"]}),!l&&v&&e.jsxs("button",{onClick:L,className:`inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 \r
                         rounded-md text-sm font-medium text-white hover:bg-purple-700 \r
                         focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer`,children:[e.jsx(K,{className:"mr-2"}),"Tanulás"]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-gray-100",children:N.name}),l?e.jsx(Y,{questions:d,currentIdx:u,onNext:S,onExit:()=>c(!1)}):e.jsxs("div",{className:"space-y-6",children:[T.map(a=>{var z;return e.jsxs("div",{className:`bg-gray-800 rounded-lg p-6 shadow-xl border border-gray-700\r
                           hover:border-gray-500 transition-colors`,children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-100",children:a.content}),(z=a.subsections)==null?void 0:z.map(h=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-gray-700 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-100 mb-2",children:h.title}),e.jsx("p",{className:"text-gray-300",children:h.description})]},h.id))]},a.id)}),(m==null?void 0:m.content)&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700 hover:border-gray-500 transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-100",children:"Összegzés"}),e.jsx("p",{className:"text-gray-300 whitespace-pre-line",children:m.content})]})]}),e.jsx(X,{isOpen:F,onClose:()=>b(!1),onDelete:()=>y.mutate(),isDeleting:y.isPending,itemName:N.name}),e.jsx(w,{to:"/tetelek/$id/edit",params:{id:t.toString()},className:`fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full \r
                     hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50`,title:"Szerkeszd a tételt",children:e.jsx(B,{size:20})}),e.jsx("button",{onClick:()=>b(!0),className:`fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full \r
                     hover:bg-rose-700 transition-all transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50`,title:"Töröld a tételt",children:e.jsx(V,{size:20})})]})]})}const ne=Z;export{ne as component};
