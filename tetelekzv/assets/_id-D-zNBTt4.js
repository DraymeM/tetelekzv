import{j as e,z as O,m as q,a as Q,u as A,e as I,d as R,r as f,y as d,N as F,S as K,O as P,L as M,g as V,X as B,Z as H,a0 as U}from"./index-MfXWJZRy.js";import{u as W,D as X}from"./DeleteModal-DEi1rPJG.js";import{u as Z}from"./useQuery-Dld_li1V.js";import{u as $}from"./useMutation-C8t57buJ.js";import{F as G}from"./FlashCard-BFak-Hns.js";import{g as J,h as Y}from"./repo-WJTK3AE9.js";import"./utils-km2FGkQ4.js";const _=({questions:s,currentIdx:a,onNext:m,onExit:n})=>{var i,l;const u=s.length>0,x=s.length>1;return e.jsx(O,{show:!0,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",as:"div",children:e.jsx("div",{className:"flex flex-col items-center gap-6 mt-10",children:u&&e.jsxs(e.Fragment,{children:[e.jsx(G,{question:((i=s[a])==null?void 0:i.question)??"",answer:((l=s[a])==null?void 0:l.answer)??""}),e.jsxs("div",{className:"flex gap-4",children:[x&&e.jsxs("button",{onClick:m,className:`px-6 py-3 bg-orange-400 text-white rounded-lg hover:cursor-pointer\r
                             hover:bg-orange-600 transition-colors flex items-center`,children:[e.jsx(q,{className:"mr-2 animate-spin"}),"Következő kérdés"]}),e.jsx("button",{onClick:n,className:`px-6 py-3 border border-border text-muted-foreground hover:text-foreground hover:cursor-pointer\r
                             rounded-lg hover:bg-secondary transition-colors`,children:"Vissza"})]})]})})})};function ee(){const{isAuthenticated:s,isSuperUser:a}=Q(),{id:m}=A({strict:!1}),n=Number(m),u=W(),x=I(),i=R(),l=u.pathname.includes("/edit"),[g,b]=f.useState(!1),[h,j]=f.useState(0),[S,v]=f.useState(!1),{data:t,isLoading:C,error:N}=Z({queryKey:["tetelDetail",n],queryFn:()=>Y(n),enabled:!isNaN(n)&&n>0,retry:2,refetchOnWindowFocus:!1}),y=$({mutationFn:()=>{if(!s)throw d.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");if(!a)throw d.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return J(n)},onSuccess:()=>{i.invalidateQueries({queryKey:["tetelek"]}),d.success("Sikeresen törölted a tételt."),x({to:"/tetelek"})},onError:r=>{r.message}});if(C)return e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(K,{})})]});if(N)return e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",N.message]});if(l)return e.jsx(P,{});const z=(t==null?void 0:t.tetel)??{name:"Ismeretlen tétel"},c=t==null?void 0:t.osszegzes,D=(t==null?void 0:t.sections)??[],o=(t==null?void 0:t.questions)??[],w=o.length>0,E=o.length>1,L=()=>{if(!E)return;let r=h;for(;r===h;)r=Math.floor(Math.random()*o.length);j(r)},T=()=>{w&&(j(Math.floor(Math.random()*o.length)),b(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsxs("main",{className:"relative md:max-w-7xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 py-10 text-left",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(M,{to:"/tetelek",className:`inline-flex items-center px-3 py-2 border border-border rounded-md\r
                       text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground\r
                       focus:outline-none focus:ring-2 focus:ring-primary transition-colors`,children:[e.jsx(V,{className:"mr-2"}),"Vissza a tételekhez"]}),!g&&w&&e.jsxs("button",{onClick:T,className:`inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 \r
                         rounded-md text-sm font-medium text-white hover:bg-purple-700 \r
                         focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer`,children:[e.jsx(B,{className:"mr-2"}),"Tanulás"]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-foreground",children:z.name}),g?e.jsx(_,{questions:o,currentIdx:h,onNext:L,onExit:()=>b(!1)}):e.jsxs("div",{className:"space-y-6",children:[D.map(r=>{var k;return e.jsxs("div",{className:`bg-secondary rounded-lg p-6 shadow-xl border border-transparent\r
                           hover:border-border transition-colors`,children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-foreground",children:r.content}),(k=r.subsections)==null?void 0:k.map(p=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("h3",{className:"font-medium text-foreground mb-2",children:p.title}),e.jsx("p",{className:"text-secondary-foreground",children:p.description})]},p.id))]},r.id)}),(c==null?void 0:c.content)&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 border border-transparent hover:border-border transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:"Összegzés"}),e.jsx("p",{className:"text-foreground whitespace-pre-line",children:c.content})]})]}),e.jsx(X,{isOpen:S,onClose:()=>v(!1),onDelete:()=>y.mutate(),isDeleting:y.isPending,itemName:z.name}),s&&e.jsxs(e.Fragment,{children:[e.jsx(M,{to:"/tetelek/$id/edit",params:{id:n.toString()},className:`fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full \r
                 hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50`,title:"Szerkeszd a tételt",children:e.jsx(H,{size:20})}),e.jsx("button",{onClick:()=>{if(!s){d.error("Ehhez be kell jelentkezned!");return}v(!0)},className:`fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full \r
                 hover:bg-rose-700 transition-all transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50`,title:"Töröld a tételt",children:e.jsx(U,{size:20})})]})]})]})}const le=ee;export{le as component};
