const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FlashCard-BsUV1RpO.js","assets/index-CER22xXb.js","assets/index-wUruGGra.css","assets/CardDeck-CzNmf4u3.js","assets/RatingIcons-mho0rZx-.js","assets/CardControls-D4fW_V0s.js","assets/BottomControls-CtdC_hu5.js","assets/Tutorial-IOJwYH-9.js","assets/useLocation-GIBV1gM2.js","assets/useQuery-ClIWZxr4.js","assets/useMutation-BrtTyzDf.js","assets/Navbar-BSj_z4Ms.js","assets/index-CzrsLl1v.js","assets/index-CoTU-FEG.js","assets/repo-SNFxIZbT.js","assets/DeleteModal-CQL_98e-.js","assets/PageTransition-CKW7IJG5.js","assets/OfflinePlaceholder-DQdTLBPT.js","assets/menu-N2BgN8aE.js","assets/use-resolve-button-type-1f-oRt6N.js","assets/bugs-C2vnelg7.js","assets/label-zDOdfelT.js","assets/PlayPauseControls-0lMp9FDi.js","assets/VoiceSelector-BgKePs_z.js","assets/SpeechSliders-CqIWDEwu.js","assets/MarkdownHandler-ByoS4hXw.js"])))=>i.map(i=>d[i]);
import{r as s,G as A,j as e,z as L,v as B,S as M,_ as v,w as O,x as K,A as $,d as Q,b as q,g as U,f as G,R as H,y as C,O as W,a as P,i as R,p as J,s as X,B as Y,C as Z}from"./index-CER22xXb.js";import{u as ee}from"./useLocation-GIBV1gM2.js";import{u as te}from"./useQuery-ClIWZxr4.js";import{u as se}from"./useMutation-BrtTyzDf.js";import{N as V}from"./Navbar-BSj_z4Ms.js";import{g as ne,h as re}from"./repo-SNFxIZbT.js";import oe from"./DeleteModal-CQL_98e-.js";import{P as ae}from"./PageTransition-CKW7IJG5.js";import{O as ie}from"./OfflinePlaceholder-DQdTLBPT.js";import{l as F}from"./menu-N2BgN8aE.js";function le(t){const[i,n]=s.useState({}),[r,u]=s.useState([]);return s.useEffect(()=>{const o=Array.from({length:t},(c,d)=>d);o.sort((c,d)=>{const p=i[c]??-1,g=i[d]??-1;return p-g}),u(o)},[i,t]),{ratings:i,rateCard:(o,c)=>{n(d=>({...d,[o]:c}))},getRating:o=>i.hasOwnProperty(o)?i[o]:null,sortedIndexes:r}}function ce(t){return A({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M48 399.26C48 335.19 62.44 284 90.91 247c34.38-44.67 88.68-68.77 161.56-71.75V72L464 252 252.47 432V329.35c-44.25 1.19-77.66 7.58-104.27 19.84-28.75 13.25-49.6 33.05-72.08 58.7L48 440z"},child:[]}]})(t)}function Oe(t){return A({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m464 440-28.12-32.11c-22.48-25.65-43.33-45.45-72.08-58.7-26.61-12.26-60-18.65-104.27-19.84V432L48 252 259.53 72v103.21c72.88 3 127.18 27.08 161.56 71.75C449.56 284 464 335.19 464 399.26z"},child:[]}]})(t)}const de=[{title:"Kártyapakli",content:"Kattints egy kártyára a fókuszhoz. Kattints még egyszer a kiválasztáshoz.",selector:"#card-deck"},{title:"Aktív kártya",content:"Ez a kártya jelenik meg nagyban. Itt látod a kérdést és a választ.",selector:"#active-card"},{title:"Vissza rak gomb",content:"Ez a gomb vissza rakja az aktív kártyát a pakliba.",selector:"#put-back-button"},{title:"Értékelés",content:"Értékeld a kártyát tapasztalatod szerint. Az értékelés befolyásolja a sorrendet.",selector:"#card-controls"},{title:"Navigáció",content:"Következőre kattintva a következő kártyára lépsz. A 'Tételhez' gombbal kiléphetsz.",selector:"#bottom-controls"}],ue=s.lazy(()=>v(()=>import("./FlashCard-BsUV1RpO.js"),__vite__mapDeps([0,1,2]))),me=s.lazy(()=>v(()=>import("./CardDeck-CzNmf4u3.js"),__vite__mapDeps([3,1,2,4]))),xe=s.lazy(()=>v(()=>import("./CardControls-D4fW_V0s.js"),__vite__mapDeps([5,1,2,4]))),he=s.lazy(()=>v(()=>import("./BottomControls-CtdC_hu5.js"),__vite__mapDeps([6,1,2]))),pe=s.lazy(()=>v(()=>import("./Tutorial-IOJwYH-9.js"),__vite__mapDeps([7,1,2,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),fe=({questions:t,onExit:i})=>{const[n,r]=s.useState(t.length>0?0:null),[u,m]=s.useState(t.length>0?0:null),[l,o]=s.useState(!1),{rateCard:c,getRating:d,sortedIndexes:p}=le(t.length),g=()=>{r(null),m(null)},b=()=>{const h=n??-1,a=p.find(f=>f>h)??p.find(f=>f!==h)??p[0];r(a),m(a)};return e.jsx(e.Fragment,{children:e.jsxs(s.Suspense,{fallback:e.jsx(M,{}),children:[e.jsx(L,{show:!0,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",as:"div",children:e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx(me,{id:"card-deck",questions:t,sortedIndexes:p,selectedIdx:n,focusedIdx:u,getRating:d,setFocusedIdx:m,setSelectedIdx:r}),n!==null&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{id:"put-back-button",onClick:g,className:"inline-flex hover:cursor-pointer items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground transition",title:"Vissza rak",children:[e.jsx(ce,{className:"mr-2",style:{transform:"rotate(-90deg)"}}),"Vissza rak"]}),e.jsx(ue,{id:"active-card",question:t[n].question,answer:t[n].answer}),e.jsx(xe,{id:"card-controls",selectedIdx:n,rateCard:c,putBackToDeck:g,handleNext:b})]}),e.jsx(he,{id:"bottom-controls",onExit:i,showNext:n!==null,handleNext:b})]})}),e.jsx("button",{className:"fixed top-20 right-7 p-3 bg-blue-600 hover:cursor-pointer text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 z-50",onClick:()=>o(!0),title:"Segítség a használathoz",children:e.jsx(B,{size:20})}),e.jsx(pe,{open:l,onClose:()=>o(!1),steps:de})]})})};function ge(){const t=window.speechSynthesis,[i,n]=s.useState([]),[r,u]=s.useState(!1),[m,l]=s.useState(!1),o=s.useRef(null),c=()=>new Promise(h=>{let a=t.getVoices();if(a.length>0)n(a),h(a);else{const f=setInterval(()=>{a=t.getVoices(),a.length>0&&(clearInterval(f),n(a),h(a))},100)}});s.useEffect(()=>(c(),"onvoiceschanged"in t&&(t.onvoiceschanged=c),()=>{"onvoiceschanged"in t&&(t.onvoiceschanged=null)}),[]);const d=(h,a,f=1,w=1,k=1)=>{if(!h)return;b();const x=new SpeechSynthesisUtterance(h);if(a){const y=i.find(z=>z.name===a);y&&(x.voice=y)}x.rate=f,x.pitch=w,x.volume=k,x.onstart=()=>{u(!0),l(!1)},x.onend=()=>{u(!1),l(!1)},x.onerror=()=>{u(!1),l(!1)},o.current=x,t.speak(x)},p=()=>{t.speaking&&!t.paused&&(t.pause(),l(!0))},g=()=>{t.paused&&(t.resume(),l(!1))},b=()=>{t.cancel(),u(!1),l(!1)};return{voices:i,speak:d,pause:p,resume:g,stop:b,isSpeaking:r,isPaused:m}}const be=()=>{if(typeof window>"u")return!1;const t=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone;return/Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile/i.test(navigator.userAgent)||t},je=s.lazy(()=>v(()=>import("./PlayPauseControls-0lMp9FDi.js"),__vite__mapDeps([22,1,2,12]))),ve=s.lazy(()=>v(()=>import("./VoiceSelector-BgKePs_z.js"),__vite__mapDeps([23,1,2]))),ke=s.lazy(()=>v(()=>import("./SpeechSliders-CqIWDEwu.js"),__vite__mapDeps([24,1,2]))),ye=({text:t,className:i})=>{if(typeof window<"u"&&be())return null;const{voices:n,speak:r,pause:u,resume:m,stop:l,isSpeaking:o,isPaused:c}=ge(),[d,p]=s.useState(),[g,b]=s.useState(1),[h,a]=s.useState(1),[f,w]=s.useState(1),[k,x]=s.useState(!1),[y,z]=s.useState("");s.useEffect(()=>{n.length>0&&!d&&p(n[0].name)},[n,d]),s.useEffect(()=>()=>window.speechSynthesis.cancel(),[]);const N=()=>{!t||n.length===0||(o?c?m():u():r(t,d,g,h,f))},E=j=>{p(j),x(!1),o&&l()},T=(j,I)=>{j==="rate"&&b(I),j==="pitch"&&a(I),j==="volume"&&w(I),o&&l()};return e.jsx(F,{as:"div",className:`relative inline-block text-left ${i??""}`,children:({open:j})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex space-x-0",children:[e.jsx(s.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(O,{className:"animate-spin text-primary text-3xl"})}),children:e.jsx(je,{isSpeaking:o,isPaused:c,hasVoices:n.length>0,onClick:N})}),e.jsx(F.Button,{className:"inline-flex items-center px-2 py-2.5 bg-blue-600 border-l-2 border-blue-800 hover:cursor-pointer rounded-r-md text-sm font-medium text-white hover:bg-blue-700","aria-label":"Felolvasási Beállítások",title:"Felolvasási Beállítások",children:e.jsx(K,{size:16,className:`transition-transform duration-300 ${j?"rotate-180":"rotate-0"}`})})]}),e.jsx(F.Items,{className:"absolute right-0 mt-2 w-64 bg-secondary border border-border rounded-md shadow-lg p-4 space-y-4 max-h-[400px] overflow-auto z-50",children:e.jsxs(s.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(O,{className:"animate-spin text-primary min-h-[300px] max-w-[50px] text-4xl"})}),children:[e.jsx(ve,{voices:n,selectedVoice:d,isDropdownOpen:k,setDropdownOpen:x,searchTerm:y,setSearchTerm:z,handleVoiceChange:E}),e.jsx(ke,{rate:g,pitch:h,volume:f,onChange:T}),e.jsx("div",{className:"flex justify-between mt-2",children:e.jsxs("button",{onClick:l,disabled:!o,className:`inline-flex items-center px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition ${o?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx($,{}),e.jsx("span",{className:"ml-2",children:"Stop"})]})})]})})]})})};function ze(t,i){const n=m=>m.replace(/[#_*>\-`]/g,"").replace(/\[.*?\]\(.*?\)/g,"").replace(/!\[.*?\]\(.*?\)/g,"").replace(/`{1,3}[\s\S]*?`{1,3}/g,"").replace(/\s+/g," ").trim();let r="";t.forEach(m=>{r+=" "+n(m.content),m.subsections?.forEach(l=>{r+=" "+n(l.title||""),r+=" "+n(l.description||"")})}),i?.content&&(r+=" "+n(i.content));const u=r.split(" ").filter(Boolean).length;return Math.ceil(u/200)}function Se(){const{isAuthenticated:t,isSuperUser:i}=Q(),{id:n}=q({strict:!1}),r=Number(n),u=ee(),m=U(),l=G(),o=u.pathname.includes("/edit"),[c,d]=s.useState(!1),[p,g]=s.useState(0),[b,h]=s.useState(!1),{data:a,isLoading:f,error:w}=te({queryKey:["tetelDetail",r],queryFn:()=>re(r),enabled:!isNaN(r)&&r>0,retry:2,refetchOnWindowFocus:!1});s.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"})},[u.pathname]);const k=H.lazy(()=>v(()=>import("./MarkdownHandler-ByoS4hXw.js").then(S=>S.M),__vite__mapDeps([25,1,2]))),x=se({mutationFn:()=>{if(!t||!i)throw C.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return ne(r)},onSuccess:()=>{l.invalidateQueries({queryKey:["tetelek"]}),C.success("Sikeresen törölted a tételt."),m({to:"/tetelek"})}});if(f)return e.jsxs(e.Fragment,{children:[e.jsx(V,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(M,{})})]});if(w)return navigator.onLine?e.jsxs(e.Fragment,{children:[e.jsx(V,{}),e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",w.message]})]}):e.jsx(e.Fragment,{children:e.jsx(ie,{})});if(o)return e.jsx(W,{});const y=a?.tetel??{name:"Ismeretlen tétel"},z=a?.osszegzes,N=a?.sections??[],E=a?.questions??[],T=E.length>0,j=ze(N,z),I=[y.name,...N.flatMap(S=>[S.content,...S.subsections?.flatMap(_=>[_.title,_.description])??[]]),"Összegzés:",z?.content??"","Vége"].filter(Boolean).join(". "),D=()=>{T&&(g(Math.floor(Math.random()*E.length)),d(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(V,{}),e.jsx(s.Suspense,{fallback:e.jsx(M,{}),children:e.jsxs("main",{className:"relative md:max-w-7xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 pt-10 pb-1 text-left",children:[e.jsxs(ae,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(P,{to:"/tetelek",className:"inline-flex items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors","aria-label":"Vissza a tételekhez",title:"Vissza a tételekhez",children:[e.jsx(R,{className:"mr-2"}),"Tételekhez"]}),e.jsxs("div",{className:"flex items-center md:gap-4 gap-1",children:[!c&&e.jsxs("span",{className:"text-sm mx-auto text-secondary-foreground",children:[e.jsx(J,{className:"inline mr-1",size:15}),j," perc"]}),!c&&e.jsx(ye,{text:I}),!c&&T&&e.jsx("button",{onClick:D,className:"inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 rounded-md text-sm font-medium text-white hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer","aria-label":"Tanulás",title:"Tanulás",children:e.jsx(X,{size:20})})]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-foreground",children:y.name}),c?e.jsx(fe,{questions:E,onExit:()=>d(!1)},p):e.jsxs("div",{className:"space-y-6",children:[N.map(S=>e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow-xl border border-transparent hover:border-border transition-colors",children:[e.jsx(s.Suspense,{fallback:e.jsx("div",{className:"bg-secondary rounded-lg p-6 shadow-xl animate-pulse "}),children:e.jsx("div",{className:"text-xl font-semibold mb-4 text-foreground",children:e.jsx(k,{content:S.content})})}),S.subsections?.map(_=>e.jsx(s.Suspense,{fallback:e.jsx("div",{className:"bg-muted rounded-lg p-6 shadow-xl animate-pulse "}),children:e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"font-medium text-foreground mb-2",children:e.jsx(k,{content:_.title})}),e.jsx("div",{className:"text-secondary-foreground prose prose-invert max-w-none",children:e.jsx(k,{content:_.description})})]})},_.id))]},S.id)),z?.content&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 border border-transparent hover:border-border transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:"Összegzés"}),e.jsx("div",{className:"text-foreground prose prose-invert max-w-none whitespace-pre-wrap",children:e.jsx(k,{content:z.content})})]}),e.jsxs(P,{to:"/tetelek",className:"inline-flex items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors","aria-label":"Vissza a tételekhez",title:"Vissza a tételekhez",children:[e.jsx(R,{className:"mr-2"}),"Tételekhez"]})]}),e.jsx(oe,{isOpen:b,onClose:()=>h(!1),onDelete:()=>x.mutate(),isDeleting:x.isPending,itemName:y.name})]}),t&&!c&&e.jsxs(e.Fragment,{children:[e.jsx(P,{to:"/tetelek/$id/edit",params:{id:r.toString()},className:"fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Szerkeszd a tételt",children:e.jsx(Y,{size:20})}),e.jsx("button",{onClick:()=>{if(!t){C.error("Ehhez be kell jelentkezned!");return}h(!0)},className:"fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full hover:bg-rose-700 transition-all transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50",title:"Töröld a tételt",children:e.jsx(Z,{size:20})})]})]})})]})}const we=Se,Re=Object.freeze(Object.defineProperty({__proto__:null,component:we},Symbol.toStringTag,{value:"Module"}));export{Re as $,Oe as I};
