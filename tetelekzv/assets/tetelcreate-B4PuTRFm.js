import{r as d,c as M,j as e,b as j,d as z}from"./index-DNzlDc06.js";import{u as O,F as R,S as G,z as a}from"./SubmitButton-DFfEBB4L.js";import{a as J}from"./index-cNbRpIzP.js";const U=a.object({title:a.string().min(1,"Cím megadása kötelező"),description:a.string().min(1,"Leírás megadása kötelező")}).optional(),W=a.object({content:a.string().min(1,"Szekció tartalma kötelező"),subsections:a.array(U).optional()}),X=a.object({question:a.string().min(1,"Kérdés megadása kötelező"),answer:a.string().min(1,"Válasz megadása kötelező")}).optional(),K=a.object({name:a.string().min(1,"Tétel cím kötelező"),osszegzes:a.string().min(1,"Összegzés kötelező"),sections:a.array(W).min(1,"Legalább egy szekció szükséges"),flashcards:a.array(X).optional()}),Y=()=>{const[u,x]=d.useState(""),[m,i]=d.useState(""),[c,b]=d.useState([{content:"",subsections:[]}]),[h,f]=d.useState([]),[P,y]=d.useState(null),[_,k]=d.useState(null),[g,N]=d.useState({}),[l,p]=d.useState({}),L=M(),S=O({mutationFn:async s=>(await J.post("/tetelekzv/BackEnd/create_tetel.php",s,{headers:{"Content-Type":"application/json"}})).data,onSuccess:s=>{L.invalidateQueries({queryKey:["tetelek"]}),k(`Sikeres mentés! ID: ${s.tetel_id}`),setTimeout(()=>k(null),3e3),A()},onError:s=>{var t,n;y(((n=(t=s.response)==null?void 0:t.data)==null?void 0:n.error)||"Hiba történt")}}),A=()=>{x(""),i(""),b([{content:"",subsections:[]}]),f([]),N({}),p({})};d.useEffect(()=>{(()=>{const t=K.safeParse({name:u,osszegzes:m,sections:c.map(r=>({content:r.content,subsections:r.subsections.filter(o=>o.title||o.description)})),flashcards:h.filter(r=>r.question||r.answer)}),n={};t.success||t.error.errors.forEach(r=>{const o=r.path.join(".");n[o]=r.message}),N(n)})()},[u,m,c,h]);const C=()=>{b([...c,{content:"",subsections:[]}])},D=s=>{c.length!==1&&b(c.filter((t,n)=>n!==s))},B=(s,t)=>{const n=[...c];n[s].content=t,b(n),p({...l,[`sections.${s}.content`]:!0})},$=s=>{const t=[...c];t[s].subsections.push({title:"",description:""}),b(t)},H=(s,t)=>{const n=[...c];n[s].subsections=n[s].subsections.filter((r,o)=>o!==t),b(n)},F=(s,t,n,r)=>{const o=[...c];o[s].subsections[t][n]=r,b(o),p({...l,[`sections.${s}.subsections.${t}.${n}`]:!0})},q=()=>{f([...h,{question:"",answer:""}])},Q=s=>{f(h.filter((t,n)=>n!==s))},T=(s,t,n)=>{const r=[...h];r[s][t]=n,f(r),p({...l,[`flashcards.${s}.${t}`]:!0})},V=s=>{s.preventDefault(),y(null);const t={name:u,osszegzes:m,sections:c.map(r=>({content:r.content,subsections:r.subsections.filter(o=>o.title&&o.description)})),flashcards:h.filter(r=>r.question&&r.answer)},n=K.safeParse(t);if(!n.success){y("Kérjük javítsd a hibákat a mentés előtt");const r=n.error.errors.reduce((o,E)=>(o[E.path.join(".")]=E.message,o),{});N(r);return}S.mutate(t)};return e.jsx(R,{error:P,success:_,label:"Új Tétel",children:e.jsxs("form",{onSubmit:V,className:"space-y-6",children:[e.jsx(v,{label:"Tétel címe",value:u,onChange:s=>{x(s.target.value),p({...l,name:!0})},error:l.name?g.name:void 0}),e.jsx(w,{label:"Összegzés",value:m,onChange:s=>{i(s.target.value),p({...l,osszegzes:!0})},error:l.osszegzes?g.osszegzes:void 0}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-300",children:"Szekciók"}),e.jsx("button",{type:"button",onClick:C,className:"p-2 bg-green-600 text-white rounded-full hover:bg-green-700 transition-colors duration-200 cursor-pointer",children:e.jsx(j,{className:"w-5 h-5"})})]}),c.map((s,t)=>e.jsxs("div",{className:"p-4 border rounded-lg border-gray-700 relative group",children:[e.jsx("button",{type:"button",onClick:()=>D(t),disabled:c.length===1,className:"absolute -top-3 -right-3 text-red-500 bg-gray-900 rounded-full p-1 hover:bg-red-500/20 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(z,{className:"w-5 h-5"})}),e.jsx(w,{label:"Szekció tartalma",value:s.content,onChange:n=>B(t,n.target.value),error:l[`sections.${t}.content`]?g[`sections.${t}.content`]:void 0}),e.jsxs("div",{className:"mt-4 space-y-3",children:[s.subsections.length>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"text-md font-medium text-gray-400",children:"Alszekciók"}),e.jsx("button",{type:"button",onClick:()=>$(t),className:"p-2 bg-green-600 text-white rounded-full hover:bg-green-700 transition-colors duration-200 cursor-pointer",children:e.jsx(j,{className:"w-5 h-5"})})]}),s.subsections.map((n,r)=>e.jsxs("div",{className:"space-y-2 relative group",children:[e.jsx("button",{type:"button",onClick:()=>H(t,r),className:"absolute -top-3 -right-3 text-red-500 bg-gray-900 rounded-full p-1 hover:cursor-pointer hover:bg-red-500/20",children:e.jsx(z,{className:"w-5 h-5"})}),e.jsx(v,{label:"Cím",value:n.title,onChange:o=>F(t,r,"title",o.target.value),error:l[`sections.${t}.subsections.${r}.title`]?g[`sections.${t}.subsections.${r}.title`]:void 0}),e.jsx(w,{label:"Leírás",value:n.description,onChange:o=>F(t,r,"description",o.target.value),error:l[`sections.${t}.subsections.${r}.description`]?g[`sections.${t}.subsections.${r}.description`]:void 0})]},r))," ",e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"text-md font-medium text-gray-400",children:"Alszekció Hozzáadása"}),e.jsx("button",{type:"button",onClick:()=>$(t),className:"p-2 bg-green-600 text-white rounded-full hover:bg-green-700 transition-colors duration-200 cursor-pointer",children:e.jsx(j,{className:"w-5 h-5"})})]}),s.subsections.length===0]})]},t))]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-md  text-gray-400",children:"Szekció hozzáadása"}),e.jsx("button",{type:"button",onClick:C,className:"p-2 bg-green-600 text-white rounded-full hover:bg-green-700 transition-colors duration-200 cursor-pointer",children:e.jsx(j,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center border-t-2 p-1 border-gray-400",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-300",children:"Flashcardok"}),e.jsx("button",{type:"button",onClick:q,className:"p-2 bg-green-600 text-white rounded-full hover:bg-green-700 transition-colors duration-200 cursor-pointer",children:e.jsx(j,{className:"w-5 h-5"})})]}),h.length===0&&e.jsx("p",{className:"text-gray-400 text-sm",children:"Nincsenek flashcardok"}),h.map((s,t)=>e.jsxs("div",{className:"space-y-2 relative group",children:[e.jsx("button",{type:"button",onClick:()=>Q(t),className:"absolute -top-3 -right-3 text-red-500 bg-gray-900 rounded-full p-1 hover:cursor-pointer hover:bg-red-500/20",children:e.jsx(z,{className:"w-5 h-5"})}),e.jsx(v,{label:"Kérdés",value:s.question,onChange:n=>T(t,"question",n.target.value),error:l[`flashcards.${t}.question`]?g[`flashcards.${t}.question`]:void 0}),e.jsx(v,{label:"Válasz",value:s.answer,onChange:n=>T(t,"answer",n.target.value),error:l[`flashcards.${t}.answer`]?g[`flashcards.${t}.answer`]:void 0})," ",e.jsxs("div",{className:"flex justify-between items-center border-gray-400",children:[e.jsx("h3",{className:"text-md font-md text-gray-400",children:"Kártya hozzáadása"}),e.jsx("button",{type:"button",onClick:q,className:"p-2 bg-green-600 text-white rounded-full hover:bg-green-700 transition-colors duration-200 cursor-pointer",children:e.jsx(j,{className:"w-5 h-5"})})]})]},t))," "]}),e.jsx(G,{isPending:S.isPending,label:"Tétel Létrehozása"})]})})},v=({label:u,value:x,onChange:m,error:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:u}),e.jsx("input",{className:`w-full p-2 rounded bg-gray-800 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${i?"border border-red-500":"border border-gray-700"}`,value:x,onChange:m}),i&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i})]}),w=({label:u,value:x,onChange:m,error:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:u}),e.jsx("textarea",{className:`w-full p-2 rounded bg-gray-800 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${i?"border border-red-500":"border border-gray-700"}`,value:x,onChange:m,rows:4}),i&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i})]}),te=Y;export{te as component};
