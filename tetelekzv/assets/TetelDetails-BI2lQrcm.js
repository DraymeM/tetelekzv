const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DeleteModal-XX_gxvps.js","assets/index-DIxBzota.js","assets/index-Ba7vPGC1.css","assets/SpeechController-CmY3QEKc.js","assets/OfflinePlaceholder-B3DKf6Jg.js","assets/index-yyNjh57f.js","assets/menu-eGIYlnIB.js","assets/use-resolve-button-type-Dq7HP26t.js","assets/bugs-gxOEoQtn.js","assets/label-BDcK-X0p.js","assets/MarkdownHandler-Boo1vuld.js"])))=>i.map(i=>d[i]);
import{b as E,u as M,f as D,e as O,r as c,y as N,j as e,O as P,a as h,g as F,aG as R,R as g,aI as A,aJ as y,_ as b}from"./index-DIxBzota.js";import{u as C}from"./useLocation-CzZwow3l.js";import{u as I}from"./useQuery-DL4HnUFU.js";import{u as L}from"./useMutation-ABTRtzU8.js";import{i as V,d as q}from"./repo-CDFxhs3-.js";import{P as Q}from"./PageTransition-C6AlueE5.js";import{O as $}from"./OfflinePlaceholder-B3DKf6Jg.js";const H=g.lazy(()=>b(()=>import("./DeleteModal-XX_gxvps.js"),__vite__mapDeps([0,1,2]))),K=g.lazy(()=>b(()=>import("./SpeechController-CmY3QEKc.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9]))),p=g.lazy(()=>b(()=>import("./MarkdownHandler-Boo1vuld.js"),__vite__mapDeps([10,1,2]))),r=a=>a.replace(/<[^>]+>/g,"").replace(/{[^}]+}/g,"").replace(/&[a-zA-Z0-9#]+;/g,"").replace(/[#_*>\-`]/g,"").replace(/\[.*?\]\(.*?\)/g,"").replace(/!\[.*?\]\(.*?\)/g,"").replace(/`{1,3}[\s\S]*?`{1,3}/g,"").replace(/\s+/g," ").trim();function B(a,o){let n="";a.forEach(l=>{n+=" "+r(l.content),l.subsections?.forEach(m=>{n+=" "+r(m.title||""),n+=" "+r(m.description||"")})}),o?.content&&(n+=" "+r(o.content));const t=n.split(" ").filter(Boolean).length;return Math.ceil(t/200)}function ee(){const{isAuthenticated:a,isSuperUser:o}=E(),{id:n}=M({strict:!1}),t=Number(n),l=C(),m=D(),w=O(),_=l.pathname.includes("/edit"),[k,j]=c.useState(!1),{data:f,error:v}=I({queryKey:["tetelDetail",t],queryFn:()=>q(t),enabled:!isNaN(t)&&t>0,retry:2,refetchOnWindowFocus:!1});c.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"})},[l.pathname]);const z=L({mutationFn:()=>{if(!a||!o)throw N.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return V(t)},onSuccess:()=>{w.invalidateQueries({queryKey:["tetelek"]}),N.success("Sikeresen törölted a tételt."),m({to:"/tetelek"})}});if(v)return navigator.onLine?e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",v.message]}):e.jsx($,{});if(_)return e.jsx(P,{});const u=f?.tetel??{name:"Ismeretlen tétel"},i=f?.osszegzes,x=f?.sections??[],T=B(x,i),S=c.useMemo(()=>[r(u.name),...x.flatMap(s=>[r(s.content),...s.subsections?.flatMap(d=>[r(d.title||""),r(d.description||"")])??[]]),i?.content?"Összegzés: "+r(i.content):""].filter(s=>s&&s.length>0).join(" ").trim(),[u.name,x,i]);return e.jsx(c.Suspense,{children:e.jsxs("main",{className:"relative md:max-w-[75dvw] max-w-full mb-5 mx-auto mt-10 md:px-0 px-2 pt-10 pb-1 text-left",children:[e.jsxs(Q,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(h,{to:"/tetelek/$id",params:{id:t.toString()},className:"inline-flex items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors","aria-label":"Vissza a tétel áttekintéséhez",title:"Vissza a tételhez",children:[e.jsx(F,{className:"mr-2","aria-hidden":"true"}),"Vissza"]}),e.jsxs("div",{className:"flex items-center gap-4 ",children:[e.jsxs("span",{className:"text-sm mx-auto text-secondary-foreground",children:[e.jsx(R,{className:"inline mr-1",size:15,"aria-hidden":"true"}),T," perc"]}),e.jsx(K,{text:S})]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-foreground",children:u.name}),e.jsx("div",{className:"space-y-6",children:e.jsxs(c.Suspense,{fallback:e.jsx("div",{className:"bg-secondary rounded-lg p-6 shadow-xl animate-pulse "}),children:[x.map(s=>e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow-xl border border-transparent hover:border-border transition-colors",children:[e.jsx("div",{className:"text-xl font-semibold mb-4 text-foreground",children:e.jsx(p,{content:s.content})}),s.subsections?.map(d=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"font-medium text-foreground mb-2",children:e.jsx(p,{content:d.title})}),e.jsx("div",{className:"text-secondary-foreground prose prose-invert max-w-none",children:e.jsx(p,{content:d.description})})]}))]},s.id)),i?.content&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 border border-transparent hover:border-border transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:"Összegzés"}),e.jsx("div",{className:"text-foreground prose prose-invert max-w-none whitespace-pre-wrap",children:e.jsx(p,{content:i.content})})]})]})}),e.jsx(H,{isOpen:k,onClose:()=>j(!1),onDelete:()=>z.mutate(),isDeleting:z.isPending,itemName:u.name})]}),a&&o?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>j(!0),className:"fixed md:bottom-2 bottom-14 right-2 p-3 bg-rose-600 text-white rounded-full hover:bg-rose-700 hover:cursor-pointer transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Töröld a tételt","aria-label":"Töröld a tételt",children:e.jsx(A,{size:20,"aria-hidden":"true"})}),e.jsx(h,{to:"/tetelek/$id/details/edit",params:{id:t.toString()},className:"fixed md:bottom-16 bottom-28 right-2 p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Szerkeszd a tételt","aria-label":"Szerkeszd a tételt",children:e.jsx(y,{size:20,"aria-hidden":"true"})})]}):a?e.jsx(h,{to:"/tetelek/$id/details/edit",params:{id:t.toString()},className:"fixed md:bottom-2 bottom-14 right-2 p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Szerkeszd a tételt","aria-label":"Szerkeszd a tételt",children:e.jsx(y,{size:20,"aria-hidden":"true"})}):null]})})}export{ee as T};
