import{r,o as $,p as R,R as d,f as Q,m as ae,s as M,d as le,K as oe,H as ue,Q as ie,e as ce,w as de,g as O,h as fe,i as me,y as pe,k as he,l as K,I as ge,U as be,$ as xe,n as ve,q as ye,_ as Se,t as Ce,j as o,v as we,x as je,b as ke,S as $e}from"./index-iAGKMsNr.js";import{u as Ee}from"./useMutation-CMwQQl5e.js";import{z as j,F as Ne,S as Fe}from"./SubmitButton-CKfdo90M.js";import{a as qe}from"./repo-mV3UUzmy.js";function Pe(e,s,t){let[n,a]=r.useState(t),l=e!==void 0,p=r.useRef(l),i=r.useRef(!1),f=r.useRef(!1);return l&&!p.current&&!i.current?(i.current=!0,p.current=l,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!l&&p.current&&!f.current&&(f.current=!0,p.current=l,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[l?e:n,$(h=>(l||a(h),s==null?void 0:s(h)))]}function Te(e){let[s]=r.useState(e);return s}function H(e={},s=null,t=[]){for(let[n,a]of Object.entries(e))V(t,U(s,n),a);return t}function U(e,s){return e?e+"["+s+"]":s}function V(e,s,t){if(Array.isArray(t))for(let[n,a]of t.entries())V(e,U(s,n.toString()),a);else t instanceof Date?e.push([s,t.toISOString()]):typeof t=="boolean"?e.push([s,t?"1":"0"]):typeof t=="string"?e.push([s,t]):typeof t=="number"?e.push([s,`${t}`]):t==null?e.push([s,""]):H(t,s,e)}function ze(e){var s,t;let n=(s=e==null?void 0:e.form)!=null?s:e.closest("form");if(n){for(let a of n.elements)if(a!==e&&(a.tagName==="INPUT"&&a.type==="submit"||a.tagName==="BUTTON"&&a.type==="submit"||a.nodeName==="INPUT"&&a.type==="image")){a.click();return}(t=n.requestSubmit)==null||t.call(n)}}let Ie=r.createContext(null);function De({children:e}){let s=r.useContext(Ie);if(!s)return d.createElement(d.Fragment,null,e);let{target:t}=s;return t?le.createPortal(d.createElement(d.Fragment,null,e),t):null}function Ae({data:e,form:s,disabled:t,onReset:n,overrides:a}){let[l,p]=r.useState(null),i=R();return r.useEffect(()=>{if(n&&l)return i.addEventListener(l,"reset",n)},[l,s,n]),d.createElement(De,null,d.createElement(Ke,{setForm:p,formId:s}),H(e).map(([f,h])=>d.createElement(Q,{features:M.Hidden,...ae({key:f,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:s,disabled:t,name:f,value:h,...a})})))}function Ke({setForm:e,formId:s}){return r.useEffect(()=>{if(s){let t=document.getElementById(s);t&&e(t)}},[e,s]),s?null:d.createElement(Q,{features:M.Hidden,as:"input",type:"hidden",hidden:!0,readOnly:!0,ref:t=>{if(!t)return;let n=t.closest("form");n&&e(n)}})}let q=r.createContext(null);q.displayName="GroupContext";let Le=r.Fragment;function Re(e){var s;let[t,n]=r.useState(null),[a,l]=ce(),[p,i]=de(),f=r.useMemo(()=>({switch:t,setSwitch:n}),[t,n]),h={},w=e,b=O();return d.createElement(i,{name:"Switch.Description",value:p},d.createElement(l,{name:"Switch.Label",value:a,props:{htmlFor:(s=f.switch)==null?void 0:s.id,onClick(v){t&&(v.currentTarget instanceof HTMLLabelElement&&v.preventDefault(),t.click(),t.focus({preventScroll:!0}))}}},d.createElement(q.Provider,{value:f},b({ourProps:h,theirProps:w,slot:{},defaultTag:Le,name:"Switch.Group"}))))}let Qe="button";function Me(e,s){var t;let n=r.useId(),a=fe(),l=me(),{id:p=a||`headlessui-switch-${n}`,disabled:i=l||!1,checked:f,defaultChecked:h,onChange:w,name:b,value:v,form:N,autoFocus:y=!1,...F}=e,E=r.useContext(q),[c,u]=r.useState(null),m=r.useRef(null),k=pe(m,s,E===null?null:E.setSwitch,u),x=Te(h),[S,C]=Pe(f,w,x??!1),B=R(),[P,T]=r.useState(!1),z=$(()=>{T(!0),C==null||C(!S),B.nextFrame(()=>{T(!1)})}),G=$(g=>{if(he(g.currentTarget))return g.preventDefault();g.preventDefault(),z()}),_=$(g=>{g.key===K.Space?(g.preventDefault(),z()):g.key===K.Enter&&ze(g.currentTarget)}),J=$(g=>g.preventDefault()),W=ge(),X=be(),{isFocusVisible:I,focusProps:Y}=xe({autoFocus:y}),{isHovered:D,hoverProps:Z}=ve({isDisabled:i}),{pressed:A,pressProps:ee}=ye({disabled:i}),te=r.useMemo(()=>({checked:S,disabled:i,hover:D,focus:I,active:A,autofocus:y,changing:P}),[S,D,I,A,i,P,y]),se=Se({id:p,ref:k,role:"switch",type:Ce(e,c),tabIndex:e.tabIndex===-1?0:(t=e.tabIndex)!=null?t:0,"aria-checked":S,"aria-labelledby":W,"aria-describedby":X,disabled:i||void 0,autoFocus:y,onClick:G,onKeyUp:_,onKeyPress:J},Y,Z,ee),ne=r.useCallback(()=>{if(x!==void 0)return C==null?void 0:C(x)},[C,x]),re=O();return d.createElement(d.Fragment,null,b!=null&&d.createElement(Ae,{disabled:i,data:{[b]:v||"on"},overrides:{type:"checkbox",checked:S},form:N,onReset:ne}),re({ourProps:se,theirProps:F,slot:te,defaultTag:Qe,name:"Switch"}))}let Oe=oe(Me),He=Re,Ue=ie,Ve=ue,Be=Object.assign(Oe,{Group:He,Label:Ue,Description:Ve});const Ge=({question:e,setQuestion:s,fieldErrors:t,touched:n})=>o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Kérdés"}),o.jsx("input",{type:"text",value:e,onChange:a=>s(a.target.value),className:`w-full p-3 border rounded-lg bg-gray-800 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 transition ${n.question&&t.question?"border-red-500":"border-gray-700"} animate-in fade-in duration-300`,placeholder:"Add meg a kérdést"}),n.question&&t.question&&o.jsx("p",{className:"text-red-500 text-sm mt-1 animate-in fade-in duration-200",children:t.question})]}),_e=({answer:e,index:s,updateAnswer:t,fieldErrors:n,touched:a})=>o.jsxs("div",{className:"flex flex-col space-y-1 mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("span",{className:"text-gray-300 w-8 font-medium",children:[String.fromCharCode(65+s),"."]}),o.jsx("input",{type:"text",value:e.text,onChange:l=>t(s,"text",l.target.value),className:`flex-1 p-3 border rounded-lg bg-gray-800 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 transition ${a&&n?"border-red-500":"border-gray-700"} animate-in fade-in duration-300`,placeholder:`Válasz ${s+1}`}),o.jsx(Be,{checked:e.isCorrect,onChange:l=>t(s,"isCorrect",l),className:`${e.isCorrect?"bg-blue-600":"bg-gray-600"} relative inline-flex h-6 w-11 items-center hover:cursor-pointer rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 animate-in fade-in duration-300`,children:o.jsx("span",{className:`${e.isCorrect?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform bg-white rounded-full transition-transform`})}),o.jsx("span",{className:"text-gray-400 text-lg",children:e.isCorrect?o.jsx(we,{className:"text-green-500"}):o.jsx(je,{className:"text-red-500"})})]}),a&&n&&o.jsx("p",{className:"text-red-500 text-sm ml-11 animate-in fade-in duration-200",children:n})]}),Je=j.object({text:j.string().min(1,"A válasz szövege nem lehet üres"),isCorrect:j.boolean()}),L=j.object({question:j.string().min(1,"A kérdés megadása kötelező"),answers:j.array(Je).length(4,"Pontosan négy válasz szükséges").refine(e=>e.some(s=>s.isCorrect),{message:"Legalább egy válasznak helyesnek kell lennie"})}),We=()=>{const[e,s]=r.useState(""),[t,n]=r.useState([{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1}]),[a,l]=r.useState(null),[p,i]=r.useState(null),[f,h]=r.useState({question:void 0,answers:[null,null,null,null]}),[w,b]=r.useState({question:!1,answers:[!1,!1,!1,!1]}),[,v]=r.useState(!1),N=ke(),y=Ee({mutationFn:c=>qe(c),onSuccess:()=>{N.invalidateQueries({queryKey:["multiQuestions"]}),s(""),n([{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1}]),l(null),h({question:void 0,answers:[null,null,null,null]}),b({question:!1,answers:[!1,!1,!1,!1]}),v(!1),i("Kérdés létrehozva!"),setTimeout(()=>i(null),3e3)},onError:c=>{var u,m;l(((m=(u=c.response)==null?void 0:u.data)==null?void 0:m.error)||c.message||"Nem sikerült a kérdés létrehozása")}});r.useEffect(()=>{const c=L.safeParse({question:e,answers:t}),u={question:void 0,answers:[null,null,null,null]};c.success||c.error.errors.forEach(m=>{m.path[0]==="question"?u.question=m.message:m.path[0]==="answers"&&typeof m.path[1]=="number"&&(u.answers[m.path[1]]=m.message)}),h(u)},[e,t]);const F=(c,u,m)=>{const k=[...t];k[c]={...k[c],[u]:m},n(k),b(x=>({...x,answers:x.answers.map((S,C)=>C===c?!0:S)}))},E=c=>{c.preventDefault(),l(null),i(null),v(!0);const u=L.safeParse({question:e,answers:t});if(!u.success){l(u.error.errors[0].message),b({question:!0,answers:[!0,!0,!0,!0]});return}y.mutate({question:e,answers:t})};return o.jsx(r.Suspense,{fallback:o.jsx($e,{}),children:o.jsx(Ne,{error:a,success:p,label:"Új Felelet Választós Kérdés",children:o.jsxs("form",{onSubmit:E,className:"space-y-6",children:[o.jsx(Ge,{question:e,setQuestion:s,fieldErrors:f,touched:w}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Válaszok"}),t.map((c,u)=>o.jsx(_e,{answer:c,index:u,updateAnswer:F,fieldErrors:f.answers[u],touched:w.answers[u]},u))]}),o.jsx(Fe,{isPending:y.isPending,label:"Kérdés Létrehozása"})]})})})},tt=We;export{tt as component};
