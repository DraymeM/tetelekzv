const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LearningMode-8jihy6R4.js","assets/index-Devi4yYS.js","assets/index-DBzWI3Al.css","assets/FlashCard-DFqXdI7J.js"])))=>i.map(i=>d[i]);
import{a as T,u as q,d as I,b as R,r as i,y as l,j as e,N,S as v,O as A,L as y,f as P,v as Q,R as K,x as V,A as B,_ as H}from"./index-Devi4yYS.js";import{u as U,D as W}from"./DeleteModal-Sl3hdD4U.js";import{u as $}from"./useQuery-CFWVEYDE.js";import{u as G}from"./useMutation-BqAPE7zp.js";import{g as J,h as X}from"./repo-Br9-sPjB.js";import"./utils-km2FGkQ4.js";const Y=K.lazy(()=>H(()=>import("./LearningMode-8jihy6R4.js"),__vite__mapDeps([0,1,2,3])));function Z(){const{isAuthenticated:a,isSuperUser:z}=T(),{id:w}=q({strict:!1}),r=Number(w),k=U(),M=I(),S=R(),D=k.pathname.includes("/edit"),[m,u]=i.useState(!1),[d,x]=i.useState(0),[E,h]=i.useState(!1),{data:t,isLoading:F,error:f}=$({queryKey:["tetelDetail",r],queryFn:()=>X(r),enabled:!isNaN(r)&&r>0,retry:2,refetchOnWindowFocus:!1}),p=G({mutationFn:()=>{if(!a)throw l.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");if(!z)throw l.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return J(r)},onSuccess:()=>{S.invalidateQueries({queryKey:["tetelek"]}),l.success("Sikeresen törölted a tételt."),M({to:"/tetelek"})},onError:s=>{s.message}});if(F)return e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(v,{})})]});if(f)return e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",f.message]});if(D)return e.jsx(A,{});const g=(t==null?void 0:t.tetel)??{name:"Ismeretlen tétel"},o=t==null?void 0:t.osszegzes,L=(t==null?void 0:t.sections)??[],n=(t==null?void 0:t.questions)??[],b=n.length>0,O=n.length>1,_=()=>{if(!O)return;let s=d;for(;s===d;)s=Math.floor(Math.random()*n.length);x(s)},C=()=>{b&&(x(Math.floor(Math.random()*n.length)),u(!0))};return e.jsx(e.Fragment,{children:e.jsxs(i.Suspense,{fallback:e.jsx(v,{}),children:[e.jsx(N,{}),e.jsxs("main",{className:"relative md:max-w-7xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 py-10 text-left",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(y,{to:"/tetelek",className:`inline-flex items-center px-3 py-2 border border-border rounded-md\r
                       text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground\r
                       focus:outline-none focus:ring-2 focus:ring-primary transition-colors`,children:[e.jsx(P,{className:"mr-2"}),"Vissza a tételekhez"]}),!m&&b&&e.jsxs("button",{onClick:C,className:`inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 \r
                         rounded-md text-sm font-medium text-white hover:bg-purple-700 \r
                         focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer`,children:[e.jsx(Q,{className:"mr-2"}),"Tanulás"]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-foreground",children:g.name}),m?e.jsx(Y,{questions:n,currentIdx:d,onNext:_,onExit:()=>u(!1)}):e.jsxs("div",{className:"space-y-6",children:[L.map(s=>{var j;return e.jsxs("div",{className:`bg-secondary rounded-lg p-6 shadow-xl border border-transparent\r
                           hover:border-border transition-colors`,children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-foreground",children:s.content}),(j=s.subsections)==null?void 0:j.map(c=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("h3",{className:"font-medium text-foreground mb-2",children:c.title}),e.jsx("p",{className:"text-secondary-foreground",children:c.description})]},c.id))]},s.id)}),(o==null?void 0:o.content)&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 border border-transparent hover:border-border transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:"Összegzés"}),e.jsx("p",{className:"text-foreground whitespace-pre-line",children:o.content})]})]}),e.jsx(W,{isOpen:E,onClose:()=>h(!1),onDelete:()=>p.mutate(),isDeleting:p.isPending,itemName:g.name}),a&&e.jsxs(e.Fragment,{children:[e.jsx(y,{to:"/tetelek/$id/edit",params:{id:r.toString()},className:`fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full \r
                 hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50`,title:"Szerkeszd a tételt",children:e.jsx(V,{size:20})}),e.jsx("button",{onClick:()=>{if(!a){l.error("Ehhez be kell jelentkezned!");return}h(!0)},className:`fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full \r
                 hover:bg-rose-700 transition-all transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50`,title:"Töröld a tételt",children:e.jsx(B,{size:20})})]})]})]})})}const ie=Z;export{ie as component};
