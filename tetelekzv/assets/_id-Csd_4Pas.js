import{j as e,z as q,o as P,b as Q,a as A,f as I,e as R,r as d,g,S as K,O as H,i as V,s as B,v as U,w as W}from"./index-CcgwBqJ8.js";import{L as M}from"./link-gbpF_jv7.js";import{u as $}from"./useLocation-Dj2dQDl2.js";import{u as G}from"./useQuery-CPPNeXKm.js";import{u as J}from"./useMutation-NyWmaYyF.js";import{N as S}from"./Navbar-Dl1heMU1.js";import{g as X,h as Y}from"./repo-BcJvpRJZ.js";import Z from"./DeleteModal-ai4nwVWX.js";import{P as _}from"./PageTransition-DQrU03lL.js";import ee from"./FlashCard-Cjfov8xy.js";import{M as m}from"./MarkdownHandler-Dojq23Qn.js";import"./utils-km2FGkQ4.js";import"./index-C1ZKtdgo.js";const te=({questions:r,currentIdx:i,onNext:u,onExit:s})=>{var a,l;const x=r.length>0,h=r.length>1;return e.jsx(q,{show:!0,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",as:"div",children:e.jsx("div",{className:"flex flex-col items-center gap-6 mt-10",children:x&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{question:((a=r[i])==null?void 0:a.question)??"",answer:((l=r[i])==null?void 0:l.answer)??""}),e.jsxs("div",{className:"flex gap-4",children:[h&&e.jsxs("button",{onClick:u,className:`px-6 py-3 bg-orange-400 text-white rounded-lg hover:cursor-pointer\r
                             hover:bg-orange-600 transition-colors flex items-center`,children:[e.jsx(P,{className:"mr-2 animate-spin"}),"Következő kérdés"]}),e.jsx("button",{onClick:s,className:`px-6 py-3 border border-border text-muted-foreground hover:text-foreground hover:cursor-pointer\r
                             rounded-lg hover:bg-secondary transition-colors`,children:"Vissza"})]})]})})})};function re(){const{isAuthenticated:r,isSuperUser:i}=Q(),{id:u}=A({strict:!1}),s=Number(u),x=$(),h=I(),a=R(),l=x.pathname.includes("/edit"),[b,j]=d.useState(!1),[p,v]=d.useState(0),[C,N]=d.useState(!1),{data:t,isLoading:T,error:y}=G({queryKey:["tetelDetail",s],queryFn:()=>Y(s),enabled:!isNaN(s)&&s>0,retry:2,refetchOnWindowFocus:!1}),w=J({mutationFn:()=>{if(!r||!i)throw g.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return X(s)},onSuccess:()=>{a.invalidateQueries({queryKey:["tetelek"]}),g.success("Sikeresen törölted a tételt."),h({to:"/tetelek"})}});if(T)return e.jsxs(e.Fragment,{children:[e.jsx(S,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(K,{})})]});if(y)return e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",y.message]});if(l)return e.jsx(H,{});const z=(t==null?void 0:t.tetel)??{name:"Ismeretlen tétel"},c=t==null?void 0:t.osszegzes,D=(t==null?void 0:t.sections)??[],o=(t==null?void 0:t.questions)??[],k=o.length>0,L=o.length>1,O=()=>{if(!L)return;let n=p;for(;n===p;)n=Math.floor(Math.random()*o.length);v(n)},E=()=>{k&&(v(Math.floor(Math.random()*o.length)),j(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(S,{}),e.jsx(d.Suspense,{children:e.jsxs("main",{className:"relative md:max-w-7xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 py-10 text-left",children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(M,{to:"/tetelek",className:"inline-flex items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors",children:[e.jsx(V,{className:"mr-2"}),"Vissza a tételekhez"]}),!b&&k&&e.jsxs("button",{onClick:E,className:"inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 rounded-md text-sm font-medium text-white hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer",children:[e.jsx(B,{className:"mr-2"}),"Tanulás"]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-foreground",children:z.name}),b?e.jsx(te,{questions:o,currentIdx:p,onNext:O,onExit:()=>j(!1)}):e.jsxs("div",{className:"space-y-6",children:[D.map(n=>{var F;return e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow-xl border border-transparent hover:border-border transition-colors",children:[e.jsx("div",{className:"text-xl font-semibold mb-4 text-foreground",children:e.jsx(m,{content:n.content})}),(F=n.subsections)==null?void 0:F.map(f=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"font-medium text-foreground mb-2",children:e.jsx(m,{content:f.title})}),e.jsx("div",{className:"text-secondary-foreground prose prose-invert max-w-none",children:e.jsx(m,{content:f.description})})]},f.id))]},n.id)}),(c==null?void 0:c.content)&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 border border-transparent hover:border-border transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:"Összegzés"}),e.jsx("div",{className:"text-foreground prose prose-invert max-w-none whitespace-pre-wrap",children:e.jsx(m,{content:c.content})})]})]}),e.jsx(Z,{isOpen:C,onClose:()=>N(!1),onDelete:()=>w.mutate(),isDeleting:w.isPending,itemName:z.name})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx(M,{to:"/tetelek/$id/edit",params:{id:s.toString()},className:"fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Szerkeszd a tételt",children:e.jsx(U,{size:20})}),e.jsx("button",{onClick:()=>{if(!r){g.error("Ehhez be kell jelentkezned!");return}N(!0)},className:"fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full hover:bg-rose-700 transition-all transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50",title:"Töröld a tételt",children:e.jsx(W,{size:20})})]})]})})]})}const fe=re;export{fe as component};
