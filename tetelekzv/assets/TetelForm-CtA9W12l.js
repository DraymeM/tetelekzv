import{j as e,x as C,a as w,r as x}from"./index-iAGKMsNr.js";import{z as a,F as G,S as H}from"./SubmitButton-CKfdo90M.js";const J=a.object({id:a.number().optional(),title:a.string(),description:a.string()}),M=a.object({id:a.number().optional(),content:a.string(),subsections:a.array(J).nullable().transform(r=>r||[])}),Q=a.object({id:a.number().optional(),question:a.string().min(1,"Üresen ne hagyd, zerd be ha nem akarsz."),answer:a.string().min(1,"Üresen ne hagyd, zerd be ha nem akarsz.")}),E=a.object({name:a.string().min(1,"Tétel cím megadása kötelező!"),osszegzes:a.string().min(1,"Összegzés megadása kötelező!"),sections:a.array(M).min(1,"Legalább egy szekció legyen!"),flashcards:a.array(Q).nullable().transform(r=>r||[])}),S=({label:r,value:l,onChange:c,error:o})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:r}),e.jsx("input",{className:`w-full p-2 rounded bg-gray-800 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${o?"border border-red-500":"border border-gray-700"}`,value:l,onChange:c}),o&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:o})]}),F=({label:r,value:l,onChange:c,error:o})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:r}),e.jsx("textarea",{rows:4,className:`w-full p-2 rounded bg-gray-800 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${o?"border border-red-500":"border border-gray-700"}`,value:l,onChange:c}),o&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:o})]}),W=({subsection:r,onUpdate:l,onRemove:c,errors:o={}})=>e.jsxs("div",{className:"space-y-2 relative group",children:[e.jsx("button",{type:"button",onClick:c,className:"absolute -top-3 -right-3 text-red-500 bg-gray-900 rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx(C,{className:"w-5 h-5"})}),e.jsx(S,{label:"Cím",value:r.title,onChange:d=>l("title",d.target.value),error:o.title}),e.jsx(F,{label:"Leírás",value:r.description,onChange:d=>l("description",d.target.value),error:o.description})]}),X=({onUpdateContent:r,onAddSubsection:l,onRemoveSection:c,onUpdateSubsection:o,onRemoveSubsection:d,section:f,errors:v={}})=>e.jsxs("div",{className:"p-4 border rounded-lg border-gray-700 relative group",children:[e.jsx("button",{type:"button",onClick:c,className:"absolute -top-3 -right-3 text-red-500 bg-gray-900 rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx(C,{className:"w-5 h-5"})}),e.jsx(F,{label:"Szekció tartalma",value:f.content,onChange:u=>r(u.target.value),error:v.content}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("h4",{className:"text-md font-medium text-gray-400",children:"Alszekciók"}),f.subsections.map((u,b)=>e.jsx(W,{subsection:u,onRemove:()=>d(b),onUpdate:(g,N)=>o(b,g,N),errors:{title:v[`subsections.${b}.title`],description:v[`subsections.${b}.description`]}},b)),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{type:"button",onClick:l,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 hover:cursor-pointer text-white hover:bg-emerald-700",children:e.jsx(w,{size:15})}),e.jsx("span",{children:"Új Alszekció"})]})]})]}),Y=({flashcard:r,onUpdate:l,onRemove:c,errors:o={}})=>e.jsxs("div",{className:"space-y-2 relative group",children:[e.jsx("button",{type:"button",onClick:c,className:"absolute -top-3 -right-3 text-red-500 bg-gray-900 rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx(C,{className:"w-5 h-5"})}),e.jsx("hr",{className:"border-t-2 border-gray-300 w-full my-2"}),e.jsx(S,{label:"Kérdés",value:r.question,onChange:d=>l("question",d.target.value),error:o.question}),e.jsx(S,{label:"Válasz",value:r.answer,onChange:d=>l("answer",d.target.value),error:o.answer})]}),ee=({initialData:r,onSubmit:l,isPending:c,error:o,success:d,label:f,submitLabel:v})=>{const[u,b]=x.useState((r==null?void 0:r.name)||""),[g,N]=x.useState((r==null?void 0:r.osszegzes)||""),[i,p]=x.useState((r==null?void 0:r.sections)||[{content:"",subsections:[]}]),[h,k]=x.useState((r==null?void 0:r.flashcards)||[]),[y,R]=x.useState({}),[z,A]=x.useState({});x.useEffect(()=>{const s=E.safeParse({name:u,osszegzes:g,sections:i,flashcards:h});if(s.success)R({});else{const t={};s.error.errors.forEach(n=>{t[n.path.join(".")]=n.message}),R(t)}},[u,g,i,h]);const q=s=>{s.preventDefault();const t=E.safeParse({name:u,osszegzes:g,sections:i,flashcards:h});t.success&&l(t.data)},U=()=>{p([...i,{id:Date.now()*-1,content:"",subsections:[]}])},B=s=>{p(i.filter(t=>t.id!==s))},$=(s,t)=>{p(i.map(n=>n.id===s?{...n,content:t}:n))},P=s=>{p(i.map(t=>t.id===s?{...t,subsections:[...t.subsections,{id:Date.now()*-1,title:"",description:""}]}:t))},L=(s,t,n,m)=>{p(i.map(j=>j.id===s?{...j,subsections:j.subsections.map((T,_)=>_===t?{...T,[n]:m}:T)}:j))},I=(s,t)=>{p(i.map(n=>n.id===s?{...n,subsections:n.subsections.filter((m,j)=>j!==t)}:n))},K=()=>{k([...h,{id:Date.now()*-1,question:"",answer:""}])},O=(s,t,n)=>{k(h.map(m=>m.id===s?{...m,[t]:n}:m))},V=s=>{k(h.filter(t=>t.id!==s))};return e.jsx(G,{error:o,success:d,label:f,children:e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsx(S,{label:"Tétel címe",value:u,onChange:s=>{b(s.target.value),A({...z,name:!0})},error:z.name?y.name:void 0}),e.jsx(F,{label:"Összegzés",value:g,onChange:s=>{N(s.target.value),A({...z,osszegzes:!0})},error:z.osszegzes?y.osszegzes:void 0}),i.map(s=>e.jsx(X,{index:s.id,section:s,onUpdateContent:t=>$(s.id,t),onAddSubsection:()=>P(s.id),onRemoveSection:()=>B(s.id),onUpdateSubsection:(t,n,m)=>L(s.id,t,n,m),onRemoveSubsection:t=>I(s.id,t),errors:y},s.id)),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{type:"button",onClick:U,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 hover:cursor-pointer text-white hover:bg-emerald-700",children:e.jsx(w,{size:15})}),e.jsx("span",{children:"Új Szekció"})]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h4",{className:"text-md font-medium text-gray-400",children:"FlashCard"})}),h.map(s=>e.jsx(Y,{flashcard:s,onUpdate:(t,n)=>O(s.id,t,n),onRemove:()=>V(s.id),errors:y},s.id)),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{type:"button",onClick:K,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 hover:cursor-pointer text-white hover:bg-emerald-700",children:e.jsx(w,{size:15})}),e.jsx("span",{children:"Új flashcard"})]}),e.jsx(H,{isPending:c,label:v})]})})};export{ee as T};
