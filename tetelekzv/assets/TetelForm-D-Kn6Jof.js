const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SubsectionBlock-D-1VhvfM.js","assets/index-DaQSTSUC.js","assets/index-DBzWI3Al.css","assets/index-mSkvzYyn.js","assets/InputField-DIwveRtj.js","assets/FormContainer-D-XfWLqB.js","assets/SubmitButton-BxYZtFUc.js"])))=>i.map(i=>d[i]);
import{j as e,r as d,av as $,R as y,F,_ as N,N as Q,S as X,y as C}from"./index-DaQSTSUC.js";import{z as a}from"./index-mSkvzYyn.js";import O from"./InputField-DIwveRtj.js";const R=a.preprocess(r=>r!==void 0?Number(r):void 0,a.number()).optional(),Y=a.object({id:R,title:a.string().min(1,"A cím nem lehet üres!"),description:a.string()}),Z=a.object({id:R,content:a.string().min(1,"A szekció tartalma nem lehet üres!"),subsections:a.array(Y).nullable().transform(r=>r||[])}),D=a.object({id:R,question:a.string().min(1,"Üresen ne hagyd, zárd be ha nem akarsz."),answer:a.string().min(1,"Üresen ne hagyd, zárd be ha nem akarsz.")}),P=a.object({name:a.string().min(1,"Tétel cím megadása kötelező!"),osszegzes:a.string().min(1,"Összegzés megadása kötelező!"),sections:a.array(Z).min(1,"Legalább egy szekció legyen!"),flashcards:a.array(D).nullable().transform(r=>r||[])}),U=({label:r,value:m,onChange:b,error:l})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r}),e.jsx("textarea",{rows:4,className:`w-full p-2 rounded bg-secondary text-foreground focus:outline-none focus:ring-2 focus:ring-primary ${l?"border border-red-500":"border border-border"}`,value:m,onChange:b}),l&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l})]}),ee=y.lazy(()=>N(()=>import("./SubsectionBlock-D-1VhvfM.js"),__vite__mapDeps([0,1,2,3,4]))),se=({onUpdateContent:r,onAddSubsection:m,onRemoveSection:b,onUpdateSubsection:l,onRemoveSubsection:i,section:f,errors:j={}})=>e.jsx(d.Suspense,{children:e.jsxs("div",{className:"p-4 border rounded-lg border-border relative group",children:[e.jsx("button",{type:"button",onClick:b,className:"absolute -top-3 -right-3 text-red-500 bg-background rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx($,{className:"w-5 h-5"})}),e.jsx(U,{label:"Szekció tartalma",value:f.content,onChange:u=>r(u.target.value),error:j.content}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("h4",{className:"text-md font-medium text-foreground",children:"Alszekciók"}),f.subsections.map((u,p)=>e.jsx(ee,{subsection:u,onRemove:()=>i(p),onUpdate:(x,k)=>l(p,x,k),errors:{title:j[`subsections.${p}.title`],description:j[`subsections.${p}.description`]}},p)),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{type:"button",onClick:m,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 hover:cursor-pointer text-white hover:bg-emerald-700",children:e.jsx(F,{size:15})}),e.jsx("span",{children:"Új Alszekció"})]})]})]})}),te=({flashcard:r,onUpdate:m,onRemove:b,errors:l={}})=>e.jsxs("div",{className:"space-y-2 relative group",children:[e.jsx("button",{type:"button",onClick:b,className:"absolute -top-3 -right-3 text-red-500 bg-secondary rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx($,{className:"w-5 h-5"})}),e.jsx("hr",{className:"border-t-2 border-border w-full my-2"}),e.jsx(O,{label:"Kérdés",value:r.question,onChange:i=>m("question",i.target.value),error:l.question}),e.jsx(O,{label:"Válasz",value:r.answer,onChange:i=>m("answer",i.target.value),error:l.answer})]}),re=y.lazy(()=>N(()=>import("./FormContainer-D-XfWLqB.js"),__vite__mapDeps([5,1,2]))),oe=y.lazy(()=>N(()=>import("./SubmitButton-BxYZtFUc.js"),__vite__mapDeps([6,1,2]))),ne=y.lazy(()=>N(()=>import("./InputField-DIwveRtj.js"),__vite__mapDeps([4,1,2]))),ae=({initialData:r,onSubmit:m,isPending:b,error:l,success:i,label:f,submitLabel:j})=>{const[u,p]=d.useState((r==null?void 0:r.name)||""),[x,k]=d.useState((r==null?void 0:r.osszegzes)||""),[v,g]=d.useState((r==null?void 0:r.sections)||[{content:"",subsections:[]}]),[z,w]=d.useState((r==null?void 0:r.flashcards)||[]),[S,T]=d.useState({}),[_,E]=d.useState({});d.useEffect(()=>{const s=P.safeParse({name:u,osszegzes:x,sections:v,flashcards:z});if(s.success)T({});else{const t={};s.error.errors.forEach(n=>{t[n.path.join(".")]=n.message}),T(t)}},[u,x,v,z]);const q=s=>{s.preventDefault(),E({name:!0,osszegzes:!0,sections:!0,flashcards:!0});const t=P.safeParse({name:u,osszegzes:x,sections:v,flashcards:z});if(!t.success){C.error("Javítsd ki a hibákat mielőtt mentenél!");return}m(t.data),C.success("Sikeres mentés!")},L=()=>{g(s=>[...s,{id:Date.now()*-1,content:"",subsections:[]}])},V=s=>{g(t=>t.filter(n=>n.id!==s))},B=(s,t)=>{g(n=>n.map(o=>o.id===s?{...o,content:t}:o))},I=s=>{g(t=>t.map(n=>n.id===s?{...n,subsections:[...n.subsections,{id:Date.now()*-1,title:"",description:""}]}:n))},W=(s,t,n,o)=>{g(c=>c.map(h=>h.id===s?{...h,subsections:h.subsections.map((A,H)=>H===t?{...A,[n]:o}:A)}:h))},J=(s,t)=>{g(n=>n.map(o=>o.id===s?{...o,subsections:o.subsections.filter((c,h)=>h!==t)}:o))},K=()=>{w(s=>[...s,{id:Date.now()*-1,question:"",answer:""}])},M=(s,t,n)=>{w(o=>o.map(c=>c.id===s?{...c,[t]:n}:c))},G=s=>{w(t=>t.filter(n=>n.id!==s))};return d.useEffect(()=>{(l||i)&&window.scrollTo({top:0,behavior:"smooth"})},[l,i]),e.jsxs("div",{children:[e.jsx(Q,{}),e.jsx(d.Suspense,{fallback:e.jsx(X,{}),children:e.jsx("div",{className:"max-w-6xl mx-auto items-center",children:e.jsx(re,{error:l,success:i,label:f,children:e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsx(ne,{label:"Tétel címe",value:u,onChange:s=>{p(s.target.value),E(t=>({...t,name:!0}))},error:_.name?S.name:void 0}),e.jsx(U,{label:"Összegzés",value:x,onChange:s=>{k(s.target.value),E(t=>({...t,osszegzes:!0}))},error:_.osszegzes?S.osszegzes:void 0}),v.map((s,t)=>{const n={};return Object.entries(S).forEach(([o,c])=>{o.startsWith(`sections.${t}.`)&&(n[o.replace(`sections.${t}.`,"")]=c)}),e.jsx(se,{index:s.id,section:s,onUpdateContent:o=>B(s.id,o),onAddSubsection:()=>I(s.id),onRemoveSection:()=>V(s.id),onUpdateSubsection:(o,c,h)=>W(s.id,o,c,h),onRemoveSubsection:o=>J(s.id,o),errors:_.sections?n:{}},s.id)}),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{type:"button",onClick:L,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 text-white hover:bg-emerald-700",children:e.jsx(F,{size:15})}),e.jsx("span",{children:"Új Szekció"})]}),z.map((s,t)=>{const n={};return Object.entries(S).forEach(([o,c])=>{o.startsWith(`flashcards.${t}.`)&&(n[o.replace(`flashcards.${t}.`,"")]=c)}),e.jsx(te,{flashcard:s,onUpdate:(o,c)=>M(s.id,o,c),onRemove:()=>G(s.id),errors:_.flashcards?n:{}},s.id)}),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{type:"button",onClick:K,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 text-white hover:bg-emerald-700",children:e.jsx(F,{size:15})}),e.jsx("span",{children:"Új flashcard"})]}),e.jsx(oe,{isPending:b,label:j})]})})})})]})},ie=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"}));export{U as T,ie as a};
