const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Sidebar-CD1zgjHn.js","assets/index-g49gwtKb.js","assets/index-BtqPbK31.css","assets/index-By-t_oDV.js","assets/repo-CkPRPLz8.js","assets/FormContainer-H5ACdS-l.js","assets/InputField-5QRzBhDm.js","assets/SubmitButton-DLIB2srM.js","assets/types-CZYGTQuY.js","assets/PageTransition-DaHx-Bu2.js","assets/OfflinePlaceholder-BBcEqjP7.js","assets/useOnlineStatus-Bi7tibFO.js","assets/use-resolve-button-type-TMZyqexY.js","assets/UserInfo-BtAbdSWd.js"])))=>i.map(i=>d[i]);
import{r as a,aK as Pe,R as F,aL as ne,aM as he,a5 as G,a8 as U,M as V,X as R,aN as q,T as ve,al as I,aO as D,an as S,a2 as N,aP as we,ah as le,a6 as J,aQ as B,a3 as L,ak as se,j as i,b as Te,f as Ie,aR as Se,_ as oe,y as ae}from"./index-g49gwtKb.js";import{u as ye}from"./repo-CkPRPLz8.js";import je from"./FormContainer-H5ACdS-l.js";import W from"./InputField-5QRzBhDm.js";import Ee from"./SubmitButton-DLIB2srM.js";import{o as $e,s as Q}from"./types-CZYGTQuY.js";import{P as ke}from"./PageTransition-DaHx-Bu2.js";import{O as Ae}from"./OfflinePlaceholder-BBcEqjP7.js";import{u as Ce}from"./useOnlineStatus-Bi7tibFO.js";import{$ as ue,a as Fe,w as ze,e as Oe}from"./use-resolve-button-type-TMZyqexY.js";function Me({onFocus:e}){let[t,r]=a.useState(!0),s=Pe();return t?F.createElement(ne,{as:"button",type:"button",features:he.Focusable,onFocus:o=>{o.preventDefault();let l,n=50;function c(){if(n--<=0){l&&cancelAnimationFrame(l);return}if(e()){if(cancelAnimationFrame(l),!s.current)return;r(!1);return}l=requestAnimationFrame(c)}l=requestAnimationFrame(c)}}):null}const ie=a.createContext(null);function Re(){return{groups:new Map,get(e,t){var r;let s=this.groups.get(e);s||(s=new Map,this.groups.set(e,s));let o=(r=s.get(t))!=null?r:0;s.set(t,o+1);let l=Array.from(s.keys()).indexOf(t);function n(){let c=s.get(t);c>1?s.set(t,c-1):s.delete(t)}return[l,n]}}}function De({children:e}){let t=a.useRef(Re());return a.createElement(ie.Provider,{value:t},e)}function ce(e){let t=a.useContext(ie);if(!t)throw new Error("You must wrap your component in a <StableCollection>");let r=a.useId(),[s,o]=t.current.get(e,r);return a.useEffect(()=>o,[]),s}var _e=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(_e||{}),Le=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(Le||{}),Ne=(e=>(e[e.SetSelectedIndex=0]="SetSelectedIndex",e[e.RegisterTab=1]="RegisterTab",e[e.UnregisterTab=2]="UnregisterTab",e[e.RegisterPanel=3]="RegisterPanel",e[e.UnregisterPanel=4]="UnregisterPanel",e))(Ne||{});let Ge={0(e,t){var r;let s=L(e.tabs,u=>u.current),o=L(e.panels,u=>u.current),l=s.filter(u=>{var x;return!((x=u.current)!=null&&x.hasAttribute("disabled"))}),n={...e,tabs:s,panels:o};if(t.index<0||t.index>s.length-1){let u=N(Math.sign(t.index-e.selectedIndex),{[-1]:()=>1,0:()=>N(Math.sign(t.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(l.length===0)return n;let x=N(u,{0:()=>s.indexOf(l[0]),1:()=>s.indexOf(l[l.length-1])});return{...n,selectedIndex:x===-1?e.selectedIndex:x}}let c=s.slice(0,t.index),P=[...s.slice(t.index),...c].find(u=>l.includes(u));if(!P)return n;let p=(r=s.indexOf(P))!=null?r:e.selectedIndex;return p===-1&&(p=e.selectedIndex),{...n,selectedIndex:p}},1(e,t){if(e.tabs.includes(t.tab))return e;let r=e.tabs[e.selectedIndex],s=L([...e.tabs,t.tab],l=>l.current),o=e.selectedIndex;return e.info.current.isControlled||(o=s.indexOf(r),o===-1&&(o=e.selectedIndex)),{...e,tabs:s,selectedIndex:o}},2(e,t){return{...e,tabs:e.tabs.filter(r=>r!==t.tab)}},3(e,t){return e.panels.includes(t.panel)?e:{...e,panels:L([...e.panels,t.panel],r=>r.current)}},4(e,t){return{...e,panels:e.panels.filter(r=>r!==t.panel)}}},X=a.createContext(null);X.displayName="TabsDataContext";function _(e){let t=a.useContext(X);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,_),r}return t}let Y=a.createContext(null);Y.displayName="TabsActionsContext";function Z(e){let t=a.useContext(Y);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Z),r}return t}function Ue(e,t){return N(t.type,Ge,e,t)}let Je="div";function Ke(e,t){let{defaultIndex:r=0,vertical:s=!1,manual:o=!1,onChange:l,selectedIndex:n=null,...c}=e;const P=s?"vertical":"horizontal",p=o?"manual":"auto";let u=n!==null,x=B({isControlled:u}),y=U(t),[b,d]=a.useReducer(Ue,{info:x,selectedIndex:n??r,tabs:[],panels:[]}),z=a.useMemo(()=>({selectedIndex:b.selectedIndex}),[b.selectedIndex]),j=B(l||(()=>{})),w=B(b.tabs),m=a.useMemo(()=>({orientation:P,activation:p,...b}),[P,p,b]),$=R(g=>(d({type:1,tab:g}),()=>d({type:2,tab:g}))),O=R(g=>(d({type:3,panel:g}),()=>d({type:4,panel:g}))),h=R(g=>{v.current!==g&&j.current(g),u||d({type:0,index:g})}),v=B(u?e.selectedIndex:b.selectedIndex),T=a.useMemo(()=>({registerTab:$,registerPanel:O,change:h}),[]);V(()=>{d({type:0,index:n??r})},[n]),V(()=>{if(v.current===void 0||b.tabs.length<=0)return;let g=L(b.tabs,C=>C.current);g.some((C,M)=>b.tabs[M]!==C)&&h(g.indexOf(b.tabs[v.current]))});let k={ref:y},A=J();return F.createElement(De,null,F.createElement(Y.Provider,{value:T},F.createElement(X.Provider,{value:m},m.tabs.length<=0&&F.createElement(Me,{onFocus:()=>{var g,C;for(let M of w.current)if(((g=M.current)==null?void 0:g.tabIndex)===0)return(C=M.current)==null||C.focus(),!0;return!1}}),A({ourProps:k,theirProps:c,slot:z,defaultTag:Je,name:"Tabs"}))))}let qe="div";function Be(e,t){let{orientation:r,selectedIndex:s}=_("Tab.List"),o=U(t),l=a.useMemo(()=>({selectedIndex:s}),[s]),n=e,c={ref:o,role:"tablist","aria-orientation":r};return J()({ourProps:c,theirProps:n,slot:l,defaultTag:qe,name:"Tabs.List"})}let He="button";function Ve(e,t){var r,s;let o=a.useId(),{id:l=`headlessui-tabs-tab-${o}`,disabled:n=!1,autoFocus:c=!1,...P}=e,{orientation:p,activation:u,selectedIndex:x,tabs:y,panels:b}=_("Tab"),d=Z("Tab"),z=_("Tab"),[j,w]=a.useState(null),m=a.useRef(null),$=U(m,t,w);V(()=>d.registerTab(m),[d,m]);let O=ce("tabs"),h=y.indexOf(m);h===-1&&(h=O);let v=h===x,T=R(f=>{var E;let K=f();if(K===q.Success&&u==="auto"){let ge=(E=ve(m))==null?void 0:E.activeElement,re=z.tabs.findIndex(xe=>xe.current===ge);re!==-1&&d.change(re)}return K}),k=R(f=>{let E=y.map(K=>K.current).filter(Boolean);if(f.key===I.Space||f.key===I.Enter){f.preventDefault(),f.stopPropagation(),d.change(h);return}switch(f.key){case I.Home:case I.PageUp:return f.preventDefault(),f.stopPropagation(),T(()=>D(E,S.First));case I.End:case I.PageDown:return f.preventDefault(),f.stopPropagation(),T(()=>D(E,S.Last))}if(T(()=>N(p,{vertical(){return f.key===I.ArrowUp?D(E,S.Previous|S.WrapAround):f.key===I.ArrowDown?D(E,S.Next|S.WrapAround):q.Error},horizontal(){return f.key===I.ArrowLeft?D(E,S.Previous|S.WrapAround):f.key===I.ArrowRight?D(E,S.Next|S.WrapAround):q.Error}}))===q.Success)return f.preventDefault()}),A=a.useRef(!1),g=R(()=>{var f;A.current||(A.current=!0,(f=m.current)==null||f.focus({preventScroll:!0}),d.change(h),we(()=>{A.current=!1}))}),C=R(f=>{f.preventDefault()}),{isFocusVisible:M,focusProps:de}=ue({autoFocus:c}),{isHovered:ee,hoverProps:fe}=Fe({isDisabled:n}),{pressed:te,pressProps:pe}=ze({disabled:n}),me=a.useMemo(()=>({selected:v,hover:ee,active:te,focus:M,autofocus:c,disabled:n}),[v,ee,M,te,c,n]),be=le({ref:$,onKeyDown:k,onMouseDown:C,onClick:g,id:l,role:"tab",type:Oe(e,j),"aria-controls":(s=(r=b[h])==null?void 0:r.current)==null?void 0:s.id,"aria-selected":v,tabIndex:v?0:-1,disabled:n||void 0,autoFocus:c},de,fe,pe);return J()({ourProps:be,theirProps:P,slot:me,defaultTag:He,name:"Tabs.Tab"})}let We="div";function Qe(e,t){let{selectedIndex:r}=_("Tab.Panels"),s=U(t),o=a.useMemo(()=>({selectedIndex:r}),[r]),l=e,n={ref:s};return J()({ourProps:n,theirProps:l,slot:o,defaultTag:We,name:"Tabs.Panels"})}let Xe="div",Ye=se.RenderStrategy|se.Static;function Ze(e,t){var r,s,o,l;let n=a.useId(),{id:c=`headlessui-tabs-panel-${n}`,tabIndex:P=0,...p}=e,{selectedIndex:u,tabs:x,panels:y}=_("Tab.Panel"),b=Z("Tab.Panel"),d=a.useRef(null),z=U(d,t);V(()=>b.registerPanel(d),[b,d]);let j=ce("panels"),w=y.indexOf(d);w===-1&&(w=j);let m=w===u,{isFocusVisible:$,focusProps:O}=ue(),h=a.useMemo(()=>({selected:m,focus:$}),[m,$]),v=le({ref:z,id:c,role:"tabpanel","aria-labelledby":(s=(r=x[w])==null?void 0:r.current)==null?void 0:s.id,tabIndex:m?P:-1},O),T=J();return!m&&((o=p.unmount)==null||o)&&!((l=p.static)!=null&&l)?F.createElement(ne,{"aria-hidden":"true",...v}):T({ourProps:v,theirProps:p,slot:h,defaultTag:Xe,features:Ye,visible:m,name:"Tabs.Panel"})}let et=G(Ve),tt=G(Ke),rt=G(Be),st=G(Qe),at=G(Ze),H=Object.assign(et,{Group:tt,List:rt,Panels:st,Panel:at});const nt=$e({currentPassword:Q().min(1,"Kötelező mező"),newPassword:Q().min(6,"A jelszónak legalább 6 karakter hosszúnak kell lennie"),confirmPassword:Q()}).refine(e=>e.newPassword===e.confirmPassword,{message:"A jelszavak nem egyeznek",path:["confirmPassword"]}),lt=({onSubmit:e,errors:t,isSubmitting:r,successMessage:s,currentPassword:o,newPassword:l,confirmPassword:n,setCurrentPassword:c,setNewPassword:P,setConfirmPassword:p})=>i.jsx(je,{error:t.general||null,success:s,label:"Jelszó módosítása",children:i.jsxs("form",{onSubmit:e,className:"space-y-6 max-h-[90dvh]",children:[i.jsx(W,{label:"Jelenlegi jelszó",value:o,onChange:u=>c(u.target.value),error:t.currentPassword,enablePasswordToggle:!0}),i.jsx(W,{label:"Új jelszó",value:l,onChange:u=>P(u.target.value),error:t.newPassword,enablePasswordToggle:!0}),i.jsx(W,{label:"Jelszó megerősítése",value:n,onChange:u=>p(u.target.value),error:t.confirmPassword,enablePasswordToggle:!0}),i.jsx(Ee,{isPending:r,label:r?"Feldolgozás...":"Jelszó mentése"})]})}),ot=F.lazy(()=>oe(()=>import("./Sidebar-CD1zgjHn.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),ut=F.lazy(()=>oe(()=>import("./UserInfo-BtAbdSWd.js"),__vite__mapDeps([13,1,2,3]))),ht=()=>{const{logout:e,isAuthenticated:t,isSuperUser:r,username:s}=Te(),o=Ie(),[l,n]=a.useState(!1),[c,P]=a.useState(""),[p,u]=a.useState(""),[x,y]=a.useState(""),[b,d]=a.useState({}),[z,j]=a.useState(!1),[w,m]=a.useState(null),$=Ce(),O=async()=>{try{await e(),ae.success("Sikeres kijelentkezés!"),o({to:"/login"})}catch{ae.error("Hiba történt a kijelentkezés során")}},h=async v=>{v.preventDefault(),j(!0),m(null);const T=nt.safeParse({currentPassword:c,newPassword:p,confirmPassword:x});if(!T.success){const k={};T.error.issues.forEach(A=>{k[A.path[0]]=A.message}),d(k),j(!1);return}try{await ye(c,p,x),m("Jelszó sikeresen frissítve!"),P(""),u(""),y(""),d({})}catch(k){d({general:k.response?.data?.error||"Hiba történt a jelszó frissítésekor"})}finally{j(!1)}};return $?i.jsx(i.Fragment,{children:i.jsx(ke,{children:i.jsxs(a.Suspense,{children:[i.jsx("div",{className:"lg:hidden p-4 flex justify-between items-center mt-15 z-50 overflow-hidden",children:i.jsx("button",{className:"p-2 border-border rounded-md focus:outline-none",onClick:()=>n(!0),"aria-label":"Open menu",children:i.jsx(Se,{size:36})})}),i.jsx(H.Group,{children:i.jsxs("div",{className:"flex mt-4 relative",children:[i.jsx(ot,{isOpen:l,onClose:()=>n(!1)}),i.jsx("div",{className:"flex-1 p-8 ml-0 lg:mr-64 lg:ml-64",children:i.jsxs(H.Panels,{children:[i.jsx(H.Panel,{children:i.jsx(ut,{username:s||"",isSuperUser:r,isAuthenticated:t,onLogout:O})}),i.jsx(H.Panel,{children:i.jsx(lt,{onSubmit:h,errors:b,isSubmitting:z,successMessage:w,currentPassword:c,newPassword:p,confirmPassword:x,setCurrentPassword:P,setNewPassword:u,setConfirmPassword:y})})]})})]})})]})})}):i.jsx(i.Fragment,{children:i.jsx(Ae,{})})};export{ht as P,H as T};
