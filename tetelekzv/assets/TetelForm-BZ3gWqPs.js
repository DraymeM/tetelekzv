const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FormContainer-DqE8QG-v.js","assets/index-BQ-Le8Of.js","assets/index-DBzWI3Al.css","assets/SubmitButton-DdAxLQ3I.js","assets/InputField-B31Yik_G.js","assets/TextAreaField-C0J6m7H2.js","assets/SectionBlock-BycXJrmU.js","assets/FlashcardBlock-DIDWyid5.js"])))=>i.map(i=>d[i]);
import{r as d,j as n,N as H,R as m,F as R,_ as u,y as A}from"./index-BQ-Le8Of.js";import{z as a}from"./index-mSkvzYyn.js";const S=a.preprocess(r=>r!==void 0?Number(r):void 0,a.number()).optional(),K=a.object({id:S,title:a.string().min(1,"A cím nem lehet üres!"),description:a.string()}),M=a.object({id:S,content:a.string().min(1,"A szekció tartalma nem lehet üres!"),subsections:a.array(K).nullable().transform(r=>r||[])}),Q=a.object({id:S,question:a.string().min(1,"Üresen ne hagyd, zárd be ha nem akarsz."),answer:a.string().min(1,"Üresen ne hagyd, zárd be ha nem akarsz.")}),k=a.object({name:a.string().min(1,"Tétel cím megadása kötelező!"),osszegzes:a.string().min(1,"Összegzés megadása kötelező!"),sections:a.array(M).min(1,"Legalább egy szekció legyen!"),flashcards:a.array(Q).nullable().transform(r=>r||[])}),X=m.lazy(()=>u(()=>import("./FormContainer-DqE8QG-v.js"),__vite__mapDeps([0,1,2]))),Y=m.lazy(()=>u(()=>import("./SubmitButton-DdAxLQ3I.js"),__vite__mapDeps([3,1,2]))),Z=m.lazy(()=>u(()=>import("./InputField-B31Yik_G.js"),__vite__mapDeps([4,1,2]))),D=m.lazy(()=>u(()=>import("./TextAreaField-C0J6m7H2.js"),__vite__mapDeps([5,1,2]))),ee=m.lazy(()=>u(()=>import("./SectionBlock-BycXJrmU.js"),__vite__mapDeps([6,1,2,5]))),se=m.lazy(()=>u(()=>import("./FlashcardBlock-DIDWyid5.js"),__vite__mapDeps([7,1,2,4]))),re=({initialData:r,onSubmit:F,isPending:T,error:_,success:g,label:w,submitLabel:N})=>{const[h,P]=d.useState((r==null?void 0:r.name)||""),[b,O]=d.useState((r==null?void 0:r.osszegzes)||""),[p,l]=d.useState((r==null?void 0:r.sections)||[{content:"",subsections:[]}]),[f,j]=d.useState((r==null?void 0:r.flashcards)||[]),[z,E]=d.useState({}),[x,v]=d.useState({});d.useEffect(()=>{const e=k.safeParse({name:h,osszegzes:b,sections:p,flashcards:f});if(e.success)E({});else{const s={};e.error.errors.forEach(o=>{s[o.path.join(".")]=o.message}),E(s)}},[h,b,p,f]);const L=e=>{e.preventDefault(),v({name:!0,osszegzes:!0,sections:!0,flashcards:!0});const s=k.safeParse({name:h,osszegzes:b,sections:p,flashcards:f});if(!s.success){A.error("Javítsd ki a hibákat mielőtt mentenél!");return}F(s.data),A.success("Sikeres mentés!")},C=()=>{l(e=>[...e,{id:Date.now()*-1,content:"",subsections:[]}])},U=e=>{l(s=>s.filter(o=>o.id!==e))},V=(e,s)=>{l(o=>o.map(t=>t.id===e?{...t,content:s}:t))},I=e=>{l(s=>s.map(o=>o.id===e?{...o,subsections:[...o.subsections,{id:Date.now()*-1,title:"",description:""}]}:o))},$=(e,s,o,t)=>{l(c=>c.map(i=>i.id===e?{...i,subsections:i.subsections.map((y,G)=>G===s?{...y,[o]:t}:y)}:i))},B=(e,s)=>{l(o=>o.map(t=>t.id===e?{...t,subsections:t.subsections.filter((c,i)=>i!==s)}:t))},q=()=>{j(e=>[...e,{id:Date.now()*-1,question:"",answer:""}])},W=(e,s,o)=>{j(t=>t.map(c=>c.id===e?{...c,[s]:o}:c))},J=e=>{j(s=>s.filter(o=>o.id!==e))};return d.useEffect(()=>{(_||g)&&window.scrollTo({top:0,behavior:"smooth"})},[_,g]),n.jsxs("div",{children:[n.jsx(H,{}),n.jsx(d.Suspense,{children:n.jsx("div",{className:"max-w-6xl mx-auto items-center",children:n.jsx(X,{error:_,success:g,label:w,children:n.jsxs("form",{onSubmit:L,className:"space-y-6",children:[n.jsx(Z,{label:"Tétel címe",value:h,onChange:e=>{P(e.target.value),v(s=>({...s,name:!0}))},error:x.name?z.name:void 0}),n.jsx(D,{label:"Összegzés",value:b,onChange:e=>{O(e.target.value),v(s=>({...s,osszegzes:!0}))},error:x.osszegzes?z.osszegzes:void 0}),p.map((e,s)=>{const o={};return Object.entries(z).forEach(([t,c])=>{t.startsWith(`sections.${s}.`)&&(o[t.replace(`sections.${s}.`,"")]=c)}),n.jsx(ee,{index:e.id,section:e,onUpdateContent:t=>V(e.id,t),onAddSubsection:()=>I(e.id),onRemoveSection:()=>U(e.id),onUpdateSubsection:(t,c,i)=>$(e.id,t,c,i),onRemoveSubsection:t=>B(e.id,t),errors:x.sections?o:{}},e.id)}),n.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[n.jsx("button",{type:"button",onClick:C,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 text-white hover:bg-emerald-700",children:n.jsx(R,{size:15})}),n.jsx("span",{children:"Új Szekció"})]}),f.map((e,s)=>{const o={};return Object.entries(z).forEach(([t,c])=>{t.startsWith(`flashcards.${s}.`)&&(o[t.replace(`flashcards.${s}.`,"")]=c)}),n.jsx(se,{flashcard:e,onUpdate:(t,c)=>W(e.id,t,c),onRemove:()=>J(e.id),errors:x.flashcards?o:{}},e.id)}),n.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[n.jsx("button",{type:"button",onClick:q,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 text-white hover:bg-emerald-700",children:n.jsx(R,{size:15})}),n.jsx("span",{children:"Új flashcard"})]}),n.jsx(Y,{isPending:T,label:N})]})})})})]})};export{re as default};
