import{a as E,d as F,r as a,j as s,y as v}from"./index-W4Q2XZbk.js";import{z as c,F as I,S as P}from"./SubmitButton-D_f0CaMS.js";import{I as j}from"./InputField-DGcq_7up.js";import{l as B}from"./repo-DCCUqUpe.js";const C=()=>{const{login:x}=E(),z=F(),[l,S]=a.useState(""),[i,m]=a.useState(""),[b,u]=a.useState(!1),[d,p]=a.useState({}),[n,o]=a.useState({}),w=c.object({username:c.string().min(1,"Kötelező mező"),password:c.string().min(1,"Kötelező mező")}),y=async r=>{var h,f;r.preventDefault(),u(!0),o({username:!0,password:!0});const g=w.safeParse({username:l,password:i});if(!g.success){const e={};g.error.issues.forEach(t=>{e[t.path[0]]=t.message}),p(e),u(!1);return}try{const e=await B(l,i);x(e.userId.toString(),e.superuser),v.success("Sikeres bejelentkezés!"),z({to:"/"})}catch(e){const t=((f=(h=e.response)==null?void 0:h.data)==null?void 0:f.error)||"Bejelentkezési hiba",k=t==="Invalid credentials"?"Hibás felhasználónév vagy jelszó":t;v.error(k)}finally{u(!1),m(""),p({}),o({})}};return s.jsx("div",{children:s.jsx("div",{className:"max-w-2xl mx-auto items-center h-screen justify-center overflow-hidden",children:s.jsx(I,{error:null,success:null,label:"Bejelentkezés",children:s.jsxs("form",{onSubmit:y,className:"space-y-4",children:[s.jsx(j,{label:"Felhasználónév",value:l,onChange:r=>{S(r.target.value),o({...n,username:!0})},error:n.username?d.username:void 0}),s.jsx(j,{label:"Jelszó",value:i,onChange:r=>{m(r.target.value),o({...n,password:!0})},enablePasswordToggle:!0,error:n.password?d.password:void 0}),s.jsx(P,{isPending:b,label:"Bejelentkezés"})]})})})})},T=C;export{T as component};
