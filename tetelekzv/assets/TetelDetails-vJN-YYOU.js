const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DeleteModal-11AAEr5Z.js","assets/index-KVBsG1ou.js","assets/index-DCi6IH1O.css","assets/SpeechController-B06Geiub.js","assets/OfflinePlaceholder-BS0FVtr2.js","assets/index-BjEfbLHr.js","assets/menu-DSpSgCyB.js","assets/use-resolve-button-type-DnbLG9Do.js","assets/bugs-B7WK9xZh.js","assets/label-CizLqlf9.js","assets/MarkdownHandler-GE_j7J6L.js"])))=>i.map(i=>d[i]);
import{b as M,u as E,f as D,e as O,r as c,y as N,j as e,O as P,a as h,g as F,aG as R,R as g,aI as A,aJ as y,_ as b}from"./index-KVBsG1ou.js";import{u as C}from"./useLocation-D1n-GyGL.js";import{u as I}from"./useQuery-Dc0WeW7-.js";import{u as L}from"./useMutation-9eyMPvLK.js";import{i as V,d as q}from"./repo-DMQTQuIf.js";import{P as Q}from"./PageTransition-CvYOJTXM.js";import{O as $}from"./OfflinePlaceholder-BS0FVtr2.js";const H=g.lazy(()=>b(()=>import("./DeleteModal-11AAEr5Z.js"),__vite__mapDeps([0,1,2]))),K=g.lazy(()=>b(()=>import("./SpeechController-B06Geiub.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9]))),p=g.lazy(()=>b(()=>import("./MarkdownHandler-GE_j7J6L.js").then(s=>s.M),__vite__mapDeps([10,1,2]))),a=s=>s.replace(/<[^>]+>/g,"").replace(/{[^}]+}/g,"").replace(/&[a-zA-Z0-9#]+;/g,"").replace(/[#_*>\-]/g,"").replace(/\[.*?\]\(.*?\)/g,"").replace(/!\[.*?\]\(.*?\)/g,"").replace(/`{1,3}[\s\S]*?`{1,3}/g,"").replace(/\s+/g," ").trim();function B(s,o){let n="";s.forEach(d=>{n+=" "+a(d.content),d.subsections?.forEach(m=>{n+=" "+a(m.title||""),n+=" "+a(m.description||"")})}),o?.content&&(n+=" "+a(o.content));const t=n.split(" ").filter(Boolean).length;return Math.ceil(t/200)}function ee(){const{isAuthenticated:s,isSuperUser:o}=M(),{id:n}=E({strict:!1}),t=Number(n),d=C(),m=D(),w=O(),[_,j]=c.useState(!1),{data:f,error:v}=I({queryKey:["tetelDetail",t],queryFn:()=>q(t),enabled:!isNaN(t)&&t>0,retry:2,refetchOnWindowFocus:!1});c.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"})},[d.pathname]);const z=L({mutationFn:()=>{if(!s||!o)throw N.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return V(t)},onSuccess:()=>{w.invalidateQueries({queryKey:["tetelek"]}),N.success("Sikeresen törölted a tételt."),m({to:"/tetelek"})}}),k=d.pathname.includes("/edit"),u=f?.tetel??{name:"Ismeretlen tétel"},i=f?.osszegzes,x=f?.sections??[],T=B(x,i),S=c.useMemo(()=>[a(u.name),...x.flatMap(r=>[a(r.content),...r.subsections?.flatMap(l=>[a(l.title||""),a(l.description||"")])??[]]),i?.content?"Összegzés: "+a(i.content):""].filter(r=>r&&r.length>0).join(" ").trim(),[u.name,x,i]);return v?navigator.onLine?e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",v.message]}):e.jsx($,{}):k?e.jsx(P,{}):e.jsx(c.Suspense,{children:e.jsxs("main",{className:"relative md:max-w-[75dvw] max-w-full mx-auto md:px-0 px-2 pb-1 text-left",children:[e.jsxs(Q,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsxs(h,{to:"/tetelek/$id",params:{id:t.toString()},className:"inline-flex items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors","aria-label":"Vissza a tétel áttekintéséhez",title:"Vissza a tételhez",children:[e.jsx(F,{className:"mr-2","aria-hidden":"true"}),"Vissza"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm mx-auto text-secondary-foreground",children:[e.jsx(R,{className:"inline mr-1",size:15,"aria-hidden":"true"}),T," perc"]}),e.jsx(K,{text:S})]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-foreground",children:u.name}),e.jsx("div",{className:"space-y-6",children:e.jsxs(c.Suspense,{fallback:e.jsx("div",{className:"bg-secondary rounded-lg p-6 shadow-xl animate-pulse"}),children:[x.map(r=>e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow-xl border border-transparent hover:border-border transition-colors",children:[e.jsx("div",{className:"text-xl font-semibold mb-4 text-foreground",children:e.jsx(p,{content:r.content})}),r.subsections?.map(l=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"font-medium text-foreground mb-2",children:e.jsx(p,{content:l.title})}),e.jsx("div",{className:"text-secondary-foreground prose prose-invert max-w-none",children:e.jsx(p,{content:l.description})})]},l.id))]},r.id)),i?.content&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 border border-transparent hover:border-border transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:"Összegzés"}),e.jsx("div",{className:"text-foreground prose prose-invert max-w-none whitespace-pre-wrap",children:e.jsx(p,{content:i.content})})]})]})}),e.jsx(H,{isOpen:_,onClose:()=>j(!1),onDelete:()=>z.mutate(),isDeleting:z.isPending,itemName:u.name})]}),s&&o?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>j(!0),className:"fixed md:bottom-2 bottom-14 right-2 p-3 bg-rose-600 text-white rounded-full hover:bg-rose-700 hover:cursor-pointer transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Töröld a tételt","aria-label":"Töröld a tételt",children:e.jsx(A,{size:20,"aria-hidden":"true"})}),e.jsx(h,{to:"/tetelek/$id/details/edit",params:{id:t.toString()},className:"fixed md:bottom-16 bottom-28 right-2 p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Szerkeszd a tételt","aria-label":"Szerkeszd a tételt",children:e.jsx(y,{size:20,"aria-hidden":"true"})})]}):s?e.jsx(h,{to:"/tetelek/$id/details/edit",params:{id:t.toString()},className:"fixed md:bottom-2 bottom-14 right-2 p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Szerkeszd a tételt","aria-label":"Szerkeszd a tételt",children:e.jsx(y,{size:20,"aria-hidden":"true"})}):null]})})}export{ee as T};
