import{r as n,o as k,p as R,f as m,g as O,m as le,s as H,h as oe,K as ue,H as ie,Q as ce,i as de,w as fe,k as U,l as me,n as pe,q as he,t as ge,v as L,I as xe,U as be,$ as ve,x as ye,z as Se,_ as Ce,A as we,j as l,B as je,C as ke,e as $e,d as Ne,y as Q,N as Ee,S as Fe}from"./index-B3mK96cR.js";import{u as qe}from"./useMutation-D8yuaxoC.js";import{z as j,F as Pe,S as Te}from"./SubmitButton-ChVK-gER.js";import{a as ze}from"./repo-Dongd2NK.js";function Ie(t,e,s){let[r,a]=n.useState(s),o=t!==void 0,c=n.useRef(o),d=n.useRef(!1),f=n.useRef(!1);return o&&!c.current&&!d.current?(d.current=!0,c.current=o,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!o&&c.current&&!f.current&&(f.current=!0,c.current=o,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[o?t:r,k(h=>(o||a(h),e==null?void 0:e(h)))]}function De(t){let[e]=n.useState(t);return e}function B(t={},e=null,s=[]){for(let[r,a]of Object.entries(t))G(s,V(e,r),a);return s}function V(t,e){return t?t+"["+e+"]":e}function G(t,e,s){if(Array.isArray(s))for(let[r,a]of s.entries())G(t,V(e,r.toString()),a);else s instanceof Date?t.push([e,s.toISOString()]):typeof s=="boolean"?t.push([e,s?"1":"0"]):typeof s=="string"?t.push([e,s]):typeof s=="number"?t.push([e,`${s}`]):s==null?t.push([e,""]):B(s,e,t)}function Ae(t){var e,s;let r=(e=t==null?void 0:t.form)!=null?e:t.closest("form");if(r){for(let a of r.elements)if(a!==t&&(a.tagName==="INPUT"&&a.type==="submit"||a.tagName==="BUTTON"&&a.type==="submit"||a.nodeName==="INPUT"&&a.type==="image")){a.click();return}(s=r.requestSubmit)==null||s.call(r)}}let Ke=n.createContext(null);function Le({children:t}){let e=n.useContext(Ke);if(!e)return m.createElement(m.Fragment,null,t);let{target:s}=e;return s?oe.createPortal(m.createElement(m.Fragment,null,t),s):null}function Qe({data:t,form:e,disabled:s,onReset:r,overrides:a}){let[o,c]=n.useState(null),d=R();return n.useEffect(()=>{if(r&&o)return d.addEventListener(o,"reset",r)},[o,e,r]),m.createElement(Le,null,m.createElement(Me,{setForm:c,formId:e}),B(t).map(([f,h])=>m.createElement(O,{features:H.Hidden,...le({key:f,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:e,disabled:s,name:f,value:h,...a})})))}function Me({setForm:t,formId:e}){return n.useEffect(()=>{if(e){let s=document.getElementById(e);s&&t(s)}},[t,e]),e?null:m.createElement(O,{features:H.Hidden,as:"input",type:"hidden",hidden:!0,readOnly:!0,ref:s=>{if(!s)return;let r=s.closest("form");r&&t(r)}})}let P=n.createContext(null);P.displayName="GroupContext";let Re=n.Fragment;function Oe(t){var e;let[s,r]=n.useState(null),[a,o]=de(),[c,d]=fe(),f=n.useMemo(()=>({switch:s,setSwitch:r}),[s,r]),h={},C=t,y=U();return m.createElement(d,{name:"Switch.Description",value:c},m.createElement(o,{name:"Switch.Label",value:a,props:{htmlFor:(e=f.switch)==null?void 0:e.id,onClick(b){s&&(b.currentTarget instanceof HTMLLabelElement&&b.preventDefault(),s.click(),s.focus({preventScroll:!0}))}}},m.createElement(P.Provider,{value:f},y({ourProps:h,theirProps:C,slot:{},defaultTag:Re,name:"Switch.Group"}))))}let He="button";function Ue(t,e){var s;let r=n.useId(),a=me(),o=pe(),{id:c=a||`headlessui-switch-${r}`,disabled:d=o||!1,checked:f,defaultChecked:h,onChange:C,name:y,value:b,form:$,autoFocus:w=!1,...N}=t,E=n.useContext(P),[F,i]=n.useState(null),u=n.useRef(null),p=he(u,e,E===null?null:E.setSwitch,i),x=De(h),[v,S]=Ie(f,C,x??!1),q=R(),[T,z]=n.useState(!1),I=k(()=>{z(!0),S==null||S(!v),q.nextFrame(()=>{z(!1)})}),_=k(g=>{if(ge(g.currentTarget))return g.preventDefault();g.preventDefault(),I()}),J=k(g=>{g.key===L.Space?(g.preventDefault(),I()):g.key===L.Enter&&Ae(g.currentTarget)}),W=k(g=>g.preventDefault()),X=xe(),Y=be(),{isFocusVisible:D,focusProps:Z}=ve({autoFocus:w}),{isHovered:A,hoverProps:ee}=ye({isDisabled:d}),{pressed:K,pressProps:te}=Se({disabled:d}),se=n.useMemo(()=>({checked:v,disabled:d,hover:A,focus:D,active:K,autofocus:w,changing:T}),[v,A,D,K,d,T,w]),re=Ce({id:c,ref:p,role:"switch",type:we(t,F),tabIndex:t.tabIndex===-1?0:(s=t.tabIndex)!=null?s:0,"aria-checked":v,"aria-labelledby":X,"aria-describedby":Y,disabled:d||void 0,autoFocus:w,onClick:_,onKeyUp:J,onKeyPress:W},Z,ee,te),ne=n.useCallback(()=>{if(x!==void 0)return S==null?void 0:S(x)},[S,x]),ae=U();return m.createElement(m.Fragment,null,y!=null&&m.createElement(Qe,{disabled:d,data:{[y]:b||"on"},overrides:{type:"checkbox",checked:v},form:$,onReset:ne}),ae({ourProps:re,theirProps:N,slot:se,defaultTag:He,name:"Switch"}))}let Be=ue(Ue),Ve=Oe,Ge=ce,_e=ie,Je=Object.assign(Be,{Group:Ve,Label:Ge,Description:_e});const We=({question:t,setQuestion:e,fieldErrors:s,touched:r})=>l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Kérdés"}),l.jsx("input",{type:"text",value:t,onChange:a=>e(a.target.value),className:`w-full p-3 border rounded-lg bg-secondary text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition ${r.question&&s.question?"border-red-500":"border-gray-700"} animate-in fade-in duration-300`,placeholder:"Add meg a kérdést"}),r.question&&s.question&&l.jsx("p",{className:"text-red-500 text-sm mt-1 animate-in fade-in duration-200",children:s.question})]}),Xe=({answer:t,index:e,updateAnswer:s,fieldErrors:r,touched:a})=>l.jsxs("div",{className:"flex flex-col space-y-1 mb-3",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("span",{className:"text-secondary-foreground w-8 font-medium",children:[String.fromCharCode(65+e),"."]}),l.jsx("input",{type:"text",value:t.text,onChange:o=>s(e,"text",o.target.value),className:`flex-1 p-3 border rounded-lg bg-secondary text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition ${a&&r?"border-red-500":"border-border"} animate-in fade-in duration-300`,placeholder:`Válasz ${e+1}`}),l.jsx(Je,{checked:t.isCorrect,onChange:o=>s(e,"isCorrect",o),className:`${t.isCorrect?"bg-primary":"bg-muted"} relative inline-flex h-6 w-11 items-center hover:cursor-pointer rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-primary animate-in fade-in duration-300`,children:l.jsx("span",{className:`${t.isCorrect?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform bg-white rounded-full transition-transform`})}),l.jsx("span",{className:"text-muted-foreground text-lg",children:t.isCorrect?l.jsx(je,{className:"text-green-500"}):l.jsx(ke,{className:"text-red-500"})})]}),a&&r&&l.jsx("p",{className:"text-red-500 text-sm ml-11 animate-in fade-in duration-200",children:r})]}),Ye=j.object({text:j.string().min(1,"A válasz szövege nem lehet üres"),isCorrect:j.boolean()}),M=j.object({question:j.string().min(1,"A kérdés megadása kötelező"),answers:j.array(Ye).length(4,"Pontosan négy válasz szükséges").refine(t=>t.some(e=>e.isCorrect),{message:"Legalább egy válasznak helyesnek kell lennie"})}),rt=()=>{const t=$e(),[e,s]=n.useState(""),[r,a]=n.useState([{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1}]),[o,c]=n.useState(null),[d,f]=n.useState(null),[h,C]=n.useState({question:void 0,answers:[null,null,null,null]}),[y,b]=n.useState({question:!1,answers:[!1,!1,!1,!1]}),[,$]=n.useState(!1),w=Ne(),N=qe({mutationFn:i=>ze(i),onSuccess:()=>{w.invalidateQueries({queryKey:["multiQuestions"]}),s(""),a([{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1}]),c(null),C({question:void 0,answers:[null,null,null,null]}),b({question:!1,answers:[!1,!1,!1,!1]}),$(!1),Q.success("Kérdés létrehozva!"),f("Kérdés létrehozva!"),t({to:"/mchoiceq"}),setTimeout(()=>f(null),3e3)},onError:i=>{var u,p;Q.error("Nem sikerült a kérdés létrehozása!"),c(((p=(u=i.response)==null?void 0:u.data)==null?void 0:p.error)||i.message||"Nem sikerült a kérdés létrehozása")}});n.useEffect(()=>{const i=M.safeParse({question:e,answers:r}),u={question:void 0,answers:[null,null,null,null]};i.success||i.error.errors.forEach(p=>{p.path[0]==="question"?u.question=p.message:p.path[0]==="answers"&&typeof p.path[1]=="number"&&(u.answers[p.path[1]]=p.message)}),C(u)},[e,r]);const E=(i,u,p)=>{const x=[...r];x[i]={...x[i],[u]:p},a(x),b(v=>({...v,answers:v.answers.map((S,q)=>q===i?!0:S)}))},F=i=>{i.preventDefault(),c(null),f(null),$(!0);const u=M.safeParse({question:e,answers:r});if(!u.success){c(u.error.errors[0].message),b({question:!0,answers:[!0,!0,!0,!0]});return}N.mutate({question:e,answers:r})};return l.jsxs(n.Suspense,{fallback:l.jsx(Fe,{}),children:[l.jsx(Ee,{}),l.jsx("div",{className:"max-w-4xl mx-auto items-center",children:l.jsx(Pe,{error:o,success:d,label:"Új Felelet Választós Kérdés",children:l.jsxs("form",{onSubmit:F,className:"space-y-6",children:[l.jsx(We,{question:e,setQuestion:s,fieldErrors:h,touched:y}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Válaszok"}),r.map((i,u)=>l.jsx(Xe,{answer:i,index:u,updateAnswer:E,fieldErrors:h.answers[u],touched:y.answers[u]},u))]}),l.jsx(Te,{isPending:N.isPending,label:"Kérdés Létrehozása"})]})})})]})};export{rt as M};
