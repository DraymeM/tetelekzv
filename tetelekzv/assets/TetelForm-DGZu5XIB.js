const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/InputField-C3mcRFjh.js","assets/index-exdmgrYU.js","assets/index-DWVpiWZZ.css","assets/FormContainer-CeTprkSc.js","assets/SubmitButton-Cgvqfgwv.js"])))=>i.map(i=>d[i]);
import{j as e,r as u,aw as F,R as k,_ as N,F as C,S as Q,y as P}from"./index-exdmgrYU.js";import{z as a}from"./index-mSkvzYyn.js";import O from"./InputField-C3mcRFjh.js";const R=a.preprocess(t=>t!==void 0?Number(t):void 0,a.number()).optional(),X=a.object({id:R,title:a.string().min(1,"A cím nem lehet üres!"),description:a.string()}),Y=a.object({id:R,content:a.string().min(1,"A szekció tartalma nem lehet üres!"),subsections:a.array(X).nullable().transform(t=>t||[])}),Z=a.object({id:R,question:a.string().min(1,"Üresen ne hagyd, zárd be ha nem akarsz."),answer:a.string().min(1,"Üresen ne hagyd, zárd be ha nem akarsz.")}),L=a.object({name:a.string().min(1,"Tétel cím megadása kötelező!"),osszegzes:a.string().min(1,"Összegzés megadása kötelező!"),sections:a.array(Y).min(1,"Legalább egy szekció legyen!"),flashcards:a.array(Z).nullable().transform(t=>t||[])}),A=({label:t,value:i,onChange:m,error:c})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:t}),e.jsx("textarea",{rows:4,className:`w-full p-2 rounded bg-secondary text-foreground focus:outline-none focus:ring-2 focus:ring-primary ${c?"border border-red-500":"border border-border"}`,value:i,onChange:m}),c&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c})]}),D=k.lazy(()=>N(()=>import("./InputField-C3mcRFjh.js"),__vite__mapDeps([0,1,2]))),ee=({subsection:t,onUpdate:i,onRemove:m,errors:c={}})=>e.jsx(u.Suspense,{children:e.jsxs("div",{className:"space-y-2 relative group",children:[e.jsx("button",{type:"button",onClick:m,className:"absolute -top-3 -right-3 text-red-500 bg-background rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx(F,{className:"w-5 h-5"})}),e.jsx(D,{label:"Cím",value:t.title,onChange:d=>i("title",d.target.value),error:c.title}),e.jsx(A,{label:"Leírás",value:t.description,onChange:d=>i("description",d.target.value),error:c.description})]})}),se=({onUpdateContent:t,onAddSubsection:i,onRemoveSection:m,onUpdateSubsection:c,onRemoveSubsection:d,section:v,errors:j={}})=>e.jsx(u.Suspense,{children:e.jsxs("div",{className:"p-4 border rounded-lg border-border relative group",children:[e.jsx("button",{type:"button",onClick:m,className:"absolute -top-3 -right-3 text-red-500 bg-background rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx(F,{className:"w-5 h-5"})}),e.jsx(A,{label:"Szekció tartalma",value:v.content,onChange:h=>t(h.target.value),error:j.content}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("h4",{className:"text-md font-medium text-foreground",children:"Alszekciók"}),v.subsections.map((h,p)=>e.jsx(ee,{subsection:h,onRemove:()=>d(p),onUpdate:(x,_)=>c(p,x,_),errors:{title:j[`subsections.${p}.title`],description:j[`subsections.${p}.description`]}},p)),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{type:"button",onClick:i,className:"flex items-center justify-center p-2 rounded-full bg-emerald-600 hover:cursor-pointer text-white hover:bg-emerald-700",children:e.jsx(C,{size:15})}),e.jsx("span",{children:"Új Alszekció"})]})]})]})}),te=({flashcard:t,onUpdate:i,onRemove:m,errors:c={}})=>e.jsxs("div",{className:"space-y-2 relative group",children:[e.jsx("button",{type:"button",onClick:m,className:"absolute -top-3 -right-3 text-red-500 bg-secondary rounded-full p-1 hover:bg-red-500/20 hover:cursor-pointer",children:e.jsx(F,{className:"w-5 h-5"})}),e.jsx("hr",{className:"border-t-2 border-border w-full my-2"}),e.jsx(O,{label:"Kérdés",value:t.question,onChange:d=>i("question",d.target.value),error:c.question}),e.jsx(O,{label:"Válasz",value:t.answer,onChange:d=>i("answer",d.target.value),error:c.answer})]}),re=k.lazy(()=>N(()=>import("./FormContainer-CeTprkSc.js"),__vite__mapDeps([3,1,2]))),oe=k.lazy(()=>N(()=>import("./SubmitButton-Cgvqfgwv.js"),__vite__mapDeps([4,1,2]))),ne=k.lazy(()=>N(()=>import("./InputField-C3mcRFjh.js"),__vite__mapDeps([0,1,2]))),de=({initialData:t,onSubmit:i,isPending:m,error:c,success:d,label:v,submitLabel:j})=>{const[h,p]=u.useState((t==null?void 0:t.name)||""),[x,_]=u.useState((t==null?void 0:t.osszegzes)||""),[f,g]=u.useState((t==null?void 0:t.sections)||[{content:"",subsections:[]}]),[z,w]=u.useState((t==null?void 0:t.flashcards)||[]),[S,T]=u.useState({}),[y,E]=u.useState({});u.useEffect(()=>{const s=L.safeParse({name:h,osszegzes:x,sections:f,flashcards:z});if(s.success)T({});else{const r={};s.error.errors.forEach(n=>{r[n.path.join(".")]=n.message}),T(r)}},[h,x,f,z]);const q=s=>{s.preventDefault(),E({name:!0,osszegzes:!0,sections:!0,flashcards:!0});const r=L.safeParse({name:h,osszegzes:x,sections:f,flashcards:z});if(!r.success){P.error("Javítsd ki a hibákat mielőtt mentenél!");return}i(r.data),P.success("Sikeres mentés!")},I=()=>{g(s=>[...s,{id:Date.now()*-1,content:"",subsections:[]}])},U=s=>{g(r=>r.filter(n=>n.id!==s))},V=(s,r)=>{g(n=>n.map(o=>o.id===s?{...o,content:r}:o))},B=s=>{g(r=>r.map(n=>n.id===s?{...n,subsections:[...n.subsections,{id:Date.now()*-1,title:"",description:""}]}:n))},W=(s,r,n,o)=>{g(l=>l.map(b=>b.id===s?{...b,subsections:b.subsections.map(($,M)=>M===r?{...$,[n]:o}:$)}:b))},J=(s,r)=>{g(n=>n.map(o=>o.id===s?{...o,subsections:o.subsections.filter((l,b)=>b!==r)}:o))},K=()=>{w(s=>[...s,{id:Date.now()*-1,question:"",answer:""}])},G=(s,r,n)=>{w(o=>o.map(l=>l.id===s?{...l,[r]:n}:l))},H=s=>{w(r=>r.filter(n=>n.id!==s))};return u.useEffect(()=>{(c||d)&&window.scrollTo({top:0,behavior:"smooth"})},[c,d]),e.jsx("div",{children:e.jsx(u.Suspense,{fallback:e.jsx(Q,{}),children:e.jsx("div",{className:"max-w-6xl mx-auto items-center",children:e.jsx(re,{error:c,success:d,label:v,children:e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsx(ne,{label:"Tétel címe",value:h,onChange:s=>{p(s.target.value),E(r=>({...r,name:!0}))},error:y.name?S.name:void 0}),e.jsx(A,{label:"Összegzés",value:x,onChange:s=>{_(s.target.value),E(r=>({...r,osszegzes:!0}))},error:y.osszegzes?S.osszegzes:void 0}),f.map((s,r)=>{const n={};return Object.entries(S).forEach(([o,l])=>{o.startsWith(`sections.${r}.`)&&(n[o.replace(`sections.${r}.`,"")]=l)}),e.jsx(se,{index:s.id,section:s,onUpdateContent:o=>V(s.id,o),onAddSubsection:()=>B(s.id),onRemoveSection:()=>U(s.id),onUpdateSubsection:(o,l,b)=>W(s.id,o,l,b),onRemoveSubsection:o=>J(s.id,o),errors:y.sections?n:{}},s.id)}),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{type:"button",onClick:I,className:"flex items-center justify-center p-2 rounded-full hover:cursor-pointer bg-emerald-600 text-white hover:bg-emerald-700",children:e.jsx(C,{size:15})}),e.jsx("span",{children:"Új Szekció"})]}),z.map((s,r)=>{const n={};return Object.entries(S).forEach(([o,l])=>{o.startsWith(`flashcards.${r}.`)&&(n[o.replace(`flashcards.${r}.`,"")]=l)}),e.jsx(te,{flashcard:s,onUpdate:(o,l)=>G(s.id,o,l),onRemove:()=>H(s.id),errors:y.flashcards?n:{}},s.id)}),e.jsxs("div",{className:"flex items-center space-x-2 text-emerald-600",children:[e.jsx("button",{type:"button",onClick:K,className:"flex items-center justify-center p-2 rounded-full hover:cursor-pointer bg-emerald-600 text-white hover:bg-emerald-700",children:e.jsx(C,{size:15})}),e.jsx("span",{children:"Új flashcard"})]}),e.jsx(oe,{isPending:m,label:j})]})})})})})};export{de as default};
