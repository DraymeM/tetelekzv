const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MarkdownHandler-DqQzy3x_.js","assets/index-C5suzcpx.js","assets/index-BHvGm_jW.css"])))=>i.map(i=>d[i]);
import{j as e,z as _,o as O,b as P,a as q,f as A,e as I,r as m,g,S as Q,O as K,i as V,p as B,s as H,R as U,v as W,w as $,_ as G}from"./index-C5suzcpx.js";import{L as M}from"./link-DfXfZ5aI.js";import{u as J}from"./useLocation-CaaRjoGt.js";import{u as X}from"./useQuery-BM9AOtUC.js";import{u as Y}from"./useMutation-YLi9uHDh.js";import{N as F}from"./Navbar-BUM_BvCX.js";import{g as Z,h as ee}from"./repo-BfVv8K4d.js";import te from"./DeleteModal-DG2u8AYE.js";import{P as se}from"./PageTransition-DrbtWe0G.js";import re from"./FlashCard-DBQkUK71.js";import"./utils-km2FGkQ4.js";import"./index-Crw9cMvJ.js";const ne=({questions:s,currentIdx:o,onNext:r,onExit:t})=>{const i=s.length>0,n=s.length>1;return e.jsx(_,{show:!0,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",as:"div",children:e.jsx("div",{className:"flex flex-col items-center gap-6 mt-10",children:i&&e.jsxs(e.Fragment,{children:[e.jsx(re,{question:s[o]?.question??"",answer:s[o]?.answer??""}),e.jsxs("div",{className:"flex gap-4",children:[n&&e.jsxs("button",{onClick:r,className:`px-6 py-3 bg-orange-400 text-white rounded-lg hover:cursor-pointer\r
                             hover:bg-orange-600 transition-colors flex items-center`,children:[e.jsx(O,{className:"mr-2 animate-spin"}),"Következő kérdés"]}),e.jsx("button",{onClick:t,className:`px-6 py-3 border border-border text-muted-foreground hover:text-foreground hover:cursor-pointer\r
                             rounded-lg hover:bg-secondary transition-colors`,children:"Vissza"})]})]})})})},u=U.lazy(()=>G(()=>import("./MarkdownHandler-DqQzy3x_.js").then(s=>s.M),__vite__mapDeps([0,1,2])));function oe(s,o){const r=n=>n.replace(/[#_*>\-`]/g,"").replace(/\[.*?\]\(.*?\)/g,"").replace(/!\[.*?\]\(.*?\)/g,"").replace(/`{1,3}[\s\S]*?`{1,3}/g,"").replace(/\s+/g," ").trim();let t="";s.forEach(n=>{t+=" "+r(n.content),n.subsections?.forEach(c=>{t+=" "+r(c.title||""),t+=" "+r(c.description||"")})}),o?.content&&(t+=" "+r(o.content));const i=t.split(" ").filter(Boolean).length;return Math.ceil(i/200)}function ae(){const{isAuthenticated:s,isSuperUser:o}=P(),{id:r}=q({strict:!1}),t=Number(r),i=J(),n=A(),c=I(),S=i.pathname.includes("/edit"),[x,j]=m.useState(!1),[p,b]=m.useState(0),[T,v]=m.useState(!1),{data:d,isLoading:C,error:N}=X({queryKey:["tetelDetail",t],queryFn:()=>ee(t),enabled:!isNaN(t)&&t>0,retry:2,refetchOnWindowFocus:!1}),y=Y({mutationFn:()=>{if(!s||!o)throw g.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return Z(t)},onSuccess:()=>{c.invalidateQueries({queryKey:["tetelek"]}),g.success("Sikeresen törölted a tételt."),n({to:"/tetelek"})}});if(C)return e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(Q,{})})]});if(N)return e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",N.message]});if(S)return e.jsx(K,{});const w=d?.tetel??{name:"Ismeretlen tétel"},h=d?.osszegzes,z=d?.sections??[],l=d?.questions??[],k=l.length>0,E=l.length>1,D=oe(z,h),L=()=>{if(!E)return;let a=p;for(;a===p;)a=Math.floor(Math.random()*l.length);b(a)},R=()=>{k&&(b(Math.floor(Math.random()*l.length)),j(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsx(m.Suspense,{children:e.jsxs("main",{className:"relative md:max-w-7xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 py-10 text-left",children:[e.jsxs(se,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(M,{to:"/tetelek",className:"inline-flex items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors",children:[e.jsx(V,{className:"mr-2"}),"Vissza a tételekhez"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[!x&&e.jsxs("span",{className:"text-sm mx-auto text-secondary-foreground",children:[e.jsx(B,{className:"inline mr-1",size:15}),D," perc"]}),!x&&k&&e.jsxs("button",{onClick:R,className:"inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 rounded-md text-sm font-medium text-white hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer",children:[e.jsx(H,{className:"mr-2"}),"Tanulás"]})]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-foreground",children:w.name}),x?e.jsx(ne,{questions:l,currentIdx:p,onNext:L,onExit:()=>j(!1)}):e.jsxs("div",{className:"space-y-6",children:[z.map(a=>e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow-xl border border-transparent hover:border-border transition-colors",children:[e.jsx("div",{className:"text-xl font-semibold mb-4 text-foreground",children:e.jsx(u,{content:a.content})}),a.subsections?.map(f=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"font-medium text-foreground mb-2",children:e.jsx(u,{content:f.title})}),e.jsx("div",{className:"text-secondary-foreground prose prose-invert max-w-none",children:e.jsx(u,{content:f.description})})]},f.id))]},a.id)),h?.content&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 border border-transparent hover:border-border transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:"Összegzés"}),e.jsx("div",{className:"text-foreground prose prose-invert max-w-none whitespace-pre-wrap",children:e.jsx(u,{content:h.content})})]})]}),e.jsx(te,{isOpen:T,onClose:()=>v(!1),onDelete:()=>y.mutate(),isDeleting:y.isPending,itemName:w.name})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx(M,{to:"/tetelek/$id/edit",params:{id:t.toString()},className:"fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Szerkeszd a tételt",children:e.jsx(W,{size:20})}),e.jsx("button",{onClick:()=>{if(!s){g.error("Ehhez be kell jelentkezned!");return}v(!0)},className:"fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full hover:bg-rose-700 transition-all transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50",title:"Töröld a tételt",children:e.jsx($,{size:20})})]})]})})]})}const be=ae;export{be as component};
