const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MarkdownHandler-D0VKFEzC.js","assets/index-OFKPIk_b.js","assets/index-BT43gUAo.css"])))=>i.map(i=>d[i]);
import{j as e,z as R,o as _,d as P,b as q,g as A,f as I,r as c,R as Q,_ as K,y as g,S as V,O as B,a as M,i as H,p as U,s as W,v as $,w as G}from"./index-OFKPIk_b.js";import{u as J}from"./useLocation-CwS403li.js";import{u as X}from"./useQuery-BBt78rEq.js";import{u as Y}from"./useMutation-B7Jo8maG.js";import{N as j}from"./Navbar-B2E3A0V3.js";import{g as Z,h as ee}from"./repo-BPIYwlfb.js";import te from"./DeleteModal-DVMFK1hS.js";import{P as re}from"./PageTransition-CKq48pqQ.js";import se from"./FlashCard-DmF-iDOG.js";import{O as ne}from"./OfflinePlaceholder-eHJ76xge.js";import"./index-Bg5H-5xi.js";import"./index-DgDcdaKc.js";const oe=({questions:r,currentIdx:a,onNext:n,onExit:t})=>{const i=r.length>0,o=r.length>1;return e.jsx(R,{show:!0,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",as:"div",children:e.jsx("div",{className:"flex flex-col items-center gap-6 mt-10",children:i&&e.jsxs(e.Fragment,{children:[e.jsx(se,{question:r[a]?.question??"",answer:r[a]?.answer??""}),e.jsxs("div",{className:"flex gap-4",children:[o&&e.jsxs("button",{onClick:n,className:`px-6 py-3 bg-orange-400 text-white rounded-lg hover:cursor-pointer\r
                             hover:bg-orange-600 transition-colors flex items-center`,children:[e.jsx(_,{className:"mr-2 animate-spin"}),"Következő kérdés"]}),e.jsx("button",{onClick:t,className:`px-6 py-3 border border-border text-muted-foreground hover:text-foreground hover:cursor-pointer\r
                             rounded-lg hover:bg-secondary transition-colors`,children:"Vissza"})]})]})})})};function ae(r,a){const n=o=>o.replace(/[#_*>\-`]/g,"").replace(/\[.*?\]\(.*?\)/g,"").replace(/!\[.*?\]\(.*?\)/g,"").replace(/`{1,3}[\s\S]*?`{1,3}/g,"").replace(/\s+/g," ").trim();let t="";r.forEach(o=>{t+=" "+n(o.content),o.subsections?.forEach(d=>{t+=" "+n(d.title||""),t+=" "+n(d.description||"")})}),a?.content&&(t+=" "+n(a.content));const i=t.split(" ").filter(Boolean).length;return Math.ceil(i/200)}function ie(){const{isAuthenticated:r,isSuperUser:a}=P(),{id:n}=q({strict:!1}),t=Number(n),i=J(),o=A(),d=I(),S=i.pathname.includes("/edit"),[x,b]=c.useState(!1),[h,v]=c.useState(0),[T,N]=c.useState(!1),{data:m,isLoading:C,error:y}=X({queryKey:["tetelDetail",t],queryFn:()=>ee(t),enabled:!isNaN(t)&&t>0,retry:2,refetchOnWindowFocus:!1});c.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"})},[i.pathname]);const u=Q.lazy(()=>K(()=>import("./MarkdownHandler-D0VKFEzC.js").then(s=>s.M),__vite__mapDeps([0,1,2]))),w=Y({mutationFn:()=>{if(!r||!a)throw g.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return Z(t)},onSuccess:()=>{d.invalidateQueries({queryKey:["tetelek"]}),g.success("Sikeresen törölted a tételt."),o({to:"/tetelek"})}});if(C)return e.jsxs(e.Fragment,{children:[e.jsx(j,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(V,{})})]});if(y)return navigator.onLine?e.jsxs(e.Fragment,{children:[e.jsx(j,{}),e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",y.message]})]}):e.jsx(e.Fragment,{children:e.jsx(ne,{})});if(S)return e.jsx(B,{});const z=m?.tetel??{name:"Ismeretlen tétel"},p=m?.osszegzes,k=m?.sections??[],l=m?.questions??[],F=l.length>0,E=l.length>1,O=ae(k,p),D=()=>{if(!E)return;let s=h;for(;s===h;)s=Math.floor(Math.random()*l.length);v(s)},L=()=>{F&&(v(Math.floor(Math.random()*l.length)),b(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(j,{}),e.jsx(c.Suspense,{children:e.jsxs("main",{className:"relative md:max-w-7xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 py-10 text-left",children:[e.jsxs(re,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(M,{to:"/tetelek",className:"inline-flex items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors",children:[e.jsx(H,{className:"mr-2"}),"Vissza a tételekhez"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[!x&&e.jsxs("span",{className:"text-sm mx-auto text-secondary-foreground",children:[e.jsx(U,{className:"inline mr-1",size:15}),O," perc"]}),!x&&F&&e.jsxs("button",{onClick:L,className:"inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 rounded-md text-sm font-medium text-white hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer",children:[e.jsx(W,{className:"mr-2"}),"Tanulás"]})]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-foreground",children:z.name}),x?e.jsx(oe,{questions:l,currentIdx:h,onNext:D,onExit:()=>b(!1)}):e.jsxs("div",{className:"space-y-6",children:[k.map(s=>e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow-xl border border-transparent hover:border-border transition-colors",children:[e.jsx("div",{className:"text-xl font-semibold mb-4 text-foreground",children:e.jsx(u,{content:s.content})}),s.subsections?.map(f=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"font-medium text-foreground mb-2",children:e.jsx(u,{content:f.title})}),e.jsx("div",{className:"text-secondary-foreground prose prose-invert max-w-none",children:e.jsx(u,{content:f.description})})]},f.id))]},s.id)),p?.content&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 border border-transparent hover:border-border transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:"Összegzés"}),e.jsx("div",{className:"text-foreground prose prose-invert max-w-none whitespace-pre-wrap",children:e.jsx(u,{content:p.content})})]})]}),e.jsx(te,{isOpen:T,onClose:()=>N(!1),onDelete:()=>w.mutate(),isDeleting:w.isPending,itemName:z.name})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx(M,{to:"/tetelek/$id/edit",params:{id:t.toString()},className:"fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Szerkeszd a tételt",children:e.jsx($,{size:20})}),e.jsx("button",{onClick:()=>{if(!r){g.error("Ehhez be kell jelentkezned!");return}N(!0)},className:"fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full hover:bg-rose-700 transition-all transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50",title:"Töröld a tételt",children:e.jsx(G,{size:20})})]})]})})]})}const ve=ie;export{ve as component};
