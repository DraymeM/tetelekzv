const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MarkdownHandler-B_LBBhGs.js","assets/index-BT5olunS.js","assets/index-CNDMz1Av.css"])))=>i.map(i=>d[i]);
import{j as e,z as O,o as _,b as P,a as R,f as q,e as A,r as i,g as h,S as I,O as Q,i as K,s as V,R as H,v as B,w as U,_ as W}from"./index-BT5olunS.js";import{L as w}from"./link-B2bN1KjX.js";import{u as $}from"./useLocation-2PD0QyBd.js";import{u as G}from"./useQuery-B2tX-dpz.js";import{u as J}from"./useMutation-Buslm402.js";import{N as k}from"./Navbar-BE0Cl1aM.js";import{g as X,h as Y}from"./repo-DL4fAiI8.js";import Z from"./DeleteModal-DZiFbS9i.js";import{P as ee}from"./PageTransition-BU5ysc6Q.js";import te from"./FlashCard-B-M8HfOx.js";import"./utils-km2FGkQ4.js";import"./index-BWrQ2ogr.js";const se=({questions:t,currentIdx:o,onNext:d,onExit:s})=>{const c=t.length>0,m=t.length>1;return e.jsx(O,{show:!0,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",as:"div",children:e.jsx("div",{className:"flex flex-col items-center gap-6 mt-10",children:c&&e.jsxs(e.Fragment,{children:[e.jsx(te,{question:t[o]?.question??"",answer:t[o]?.answer??""}),e.jsxs("div",{className:"flex gap-4",children:[m&&e.jsxs("button",{onClick:d,className:`px-6 py-3 bg-orange-400 text-white rounded-lg hover:cursor-pointer\r
                             hover:bg-orange-600 transition-colors flex items-center`,children:[e.jsx(_,{className:"mr-2 animate-spin"}),"Következő kérdés"]}),e.jsx("button",{onClick:s,className:`px-6 py-3 border border-border text-muted-foreground hover:text-foreground hover:cursor-pointer\r
                             rounded-lg hover:bg-secondary transition-colors`,children:"Vissza"})]})]})})})},l=H.lazy(()=>W(()=>import("./MarkdownHandler-B_LBBhGs.js").then(t=>t.M),__vite__mapDeps([0,1,2])));function re(){const{isAuthenticated:t,isSuperUser:o}=P(),{id:d}=R({strict:!1}),s=Number(d),c=$(),m=q(),F=A(),M=c.pathname.includes("/edit"),[p,f]=i.useState(!1),[u,g]=i.useState(0),[S,b]=i.useState(!1),{data:a,isLoading:C,error:j}=G({queryKey:["tetelDetail",s],queryFn:()=>Y(s),enabled:!isNaN(s)&&s>0,retry:2,refetchOnWindowFocus:!1}),v=J({mutationFn:()=>{if(!t||!o)throw h.error("Nincs engedélyed a művelethez"),new Error("Nincs engedélyed a művelethez");return X(s)},onSuccess:()=>{F.invalidateQueries({queryKey:["tetelek"]}),h.success("Sikeresen törölted a tételt."),m({to:"/tetelek"})}});if(C)return e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsx("div",{className:"p-10 text-center",children:e.jsx(I,{})})]});if(j)return e.jsxs("div",{className:"p-10 text-red-500 text-center",children:["Hiba történt: ",j.message]});if(M)return e.jsx(Q,{});const N=a?.tetel??{name:"Ismeretlen tétel"},y=a?.osszegzes,T=a?.sections??[],n=a?.questions??[],z=n.length>0,D=n.length>1,L=()=>{if(!D)return;let r=u;for(;r===u;)r=Math.floor(Math.random()*n.length);g(r)},E=()=>{z&&(g(Math.floor(Math.random()*n.length)),f(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsx(i.Suspense,{children:e.jsxs("main",{className:"relative md:max-w-7xl max-w-full mx-auto min-h-screen mt-10 md:px-10 px-3 py-10 text-left",children:[e.jsxs(ee,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(w,{to:"/tetelek",className:"inline-flex items-center px-3 py-2 border border-border rounded-md text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors",children:[e.jsx(K,{className:"mr-2"}),"Vissza a tételekhez"]}),!p&&z&&e.jsxs("button",{onClick:E,className:"inline-flex items-center px-4 py-2 bg-purple-600 border-purple-500 rounded-md text-sm font-medium text-white hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors hover:cursor-pointer",children:[e.jsx(V,{className:"mr-2"}),"Tanulás"]})]}),e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-foreground",children:N.name}),p?e.jsx(se,{questions:n,currentIdx:u,onNext:L,onExit:()=>f(!1)}):e.jsxs("div",{className:"space-y-6",children:[T.map(r=>e.jsxs("div",{className:"bg-secondary rounded-lg p-6 shadow-xl border border-transparent hover:border-border transition-colors",children:[e.jsx("div",{className:"text-xl font-semibold mb-4 text-foreground",children:e.jsx(l,{content:r.content})}),r.subsections?.map(x=>e.jsxs("div",{className:"ml-4 mb-4 p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"font-medium text-foreground mb-2",children:e.jsx(l,{content:x.title})}),e.jsx("div",{className:"text-secondary-foreground prose prose-invert max-w-none",children:e.jsx(l,{content:x.description})})]},x.id))]},r.id)),y?.content&&e.jsxs("div",{className:"bg-secondary rounded-lg p-6 border border-transparent hover:border-border transition-colors",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:"Összegzés"}),e.jsx("div",{className:"text-foreground prose prose-invert max-w-none whitespace-pre-wrap",children:e.jsx(l,{content:y.content})})]})]}),e.jsx(Z,{isOpen:S,onClose:()=>b(!1),onDelete:()=>v.mutate(),isDeleting:v.isPending,itemName:N.name})]}),t&&e.jsxs(e.Fragment,{children:[e.jsx(w,{to:"/tetelek/$id/edit",params:{id:s.toString()},className:"fixed bottom-22 right-7 p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center z-50",title:"Szerkeszd a tételt",children:e.jsx(B,{size:20})}),e.jsx("button",{onClick:()=>{if(!t){h.error("Ehhez be kell jelentkezned!");return}b(!0)},className:"fixed bottom-7 right-7 p-3 bg-rose-600 text-white rounded-full hover:bg-rose-700 transition-all transform hover:scale-105 flex items-center hover:cursor-pointer justify-center z-50",title:"Töröld a tételt",children:e.jsx(U,{size:20})})]})]})})]})}const fe=re;export{fe as component};
