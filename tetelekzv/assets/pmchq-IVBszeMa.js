import{r,o as j,p as R,R as d,f as M,m as ae,s as O,e as le,K as oe,H as ue,Q as ie,g as ce,w as de,h as Q,i as fe,k as me,y as pe,l as he,n as K,I as ge,U as be,$ as xe,q as ve,t as ye,_ as Ce,v as Se,j as o,x as ke,d as we,c as $e}from"./index-DNzlDc06.js";import{u as je,F as Ee,S as Fe,z as $}from"./SubmitButton-DFfEBB4L.js";import{a as Ne}from"./index-cNbRpIzP.js";function qe(e,s,t){let[n,a]=r.useState(t),l=e!==void 0,m=r.useRef(l),c=r.useRef(!1),f=r.useRef(!1);return l&&!m.current&&!c.current?(c.current=!0,m.current=l,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!l&&m.current&&!f.current&&(f.current=!0,m.current=l,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[l?e:n,j(h=>(l||a(h),s==null?void 0:s(h)))]}function Te(e){let[s]=r.useState(e);return s}function B(e={},s=null,t=[]){for(let[n,a]of Object.entries(e))U(t,H(s,n),a);return t}function H(e,s){return e?e+"["+s+"]":s}function U(e,s,t){if(Array.isArray(t))for(let[n,a]of t.entries())U(e,H(s,n.toString()),a);else t instanceof Date?e.push([s,t.toISOString()]):typeof t=="boolean"?e.push([s,t?"1":"0"]):typeof t=="string"?e.push([s,t]):typeof t=="number"?e.push([s,`${t}`]):t==null?e.push([s,""]):B(t,s,e)}function Pe(e){var s,t;let n=(s=e==null?void 0:e.form)!=null?s:e.closest("form");if(n){for(let a of n.elements)if(a!==e&&(a.tagName==="INPUT"&&a.type==="submit"||a.tagName==="BUTTON"&&a.type==="submit"||a.nodeName==="INPUT"&&a.type==="image")){a.click();return}(t=n.requestSubmit)==null||t.call(n)}}let ze=r.createContext(null);function Ie({children:e}){let s=r.useContext(ze);if(!s)return d.createElement(d.Fragment,null,e);let{target:t}=s;return t?le.createPortal(d.createElement(d.Fragment,null,e),t):null}function De({data:e,form:s,disabled:t,onReset:n,overrides:a}){let[l,m]=r.useState(null),c=R();return r.useEffect(()=>{if(n&&l)return c.addEventListener(l,"reset",n)},[l,s,n]),d.createElement(Ie,null,d.createElement(Ae,{setForm:m,formId:s}),B(e).map(([f,h])=>d.createElement(M,{features:O.Hidden,...ae({key:f,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:s,disabled:t,name:f,value:h,...a})})))}function Ae({setForm:e,formId:s}){return r.useEffect(()=>{if(s){let t=document.getElementById(s);t&&e(t)}},[e,s]),s?null:d.createElement(M,{features:O.Hidden,as:"input",type:"hidden",hidden:!0,readOnly:!0,ref:t=>{if(!t)return;let n=t.closest("form");n&&e(n)}})}let q=r.createContext(null);q.displayName="GroupContext";let Ke=r.Fragment;function Le(e){var s;let[t,n]=r.useState(null),[a,l]=ce(),[m,c]=de(),f=r.useMemo(()=>({switch:t,setSwitch:n}),[t,n]),h={},w=e,x=Q();return d.createElement(c,{name:"Switch.Description",value:m},d.createElement(l,{name:"Switch.Label",value:a,props:{htmlFor:(s=f.switch)==null?void 0:s.id,onClick(y){t&&(y.currentTarget instanceof HTMLLabelElement&&y.preventDefault(),t.click(),t.focus({preventScroll:!0}))}}},d.createElement(q.Provider,{value:f},x({ourProps:h,theirProps:w,slot:{},defaultTag:Ke,name:"Switch.Group"}))))}let Re="button";function Me(e,s){var t;let n=r.useId(),a=fe(),l=me(),{id:m=a||`headlessui-switch-${n}`,disabled:c=l||!1,checked:f,defaultChecked:h,onChange:w,name:x,value:y,form:F,autoFocus:C=!1,...N}=e,E=r.useContext(q),[u,i]=r.useState(null),g=r.useRef(null),p=pe(g,s,E===null?null:E.setSwitch,i),v=Te(h),[S,k]=qe(f,w,v??!1),V=R(),[T,P]=r.useState(!1),z=j(()=>{P(!0),k==null||k(!S),V.nextFrame(()=>{P(!1)})}),G=j(b=>{if(he(b.currentTarget))return b.preventDefault();b.preventDefault(),z()}),_=j(b=>{b.key===K.Space?(b.preventDefault(),z()):b.key===K.Enter&&Pe(b.currentTarget)}),J=j(b=>b.preventDefault()),W=ge(),X=be(),{isFocusVisible:I,focusProps:Y}=xe({autoFocus:C}),{isHovered:D,hoverProps:Z}=ve({isDisabled:c}),{pressed:A,pressProps:ee}=ye({disabled:c}),te=r.useMemo(()=>({checked:S,disabled:c,hover:D,focus:I,active:A,autofocus:C,changing:T}),[S,D,I,A,c,T,C]),se=Ce({id:m,ref:p,role:"switch",type:Se(e,u),tabIndex:e.tabIndex===-1?0:(t=e.tabIndex)!=null?t:0,"aria-checked":S,"aria-labelledby":W,"aria-describedby":X,disabled:c||void 0,autoFocus:C,onClick:G,onKeyUp:_,onKeyPress:J},Y,Z,ee),ne=r.useCallback(()=>{if(v!==void 0)return k==null?void 0:k(v)},[k,v]),re=Q();return d.createElement(d.Fragment,null,x!=null&&d.createElement(De,{disabled:c,data:{[x]:y||"on"},overrides:{type:"checkbox",checked:S},form:F,onReset:ne}),re({ourProps:se,theirProps:N,slot:te,defaultTag:Re,name:"Switch"}))}let Oe=oe(Me),Qe=Le,Be=ie,He=ue,Ue=Object.assign(Oe,{Group:Qe,Label:Be,Description:He});const Ve=({question:e,setQuestion:s,fieldErrors:t,touched:n})=>o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Kérdés"}),o.jsx("input",{type:"text",value:e,onChange:a=>s(a.target.value),className:`w-full p-3 border rounded-lg bg-gray-800 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 transition ${n.question&&t.question?"border-red-500":"border-gray-700"} animate-in fade-in duration-300`,placeholder:"Add meg a kérdést"}),n.question&&t.question&&o.jsx("p",{className:"text-red-500 text-sm mt-1 animate-in fade-in duration-200",children:t.question})]}),Ge=({answer:e,index:s,updateAnswer:t,fieldErrors:n,touched:a})=>o.jsxs("div",{className:"flex flex-col space-y-1 mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("span",{className:"text-gray-300 w-8 font-medium",children:[String.fromCharCode(65+s),"."]}),o.jsx("input",{type:"text",value:e.text,onChange:l=>t(s,"text",l.target.value),className:`flex-1 p-3 border rounded-lg bg-gray-800 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 transition ${a&&n?"border-red-500":"border-gray-700"} animate-in fade-in duration-300`,placeholder:`Válasz ${s+1}`}),o.jsx(Ue,{checked:e.isCorrect,onChange:l=>t(s,"isCorrect",l),className:`${e.isCorrect?"bg-blue-600":"bg-gray-600"} relative inline-flex h-6 w-11 items-center hover:cursor-pointer rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 animate-in fade-in duration-300`,children:o.jsx("span",{className:`${e.isCorrect?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform bg-white rounded-full transition-transform`})}),o.jsx("span",{className:"text-gray-400 text-lg",children:e.isCorrect?o.jsx(ke,{className:"text-green-500"}):o.jsx(we,{className:"text-red-500"})})]}),a&&n&&o.jsx("p",{className:"text-red-500 text-sm ml-11 animate-in fade-in duration-200",children:n})]}),_e=$.object({text:$.string().min(1,"A válasz szövege nem lehet üres"),isCorrect:$.boolean()}),L=$.object({question:$.string().min(1,"A kérdés megadása kötelező"),answers:$.array(_e).length(4,"Pontosan négy válasz szükséges").refine(e=>e.some(s=>s.isCorrect),{message:"Legalább egy válasznak helyesnek kell lennie"})}),Je=()=>{const[e,s]=r.useState(""),[t,n]=r.useState([{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1}]),[a,l]=r.useState(null),[m,c]=r.useState(null),[f,h]=r.useState({question:void 0,answers:[null,null,null,null]}),[w,x]=r.useState({question:!1,answers:[!1,!1,!1,!1]}),[,y]=r.useState(!1),F=$e(),C=je({mutationFn:async u=>(console.log("Fetching /tetelekzv/BackEnd/create_multiquestion.php",u),(await Ne.post("/tetelekzv/BackEnd/create_multiquestion.php",u,{headers:{"Content-Type":"application/json"}})).data),onSuccess:u=>{F.invalidateQueries({queryKey:["multiQuestions"]}),s(""),n([{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1}]),l(null),h({question:void 0,answers:[null,null,null,null]}),x({question:!1,answers:[!1,!1,!1,!1]}),y(!1),c(`Kérdés létrehozva, ID: ${u.id}`),setTimeout(()=>c(null),3e3)},onError:u=>{var i,g;console.error("Mutation error:",u),l(((g=(i=u.response)==null?void 0:i.data)==null?void 0:g.error)||u.message||"Nem sikerült a kérdés létrehozása")}});r.useEffect(()=>{(()=>{const i=L.safeParse({question:e,answers:t}),g={question:void 0,answers:[null,null,null,null]};i.success||i.error.errors.forEach(p=>{p.path[0]==="question"?g.question=p.message:p.path[0]==="answers"&&typeof p.path[1]=="number"&&(g.answers[p.path[1]]=p.message)}),h(g)})()},[e,t]);const N=(u,i,g)=>{const p=[...t];p[u]={...p[u],[i]:g},n(p),x(v=>({...v,answers:v.answers.map((S,k)=>k===u?!0:S)}))},E=u=>{u.preventDefault(),l(null),c(null),y(!0);const i=L.safeParse({question:e,answers:t});if(!i.success){l(i.error.errors[0].message),x({question:!0,answers:[!0,!0,!0,!0]});return}C.mutate({question:e,answers:t})};return o.jsx(Ee,{error:a,success:m,label:"Új Felelet Választós Kérdés",children:o.jsxs("form",{onSubmit:E,className:"space-y-6",children:[o.jsx(Ve,{question:e,setQuestion:s,fieldErrors:f,touched:w}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Válaszok"}),t.map((u,i)=>o.jsx(Ge,{answer:u,index:i,updateAnswer:N,fieldErrors:f.answers[i],touched:w.answers[i]},i))]}),o.jsx(Fe,{isPending:C.isPending,label:"Kérdés Létrehozása"})]})})},Ze=Je;export{Ze as component};
