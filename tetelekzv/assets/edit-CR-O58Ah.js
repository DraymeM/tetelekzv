import{u as v,e as z,d as T,r as a,j as o,S as d}from"./index-Cu8xjkos.js";import{u as k}from"./useQuery-BenkM4TD.js";import{u as N}from"./useMutation-Bu1mF0U_.js";import{h as q,g as E}from"./repo-CAr3lVtz.js";import{T as C}from"./TetelForm-DvFQya1P.js";import"./utils-km2FGkQ4.js";import"./SubmitButton-B72Z0y_5.js";import"./InputField-Bx0Sq1eL.js";const D=()=>{var m;const{id:p}=v({strict:!1}),n=Number(p),f=z(),x=T(),[b,l]=a.useState(null),[g,u]=a.useState(null),[y,r]=a.useState(!1),{data:e,isLoading:S}=k({queryKey:["tetelDetail",n],queryFn:()=>E(n),enabled:!isNaN(n)}),c=N({mutationFn:s=>q(n,s),onMutate:()=>{r(!0)},onSuccess:()=>{x.invalidateQueries({queryKey:["tetelDetail",n]}),u("Sikeres frissítés!"),setTimeout(()=>{u(null),f({to:`/tetelek/${n}`}),r(!1)},2e3)},onError:s=>{var t,i;l(((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.error)||"Hiba a frissítés közben."),r(!1)}}),h=s=>{l(null),c.mutate({...s,sections:s.sections.map(t=>({...t,subsections:t.subsections.map(i=>({...i,id:i.id&&i.id<0?void 0:i.id}))})),flashcards:s.flashcards.map(t=>({...t,id:t.id&&t.id<0?void 0:t.id}))})};if(S)return o.jsx("div",{className:"p-10 text-center text-gray-300",children:o.jsx(d,{})});const j={name:(e==null?void 0:e.tetel.name)||"",osszegzes:((m=e==null?void 0:e.osszegzes)==null?void 0:m.content)||"",sections:(e==null?void 0:e.sections.map(s=>({...s,subsections:s.subsections||[]})))||[{content:"",subsections:[]}],flashcards:(e==null?void 0:e.questions)||[]};return o.jsxs("div",{className:"relative",children:[y&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"rgba(25, 25, 30, 0.3)"},children:o.jsx(d,{})}),o.jsx(C,{initialData:j,onSubmit:h,isPending:c.isPending,error:b,success:g,label:"Tétel szerkesztése",submitLabel:"Tétel mentése"})]})},H=D;export{H as component};
